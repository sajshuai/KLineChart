/**
     * @license
     * KLineChart v10.0.0-alpha6
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).klinecharts={})}(this,(function(t){"use strict";function e(t,r){if(o(t)||o(r))for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var a=t[n],l=r[n];o(l)&&o(a)?e(a,l):s(r[n])&&(t[n]=i(r[n]))}}function i(t){if(!o(t))return t;var e=null;for(var n in e=r(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=t[n];o(a)?e[n]=i(a):e[n]=a}return e}function r(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return"function"==typeof t}function o(t){return"object"==typeof t&&s(t)}function a(t){return"number"==typeof t&&Number.isFinite(t)}function s(t){return null!=t}function l(t){return"boolean"==typeof t}function u(t){return"string"==typeof t}var c=/\\(\\)?/g,h=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g");function d(t,e,i){if(s(t)){var r=[];e.replace(h,(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=t;return s(e[1])?n=e[2].replace(c,"$1"):s(e[0])&&(n=e[0].trim()),r.push(n),""}));for(var n=t,o=0,a=r.length;s(n)&&o<a;)n=null==n?void 0:n[r[o++]];return s(n)?n:null!=i?i:"--"}return null!=i?i:"--"}function p(t,e,i){var r=function(t,e){var i={};return t.formatToParts(new Date(e)).forEach((function(t){var e=t.type,r=t.value;switch(e){case"year":i.YYYY=r;break;case"month":i.MM=r;break;case"day":i.DD=r;break;case"hour":i.HH="24"===r?"00":r;break;case"minute":i.mm=r;break;case"second":i.ss=r}})),i}(t,e);return i.replace(/YYYY|MM|DD|HH|mm|ss/g,(function(t){return r[t]}))}function g(t,e){var i=+t;return a(i)?i.toFixed(null!=e?e:2):"".concat(t)}function v(t){var e=+t;if(a(e)){if(e>1e9)return"".concat(+(e/1e9).toFixed(3),"B");if(e>1e6)return"".concat(+(e/1e6).toFixed(3),"M");if(e>1e3)return"".concat(+(e/1e3).toFixed(3),"K")}return"".concat(t)}function f(t,e){var i="".concat(t);if(0===e.length)return i;if(i.includes(".")){var r=i.split(".");return"".concat(r[0].replace(/(\d)(?=(\d{3})+$)/g,(function(t){return"".concat(t).concat(e)})),".").concat(r[1])}return i.replace(/(\d)(?=(\d{3})+$)/g,(function(t){return"".concat(t).concat(e)}))}function m(t,e){var i="".concat(t);if(new RegExp("\\.0{"+e+",}[1-9][0-9]*$").test(i)){var r=i.split("."),n=r.length-1,o=r[n],a=/0*/.exec(o);if(s(a)){var l=a[0].length;return r[n]=o.replace(/0*/,"0{".concat(l,"}")),r.join(".")}}return i}function y(t,e){return t.replace(/\{(\w+)\}/g,(function(t,i){var r=e[i];return s(r)?r:"{".concat(i,"}")}))}var _=null;function x(t){var e,i;return null!==(i=null===(e=t.ownerDocument.defaultView)||void 0===e?void 0:e.devicePixelRatio)&&void 0!==i?i:1}function b(t,e,i){return"".concat(null!=e?e:"normal"," ").concat(null!=t?t:12,"px ").concat(null!=i?i:"Helvetica Neue")}function w(t,e,i,r){if(!s(_)){var n=document.createElement("canvas"),o=x(n);(_=n.getContext("2d")).scale(o,o)}return _.font=b(e,i,r),Math.round(_.measureText(t).width)}var C=function(t,e){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},C(t,e)};function E(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var T=function(){return T=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},T.apply(this,arguments)};function S(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}function P(t,e,i,r){return new(i||(i=Promise))((function(n,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function I(t,e){var i,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function M(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],r=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function k(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,o=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}function D(t,e,i){if(i||2===arguments.length)for(var r,n=0,o=e.length;n<o;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))}function A(t){var i={width:0,height:0,left:0,right:0,top:0,bottom:0};return s(t)&&e(i,t),i}"function"==typeof SuppressedError&&SuppressedError;var F=-1;function B(t){return n(window.requestAnimationFrame)?window.requestAnimationFrame(t):window.setTimeout(t,20)}function R(t){n(window.cancelAnimationFrame)?window.cancelAnimationFrame(t):window.clearTimeout(t)}function L(t){if(n(window.requestIdleCallback))return window.requestIdleCallback(t);var e=performance.now();return window.setTimeout((function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(performance.now()-e))}})}),1)}var O=function(){function t(t){this._options={duration:500,iterationCount:1},this._currentIterationCount=0,this._running=!1,this._time=0,e(this._options,t)}return t.prototype._loop=function(){var t=this;this._running=!0;var e=function(){var i;if(t._running){var r=(new Date).getTime()-t._time;r<t._options.duration?(null===(i=t._doFrameCallback)||void 0===i||i.call(t,r),B(e)):(t.stop(),t._currentIterationCount++,t._currentIterationCount<t._options.iterationCount&&t.start())}};B(e)},t.prototype.doFrame=function(t){return this._doFrameCallback=t,this},t.prototype.setDuration=function(t){return this._options.duration=t,this},t.prototype.setIterationCount=function(t){return this._options.iterationCount=t,this},t.prototype.start=function(){this._running||(this._time=(new Date).getTime(),this._loop())},t.prototype.stop=function(){var t;this._running&&(null===(t=this._doFrameCallback)||void 0===t||t.call(this,this._options.duration)),this._running=!1},t}(),W=1,V=(new Date).getTime();function z(t){var e=(new Date).getTime();return e===V?++W:W=1,V=e,"".concat(null!=t?t:"").concat(e,"_").concat(W)}function N(t,e){var i,r=document.createElement(t),n=null!=e?e:{};for(var o in n)r.style[o]=null!==(i=n[o])&&void 0!==i?i:"";return r}function Y(t,e,i){var r=0,n=0;for(n=t.length-1;r!==n;){var o=Math.floor((n+r)/2),a=n-r,s=t[o][e];if(i===t[r][e])return r;if(i===t[n][e])return n;if(i===s)return o;if(i>s?r=o:n=o,a<=2)break}return r}function H(t,e){e=Math.max(0,null!=e?e:0);var i=Math.pow(10,e);return Math.round(t*i)/i}function X(t,e,i){for(var r,n,o=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],a=t.length,s=0;s<a;){var l=t[s];o[0]=Math.max(null!==(r=l[e])&&void 0!==r?r:Number.MIN_SAFE_INTEGER,o[0]),o[1]=Math.min(null!==(n=l[i])&&void 0!==n?n:Number.MAX_SAFE_INTEGER,o[1]),++s}return o}function G(t){return 0===t?0:Math.log10(t)}function U(t){return Math.pow(10,t)}function Z(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.join("_")}var q=function(){function t(t){this._requestIdleCallbackId=F,this._tasks=null!=t?t:[],this._operateTasks()}return t.prototype._operateTasks=function(t){var e,i=this;this._requestIdleCallbackId!==F&&(e=this._requestIdleCallbackId,n(window.cancelIdleCallback)?window.cancelIdleCallback(e):window.clearTimeout(e),this._requestIdleCallbackId=F),null==t||t(),this._requestIdleCallbackId=L((function(t){i._runTasks(t)}))},t.prototype._runTasks=function(t){for(var e=this;t.timeRemaining()>0&&this._tasks.length>0;){var i=this._tasks.shift();null==i||i.handler()}this._tasks.length>0&&(this._requestIdleCallbackId=L((function(t){e._runTasks(t)})))},t.prototype.addTask=function(t){var e=this;return this._operateTasks((function(){var i=e._tasks.findIndex((function(e){return e.id===t.id}));i>-1?e._tasks[i]=t:e._tasks.push(t)})),this},t.prototype.removeTask=function(t){var e=this;return s(t)&&this._operateTasks((function(){if(s(t)){var i=e._tasks.findIndex((function(e){return e.id===t}));i>-1&&e._tasks.splice(i,1)}else e._tasks=[]})),this},t}(),j=function(){function t(){this._callbacks=[]}return t.prototype.subscribe=function(t){this._callbacks.indexOf(t)<0&&this._callbacks.push(t)},t.prototype.unsubscribe=function(t){if(n(t)){var e=this._callbacks.indexOf(t);e>-1&&this._callbacks.splice(e,1)}else this._callbacks=[]},t.prototype.execute=function(t){this._callbacks.forEach((function(e){e(t)}))},t.prototype.isEmpty=function(){return 0===this._callbacks.length},t}();function Q(t){return"transparent"===t||"none"===t||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(t)||/^[hH][Ss][Ll][Aa]\(([\s]*(360ï½œ3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(t)}function K(t,e){var i=t.replace(/^#/,""),r=parseInt(i,16),n=r>>8&255,o=255&r;return"rgba(".concat(r>>16&255,", ").concat(n,", ").concat(o,", ").concat(null!=e?e:1,")")}var J={RED:"#F92855",GREEN:"#2DC08E",WHITE:"#FFFFFF",GREY:"#76808F",BLUE:"#1677FF"};function $(){return{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:J.GREY,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}}}function tt(t,e,i,r){var n,o=t.result,a=t.figures,l=t.styles,u=d(l,"circles",i.circles),c=u.length,h=d(l,"bars",i.bars),p=h.length,g=d(l,"lines",i.lines),v=g.length,f=0,m=0,y=0,_=0;a.forEach((function(a){var l;switch(a.type){case"circle":_=f;var d=u[f%c];n=T(T({},d),{color:d.noChangeColor}),f++;break;case"bar":_=m;var x=h[m%p];n=T(T({},x),{color:x.noChangeColor}),m++;break;case"line":_=y,n=g[y%v],y++}if(s(a.type)){var b=null===(l=a.styles)||void 0===l?void 0:l.call(a,{data:{prev:o[e-1],current:o[e],next:o[e+1]},indicator:t,defaultStyles:i});r(a,T(T({},n),b),_)}}))}var et=function(){function t(t){this.precision=4,this.calcParams=[],this.shouldOhlc=!1,this.shouldFormatBigNumber=!1,this.visible=!0,this.zLevel=0,this.series="normal",this.figures=[],this.minValue=null,this.maxValue=null,this.styles=null,this.shouldUpdate=function(t,e){var i=JSON.stringify(t.calcParams)!==JSON.stringify(e.calcParams)||t.figures!==e.figures||t.calc!==e.calc;return{calc:i,draw:i||t.shortName!==e.shortName||t.series!==e.series||t.minValue!==e.minValue||t.maxValue!==e.maxValue||t.precision!==e.precision||t.shouldOhlc!==e.shouldOhlc||t.shouldFormatBigNumber!==e.shouldFormatBigNumber||t.visible!==e.visible||t.zLevel!==e.zLevel||t.extendData!==e.extendData||t.regenerateFigures!==e.regenerateFigures||t.createTooltipDataSource!==e.createTooltipDataSource||t.draw!==e.draw}},this.calc=function(){return[]},this.regenerateFigures=null,this.createTooltipDataSource=null,this.draw=null,this.onDataStateChange=null,this.result=[],this._lockSeriesPrecision=!1,this.override(t),this._lockSeriesPrecision=!1}return t.prototype.override=function(t){var r,o,l=this.result,c=S(this,["result"]);this._prevIndicator=T(T({},i(c)),{result:l});var h=t.id,d=t.name,p=t.shortName,g=t.precision,v=t.styles,f=t.figures,m=t.calcParams,y=S(t,["id","name","shortName","precision","styles","figures","calcParams"]);!u(this.id)&&u(h)&&(this.id=h),u(this.name)||(this.name=null!=d?d:""),this.shortName=null!==(r=null!=p?p:this.shortName)&&void 0!==r?r:this.name,a(g)&&(this.precision=g,this._lockSeriesPrecision=!0),s(v)&&(null!==(o=this.styles)&&void 0!==o||(this.styles={}),e(this.styles,v)),e(this,y),s(m)&&(this.calcParams=m,n(this.regenerateFigures)&&(this.figures=this.regenerateFigures(this.calcParams))),this.figures=null!=f?f:this.figures},t.prototype.setSeriesPrecision=function(t){this._lockSeriesPrecision||(this.precision=t)},t.prototype.shouldUpdateImp=function(){var t=this._prevIndicator.zLevel!==this.zLevel,e=this.shouldUpdate(this._prevIndicator,this);return l(e)?{calc:e,draw:e,sort:t}:T(T({},e),{sort:t})},t.prototype.calcImp=function(t){return P(this,void 0,void 0,(function(){var e;return I(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))},t.extend=function(e){return function(t){function i(){return t.call(this,e)||this}return E(i,t),i}(t)},t}(),it={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(t){var e,i,r=t.data,n=t.indicator,o=t.defaultStyles,a=r.prev,s=r.current,l=null!==(e=null==a?void 0:a.ao)&&void 0!==e?e:Number.MIN_SAFE_INTEGER,u=null!==(i=null==s?void 0:s.ao)&&void 0!==i?i:Number.MIN_SAFE_INTEGER,c="";return{color:c=u>l?d(n.styles,"bars[0].upColor",o.bars[0].upColor):d(n.styles,"bars[0].downColor",o.bars[0].downColor),style:u>l?"stroke":"fill",borderColor:c}}}],calc:function(t,e){var i=e.calcParams,r=Math.max(i[0],i[1]),n=0,o=0,a=0,s=0;return t.map((function(e,l){var u={},c=(e.low+e.high)/2;if(n+=c,o+=c,l>=i[0]-1){a=n/i[0];var h=t[l-(i[0]-1)];n-=(h.low+h.high)/2}if(l>=i[1]-1){s=o/i[1];h=t[l-(i[1]-1)];o-=(h.low+h.high)/2}return l>=r-1&&(u.ao=a-s),u}))}};var rt={name:"BOLL",shortName:"BOLL",series:"price",calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=i[0]-1,n=0;return t.map((function(e,o){var a=e.close,s={};if(n+=a,o>=r){s.mid=n/i[0];var l=function(t,e){var i=t.length,r=0;return t.forEach((function(t){var i=t.close-e;r+=i*i})),r=Math.abs(r),Math.sqrt(r/i)}(t.slice(o-r,o+1),s.mid);s.up=s.mid+i[1]*l,s.dn=s.mid-i[1]*l,n-=t[o-r].close}return s}))}},nt={name:"BBI",shortName:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=Math.max.apply(Math,D([],k(i),!1)),n=[],o=[];return t.map((function(e,a){var s={},l=e.close;if(i.forEach((function(e,i){var r;n[i]=(null!==(r=n[i])&&void 0!==r?r:0)+l,a>=e-1&&(o[i]=n[i]/e,n[i]-=t[a-(e-1)].close)})),a>=r-1){var u=0;o.forEach((function(t){u+=t})),s.bbi=u/4}return s}))}},ot={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=i[0]-1,n=0,o=[];return t.map((function(e,a){var s={},l=(e.high+e.low+e.close)/3;if(n+=l,o.push(l),a>=r){var u=n/i[0],c=o.slice(a-r,a+1),h=0;c.forEach((function(t){h+=Math.abs(t-u)}));var d=h/i[0];s.cci=0!==d?(l-u)/d/.015:0;var p=(t[a-r].high+t[a-r].low+t[a-r].close)/3;n-=p}return s}))}},at={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=Math.ceil(i[1]/2.5+1),n=Math.ceil(i[2]/2.5+1),o=Math.ceil(i[3]/2.5+1),a=Math.ceil(i[4]/2.5+1),s=0,l=[],u=0,c=[],h=0,d=[],p=0,g=[],v=[];return t.forEach((function(e,f){var m,y,_,x,b,w={},C=null!==(m=t[f-1])&&void 0!==m?m:e,E=(C.high+C.close+C.low+C.open)/4,T=Math.max(0,e.high-E),S=Math.max(0,E-e.low);f>=i[0]-1&&(w.cr=0!==S?T/S*100:0,s+=w.cr,u+=w.cr,h+=w.cr,p+=w.cr,f>=i[0]+i[1]-2&&(l.push(s/i[1]),f>=i[0]+i[1]+r-3&&(w.ma1=l[l.length-1-r]),s-=null!==(y=v[f-(i[1]-1)].cr)&&void 0!==y?y:0),f>=i[0]+i[2]-2&&(c.push(u/i[2]),f>=i[0]+i[2]+n-3&&(w.ma2=c[c.length-1-n]),u-=null!==(_=v[f-(i[2]-1)].cr)&&void 0!==_?_:0),f>=i[0]+i[3]-2&&(d.push(h/i[3]),f>=i[0]+i[3]+o-3&&(w.ma3=d[d.length-1-o]),h-=null!==(x=v[f-(i[3]-1)].cr)&&void 0!==x?x:0),f>=i[0]+i[4]-2&&(g.push(p/i[4]),f>=i[0]+i[4]+a-3&&(w.ma4=g[g.length-1-a]),p-=null!==(b=v[f-(i[4]-1)].cr)&&void 0!==b?b:0)),v.push(w)})),v}},st={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=Math.max(i[0],i[1]),n=0,o=0,a=0,s=[];return t.forEach((function(e,l){var u,c={},h=e.close;n+=h,o+=h;var d=0,p=0;if(l>=i[0]-1&&(d=n/i[0],n-=t[l-(i[0]-1)].close),l>=i[1]-1&&(p=o/i[1],o-=t[l-(i[1]-1)].close),l>=r-1){var g=d-p;c.dma=g,a+=g,l>=r+i[2]-2&&(c.ama=a/i[2],a-=null!==(u=s[l-(i[2]-1)].dma)&&void 0!==u?u:0)}s.push(c)})),s}},lt={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=0,a=0,s=0,l=0,u=0,c=0,h=[];return t.forEach((function(e,d){var p,g,v={},f=null!==(p=t[d-1])&&void 0!==p?p:e,m=f.close,y=e.high,_=e.low,x=y-_,b=Math.abs(y-m),w=Math.abs(m-_),C=y-f.high,E=f.low-_,T=Math.max(Math.max(x,b),w),S=C>0&&C>E?C:0,P=E>0&&E>C?E:0;if(r+=T,n+=S,o+=P,d>=i[0]-1){d>i[0]-1?(a=a-a/i[0]+T,s=s-s/i[0]+S,l=l-l/i[0]+P):(a=r,s=n,l=o);var I=0,M=0;0!==a&&(I=100*s/a,M=100*l/a),v.pdi=I,v.mdi=M;var k=0;M+I!==0&&(k=Math.abs(M-I)/(M+I)*100),u+=k,d>=2*i[0]-2&&(c=d>2*i[0]-2?(c*(i[0]-1)+k)/i[0]:u/i[0],v.adx=c,d>=2*i[0]+i[1]-3&&(v.adxr=((null!==(g=h[d-(i[1]-1)].adx)&&void 0!==g?g:0)+c)/2))}h.push(v)})),h}},ut={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(t){var e,i,r=t.data,n=t.indicator,o=t.defaultStyles,a=r.prev,s=r.current,l=null!==(e=null==a?void 0:a.macd)&&void 0!==e?e:Number.MIN_SAFE_INTEGER,u=null!==(i=null==s?void 0:s.macd)&&void 0!==i?i:Number.MIN_SAFE_INTEGER,c="";return{style:l<u?"stroke":"fill",color:c=u>0?d(n.styles,"bars[0].upColor",o.bars[0].upColor):u<0?d(n.styles,"bars[0].downColor",o.bars[0].downColor):d(n.styles,"bars[0].noChangeColor",o.bars[0].noChangeColor),borderColor:c}}}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=0,a=0,s=0,l=0,u=Math.max(i[0],i[1]);return t.map((function(t,e){var c={},h=t.close;return r+=h,e>=i[0]-1&&(n=e>i[0]-1?(2*h+(i[0]-1)*n)/(i[0]+1):r/i[0]),e>=i[1]-1&&(o=e>i[1]-1?(2*h+(i[1]-1)*o)/(i[1]+1):r/i[1]),e>=u-1&&(a=n-o,c.dif=a,s+=a,e>=u+i[2]-2&&(l=e>u+i[2]-2?(2*a+l*(i[2]-1))/(i[2]+1):s/i[2],c.macd=2*(a-l),c.dea=l)),c}))}},ct={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,r=e.figures,n=[],o=[];return t.map((function(e,a){var s,l={},u=(null!==(s=t[a-1])&&void 0!==s?s:e).close,c=e.close-u;return i.forEach((function(e,i){var s,u,h;if(c>0?n[i]=(null!==(s=n[i])&&void 0!==s?s:0)+c:o[i]=(null!==(u=o[i])&&void 0!==u?u:0)+Math.abs(c),a>=e-1){0!==o[i]?l[r[i].key]=100-100/(1+n[i]/o[i]):l[r[i].key]=0;var d=t[a-(e-1)],p=null!==(h=t[a-e])&&void 0!==h?h:d,g=d.close-p.close;g>0?n[i]-=g:o[i]-=Math.abs(g)}})),l}))}},ht={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=[];return t.forEach((function(e,n){var o,a,s,l,u={},c=e.close;if(n>=i[0]-1){var h=X(t.slice(n-(i[0]-1),n+1),"high","low"),d=h[0],p=h[1],g=d-p,v=(c-p)/(0===g?1:g)*100;u.k=((i[1]-1)*(null!==(a=null===(o=r[n-1])||void 0===o?void 0:o.k)&&void 0!==a?a:50)+v)/i[1],u.d=((i[2]-1)*(null!==(l=null===(s=r[n-1])||void 0===s?void 0:s.d)&&void 0!==l?l:50)+u.k)/i[2],u.j=3*u.k-2*u.d}r.push(u)})),r}},dt={name:"SAR",shortName:"SAR",series:"price",calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(t){var e,i,r,n=t.data,o=t.indicator,a=t.defaultStyles,s=n.current;return{color:(null!==(e=null==s?void 0:s.sar)&&void 0!==e?e:Number.MIN_SAFE_INTEGER)<((null!==(i=null==s?void 0:s.high)&&void 0!==i?i:0)+(null!==(r=null==s?void 0:s.low)&&void 0!==r?r:0))/2?d(o.styles,"circles[0].upColor",a.circles[0].upColor):d(o.styles,"circles[0].downColor",a.circles[0].downColor)}}}],calc:function(t,e){var i=e.calcParams,r=i[0]/100,n=i[1]/100,o=i[2]/100,a=r,s=-100,l=!1,u=0;return t.map((function(e,i){var c=u,h=e.high,d=e.low;if(l){(-100===s||s<h)&&(s=h,a=Math.min(a+n,o)),u=c+a*(s-c);var p=Math.min(t[Math.max(1,i)-1].low,d);u>e.low?(u=s,a=r,s=-100,l=!l):u>p&&(u=p)}else{(-100===s||s>d)&&(s=d,a=Math.min(a+n,o)),u=c+a*(s-c);var g=Math.max(t[Math.max(1,i)-1].high,h);u<e.high?(u=s,a=0,s=-100,l=!l):u<g&&(u=g)}return{high:h,low:d,sar:u}}))}};function pt(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t){var e=t.data,i=t.indicator,r=t.defaultStyles,n=e.current,o=d(i.styles,"bars[0].noChangeColor",r.bars[0].noChangeColor);return s(n)&&(n.close>n.open?o=d(i.styles,"bars[0].upColor",r.bars[0].upColor):n.close<n.open&&(o=d(i.styles,"bars[0].downColor",r.bars[0].downColor))),{color:o}}}}var gt={name:"VOL",shortName:"VOL",series:"volume",calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},pt()],regenerateFigures:function(t){var e=t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}));return e.push(pt()),e},calc:function(t,e){var i=e.calcParams,r=e.figures,n=[];return t.map((function(e,o){var a,s=null!==(a=e.volume)&&void 0!==a?a:0,l={volume:s,open:e.open,close:e.close};return i.forEach((function(e,i){var a,u;n[i]=(null!==(a=n[i])&&void 0!==a?a:0)+s,o>=e-1&&(l[r[i].key]=n[i]/e,n[i]-=null!==(u=t[o-(e-1)].volume)&&void 0!==u?u:0)})),l}))}},vt={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,r=e.figures;return t.map((function(e,n){var o={},a=e.close;return i.forEach((function(e,i){var s=e-1;if(n>=s){var l=X(t.slice(n-s,n+1),"high","low"),u=l[0],c=u-l[1];o[r[i].key]=0===c?0:(a-u)/c*100}})),o}))}},ft={},mt=[{name:"AVP",shortName:"AVP",series:"price",precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(t){var e=0,i=0;return t.map((function(t){var r,n,o={},a=null!==(r=t.turnover)&&void 0!==r?r:0,s=null!==(n=t.volume)&&void 0!==n?n:0;return e+=a,0!==(i+=s)&&(o.avp=e/i),o}))}},it,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,r=e.figures,n=[];return t.map((function(e,o){var a={},s=e.close;return i.forEach((function(e,l){var u;if(n[l]=(null!==(u=n[l])&&void 0!==u?u:0)+s,o>=e-1){var c=n[l]/i[l];a[r[l].key]=(s-c)/c*100,n[l]-=t[o-(e-1)].close}})),a}))}},rt,{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=0,a=0;return t.map((function(e,s){var l,u,c={},h=e.high,d=e.low,p=e.open,g=(null!==(l=t[s-1])&&void 0!==l?l:e).close;if(o+=h-p,a+=p-d,r+=h-g,n+=g-d,s>=i[0]-1){c.ar=0!==a?o/a*100:0,c.br=0!==n?r/n*100:0;var v=t[s-(i[0]-1)],f=v.high,m=v.low,y=v.open,_=(null!==(u=t[s-i[0]])&&void 0!==u?u:t[s-(i[0]-1)]).close;r-=f-_,n-=_-m,o-=f-y,a-=y-m}return c}))}},nt,ot,at,st,lt,{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=[];return t.map((function(e,o){var a,s={};if(o>0){var l=t[o-1],u=e.high,c=e.low,h=null!==(a=e.volume)&&void 0!==a?a:0,d=(u+c)/2-(l.high+l.low)/2;if(0===h||u-c==0)s.emv=0;else{var p=h/1e8/(u-c);s.emv=d/p}r+=s.emv,n.push(s.emv),o>=i[0]&&(s.maEmv=r/i[0],r-=n[o-i[0]])}return s}))}},{name:"EMA",shortName:"EMA",series:"price",calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,r=e.figures,n=0,o=[];return t.map((function(t,e){var a={},s=t.close;return n+=s,i.forEach((function(t,i){e>=t-1&&(o[i]=e>t-1?(2*s+(t-1)*o[i])/(t+1):n/t,a[r[i].key]=o[i])})),a}))}},{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=[];return t.forEach((function(e,o){var a,s={};if(o>=i[0]){var l=e.close,u=t[o-i[0]].close;s.mtm=l-u,r+=s.mtm,o>=i[0]+i[1]-1&&(s.maMtm=r/i[1],r-=null!==(a=n[o-(i[1]-1)].mtm)&&void 0!==a?a:0)}n.push(s)})),n}},{name:"MA",shortName:"MA",series:"price",calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA30: ",type:"line"},{key:"ma4",title:"MA60: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,r=e.figures,n=[];return t.map((function(e,o){var a={},s=e.close;return i.forEach((function(e,i){var l;n[i]=(null!==(l=n[i])&&void 0!==l?l:0)+s,o>=e-1&&(a[r[i].key]=n[i]/e,n[i]-=t[o-(e-1)].close)})),a}))}},ut,{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=[];return t.forEach((function(e,a){var s,l,u,c,h=null!==(s=t[a-1])&&void 0!==s?s:e;e.close<h.close?n-=null!==(l=e.volume)&&void 0!==l?l:0:e.close>h.close&&(n+=null!==(u=e.volume)&&void 0!==u?u:0);var d={obv:n};r+=n,a>=i[0]-1&&(d.maObv=r/i[0],r-=null!==(c=o[a-(i[0]-1)].obv)&&void 0!==c?c:0),o.push(d)})),o}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(t){var e=0;return t.map((function(i,r){var n,o,a={},s=i.close,l=null!==(n=i.volume)&&void 0!==n?n:1,u=(null!==(o=t[r-1])&&void 0!==o?o:i).close,c=0,h=u*l;return 0!==h&&(c=(s-u)/h),e+=c,a.pvt=e,a}))}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=[],a=[];return t.forEach((function(e,s){var l,u,c={},h=(null!==(l=t[s-1])&&void 0!==l?l:e).close,d=e.close-h>0?1:0;o.push(d),r+=d,s>=i[0]-1&&(c.psy=r/i[0]*100,n+=c.psy,s>=i[0]+i[1]-2&&(c.maPsy=n/i[1],n-=null!==(u=a[s-(i[1]-1)].psy)&&void 0!==u?u:0),r-=o[s-(i[0]-1)]),a.push(c)})),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=[],n=0;return t.forEach((function(e,o){var a,s,l={};if(o>=i[0]-1){var u=e.close,c=(null!==(a=t[o-i[0]])&&void 0!==a?a:t[o-(i[0]-1)]).close;l.roc=0!==c?(u-c)/c*100:0,n+=l.roc,o>=i[0]-1+i[1]-1&&(l.maRoc=n/i[1],n-=null!==(s=r[o-(i[1]-1)].roc)&&void 0!==s?s:0)}r.push(l)})),r}},ct,{name:"SMA",shortName:"SMA",series:"price",calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(t,e){var i=e.calcParams,r=0,n=0;return t.map((function(t,e){var o={},a=t.close;return r+=a,e>=i[0]-1&&(n=e>i[0]-1?(a*i[1]+n*(i[0]-i[1]+1))/(i[0]+1):r/i[0],o.sma=n),o}))}},ht,dt,{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=0,a=0,s=0,l=0,u=0,c=[];return t.forEach((function(t,e){var h,d={},p=t.close;if(r+=p,e>=i[0]-1&&(n=e>i[0]-1?(2*p+(i[0]-1)*n)/(i[0]+1):r/i[0],s+=n,e>=2*i[0]-2&&(o=e>2*i[0]-2?(2*n+(i[0]-1)*o)/(i[0]+1):s/i[0],l+=o,e>=3*i[0]-3))){var g=0,v=0;e>3*i[0]-3?v=((g=(2*o+(i[0]-1)*a)/(i[0]+1))-a)/a*100:g=l/i[0],a=g,d.trix=v,u+=v,e>=3*i[0]+i[1]-4&&(d.maTrix=u/i[1],u-=null!==(h=c[e-(i[1]-1)].trix)&&void 0!==h?h:0)}c.push(d)})),c}},gt,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,r=0,n=0,o=0,a=0,s=[];return t.forEach((function(e,l){var u,c,h,d,p,g={},v=e.close,f=(null!==(u=t[l-1])&&void 0!==u?u:e).close,m=null!==(c=e.volume)&&void 0!==c?c:0;if(v>f?r+=m:v<f?n+=m:o+=m,l>=i[0]-1){var y=o/2;g.vr=n+y===0?0:(r+y)/(n+y)*100,a+=g.vr,l>=i[0]+i[1]-2&&(g.maVr=a/i[1],a-=null!==(h=s[l-(i[1]-1)].vr)&&void 0!==h?h:0);var _=t[l-(i[0]-1)],x=null!==(d=t[l-i[0]])&&void 0!==d?d:_,b=_.close,w=null!==(p=_.volume)&&void 0!==p?p:0;b>x.close?r-=w:b<x.close?n-=w:o-=w}s.push(g)})),s}},vt];function yt(t){var e;return null!==(e=ft[t])&&void 0!==e?e:null}function _t(t,e){var i,r=null!==(i=null==e?void 0:e.ignoreEvent)&&void 0!==i&&i;return l(r)?!r:!r.includes(t)}mt.forEach((function(t){ft[t.name]=et.extend(t)}));var xt="overlay_figure_",bt=function(){function t(t){this.groupId="",this.totalStep=1,this.currentStep=1,this.lock=!1,this.visible=!0,this.zLevel=0,this.needDefaultPointFigure=!1,this.needDefaultXAxisFigure=!1,this.needDefaultYAxisFigure=!1,this.mode="normal",this.modeSensitivity=8,this.points=[],this.styles=null,this.createPointFigures=null,this.createXAxisFigures=null,this.createYAxisFigures=null,this.performEventPressedMove=null,this.performEventMoveForDrawing=null,this.onDrawStart=null,this.onDrawing=null,this.onDrawEnd=null,this.onClick=null,this.onDoubleClick=null,this.onRightClick=null,this.onPressedMoveStart=null,this.onPressedMoving=null,this.onPressedMoveEnd=null,this.onMouseMove=null,this.onMouseEnter=null,this.onMouseLeave=null,this.onRemoved=null,this.onSelected=null,this.onDeselected=null,this._prevZLevel=0,this._prevPressedPoint=null,this._prevPressedPoints=[],this.override(t)}return t.prototype.override=function(t){var o,a;this._prevOverlay=i(this);var l=t.id,c=t.name;t.currentStep;var h=t.points,d=t.styles;if(e(this,S(t,["id","name","currentStep","points","styles"])),u(this.name)||(this.name=null!=c?c:""),!u(this.id)&&u(l)&&(this.id=l),s(d)&&(null!==(o=this.styles)&&void 0!==o||(this.styles={}),e(this.styles,d)),r(h)&&h.length>0){var p=0;if(this.points=D([],k(h),!1),h.length>=this.totalStep-1?(this.currentStep=-1,p=this.totalStep-1):(this.currentStep=h.length+1,p=h.length),n(this.performEventMoveForDrawing))for(var g=0;g<p;g++)this.performEventMoveForDrawing({currentStep:g+2,mode:this.mode,points:this.points,performPointIndex:g,performPoint:this.points[g]});-1===this.currentStep&&(null===(a=this.performEventPressedMove)||void 0===a||a.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}))}},t.prototype.getPrevZLevel=function(){return this._prevZLevel},t.prototype.setPrevZLevel=function(t){this._prevZLevel=t},t.prototype.shouldUpdate=function(){var t=this._prevOverlay.zLevel!==this.zLevel;return{sort:t,draw:t||JSON.stringify(this._prevOverlay.points)!==JSON.stringify(this.points)||this._prevOverlay.visible!==this.visible||this._prevOverlay.extendData!==this.extendData||this._prevOverlay.styles!==this.styles}},t.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},t.prototype.forceComplete=function(){this.currentStep=-1},t.prototype.isDrawing=function(){return-1!==this.currentStep},t.prototype.isStart=function(){return 1===this.currentStep},t.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,r={};a(t.timestamp)&&(r.timestamp=t.timestamp),a(t.dataIndex)&&(r.dataIndex=t.dataIndex),a(t.value)&&(r.value=t.value),this.points[i]=r,null===(e=this.performEventMoveForDrawing)||void 0===e||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:r})},t.prototype.eventPressedPointMove=function(t,e){var i;this.points[e].timestamp=t.timestamp,a(t.value)&&(this.points[e].value=t.value),null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},t.prototype.startPressedMove=function(t){this._prevPressedPoint=T({},t),this._prevPressedPoints=i(this.points)},t.prototype.eventPressedOtherMove=function(t,e){if(null!==this._prevPressedPoint){var i=null;a(t.dataIndex)&&a(this._prevPressedPoint.dataIndex)&&(i=t.dataIndex-this._prevPressedPoint.dataIndex);var r=null;a(t.value)&&a(this._prevPressedPoint.value)&&(r=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map((function(t){var n;a(t.timestamp)&&(t.dataIndex=e.timestampToDataIndex(t.timestamp));var o=T({},t);return a(i)&&a(t.dataIndex)&&(o.dataIndex=t.dataIndex+i,o.timestamp=null!==(n=e.dataIndexToTimestamp(o.dataIndex))&&void 0!==n?n:void 0),a(r)&&a(t.value)&&(o.value=t.value+r),o}))}},t.extend=function(e){return function(t){function i(){return t.call(this,e)||this}return E(i,t),i}(t)},t}(),wt={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e,i,r,n=t.chart,o=t.coordinates,s=t.bounding,l=t.overlay,u=t.yAxis,c=l.points;if(o.length>0){var h=0;if(null===(e=null==u?void 0:u.isInCandle())||void 0===e||e)h=null!==(r=null===(i=n.getSymbol())||void 0===i?void 0:i.pricePrecision)&&void 0!==r?r:2;else n.getIndicators({paneId:l.paneId}).forEach((function(t){h=Math.max(h,t.precision)}));var d=[],p=[],g=s.width;if(o.length>1&&a(c[0].value)&&a(c[1].value)){var v=o[0].y-o[1].y,f=c[0].value-c[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var e,i=o[1].y+v*t,r=n.getDecimalFold().format(n.getThousandsSeparator().format(((null!==(e=c[1].value)&&void 0!==e?e:0)+f*t).toFixed(h)));d.push({coordinates:[{x:0,y:i},{x:g,y:i}]}),p.push({x:0,y:i,text:"".concat(r," (").concat((100*t).toFixed(1),"%)"),baseline:"bottom"})}))}return[{type:"line",attrs:d},{type:"text",isCheckEvent:!1,attrs:p}]}return[]}},Ct={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,r={x:0,y:e[0].y};return s(e[1])&&e[0].x<e[1].x&&(r.x=i.width),[{type:"line",attrs:{coordinates:[e[0],r]}}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,r=t.performPoint;2===e&&(i[0].value=r.value)}},Et=function(){function t(){this._children=[],this._callbacks=new Map}return t.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},t.prototype.onEvent=function(t,e){var i=this._callbacks.get(t);return!(!s(i)||!this.checkEventOn(e))&&i(e)},t.prototype.dispatchEventToChildren=function(t,e){var i=this._children.length-1;if(i>-1)for(var r=i;r>-1;r--)if(this._children[r].dispatchEvent(t,e))return!0;return!1},t.prototype.dispatchEvent=function(t,e){return!!this.dispatchEventToChildren(t,e)||this.onEvent(t,e)},t.prototype.addChild=function(t){return this._children.push(t),this},t.prototype.clear=function(){this._children=[]},t}(),Tt=function(t){function e(e){var i=t.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return E(e,t),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.setAttrs=function(t){return this.attrs=t,this},e.prototype.setStyles=function(t){return this.styles=t,this},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return E(i,e),i.prototype.checkEventOnImp=function(e,i,r){return t.checkEventOn(e,i,r)},i.prototype.drawImp=function(e,i,r){t.draw(e,i,r)},i}(e);return i},e}(Et);function St(t,e){var i,r,n=[];n=n.concat(e);try{for(var o=M(n),a=o.next();!a.done;a=o.next()){var s=a.value.coordinates;if(s.length>1)for(var l=1;l<s.length;l++){var u=s[l-1],c=s[l];if(u.x===c.x){if(Math.abs(u.y-t.y)+Math.abs(c.y-t.y)-Math.abs(u.y-c.y)<4&&Math.abs(t.x-u.x)<2)return!0}else{var h=Mt(u,c),d=Pt(h,t),p=Math.abs(d-t.y);if(Math.abs(u.x-t.x)+Math.abs(c.x-t.x)-Math.abs(u.x-c.x)<4&&p*p/(h[0]*h[0]+1)<4)return!0}}}}catch(t){i={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return!1}function Pt(t,e){return null!==t?e.x*t[0]+t[1]:e.y}function It(t,e,i){return Pt(Mt(t,e),i)}function Mt(t,e){var i=t.x-e.x;if(0!==i){var r=(t.y-e.y)/i;return[r,t.y-r*t.x]}return null}function kt(t,e,i){var r=e.length,n=a(i)?i>0&&i<1?i:0:i?.5:0;if(n>0&&r>2){for(var o=e[0].x,s=e[0].y,l=1;l<r-1;l++){var u=e[l-1],c=e[l],h=e[l+1],d=c.x-u.x,p=c.y-u.y,g=h.x-c.x,v=h.y-c.y,f=h.x-u.x,m=h.y-u.y,y=Math.sqrt(d*d+p*p),_=Math.sqrt(g*g+v*v),x=_/(_+y),b=c.x+f*n*x,w=c.y+m*n*x;b=Math.min(b,Math.max(h.x,c.x)),w=Math.min(w,Math.max(h.y,c.y)),b=Math.max(b,Math.min(h.x,c.x)),w=Math.max(w,Math.min(h.y,c.y)),f=b-c.x,m=w-c.y;var C=c.x-f*y/_,E=c.y-m*y/_;C=Math.min(C,Math.max(u.x,c.x)),E=Math.min(E,Math.max(u.y,c.y)),C=Math.max(C,Math.min(u.x,c.x)),E=Math.max(E,Math.min(u.y,c.y)),f=c.x-C,m=c.y-E,b=c.x+f*_/y,w=c.y+m*_/y,t.bezierCurveTo(o,s,C,E,c.x,c.y),o=b,s=w}var T=e[r-1];t.bezierCurveTo(o,s,T.x,T.y,T.x,T.y)}else for(l=1;l<r;l++)t.lineTo(e[l].x,e[l].y)}var Dt={name:"line",checkEventOn:St,draw:function(t,e,i){!function(t,e,i){var r=[];r=r.concat(e);var n=i.style,o=void 0===n?"solid":n,a=i.smooth,s=void 0!==a&&a,l=i.size,u=void 0===l?1:l,c=i.color,h=void 0===c?"currentColor":c,d=i.dashedValue,p=void 0===d?[2,2]:d;t.lineWidth=u,t.strokeStyle=h,"dashed"===o?t.setLineDash(p):t.setLineDash([]);var g=u%2==1?.5:0;r.forEach((function(e){var i=e.coordinates;i.length>1&&(2!==i.length||i[0].x!==i[1].x&&i[0].y!==i[1].y?(t.save(),u%2==1&&t.translate(.5,.5),t.beginPath(),t.moveTo(i[0].x,i[0].y),kt(t,i,s),t.stroke(),t.closePath(),t.restore()):(t.beginPath(),i[0].x===i[1].x?(t.moveTo(i[0].x+g,i[0].y),t.lineTo(i[1].x+g,i[1].y)):(t.moveTo(i[0].x,i[0].y+g),t.lineTo(i[1].x,i[1].y+g)),t.stroke(),t.closePath()))}))}(t,e,i)}};function At(t,e,i){var r=null!=i?i:0,n=[];if(t.length>1)if(t[0].x===t[1].x){var o=e.height;if(n.push({coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:o}]}),t.length>2){n.push({coordinates:[{x:t[2].x,y:0},{x:t[2].x,y:o}]});for(var a=t[0].x-t[2].x,s=0;s<r;s++){var l=a*(s+1);n.push({coordinates:[{x:t[0].x+l,y:0},{x:t[0].x+l,y:o}]})}}}else{var u=e.width,c=Mt(t[0],t[1]),h=c[0],d=c[1];if(n.push({coordinates:[{x:0,y:0*h+d},{x:u,y:u*h+d}]}),t.length>2){var p=t[2].y-h*t[2].x;n.push({coordinates:[{x:0,y:0*h+p},{x:u,y:u*h+p}]});for(a=d-p,s=0;s<r;s++){var g=d+a*(s+1);n.push({coordinates:[{x:0,y:0*h+g},{x:u,y:u*h+g}]})}}}return n}function Ft(t,e){if(t.length>1){var i={x:0,y:0};return i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[0].y<t[1].y?{x:t[0].x,y:e.height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:It(t[0],t[1],{x:0,y:t[0].y})}:{x:e.width,y:It(t[0],t[1],{x:e.width,y:t[0].y})},{coordinates:[t[0],i]}}return[]}var Bt={name:"simpleAnnotation",totalStep:2,styles:{line:{style:"dashed"}},createPointFigures:function(t){var e,i=t.overlay,r=t.coordinates,o="";s(i.extendData)&&(o=n(i.extendData)?i.extendData(i):null!==(e=i.extendData)&&void 0!==e?e:"");var a=r[0].x,l=r[0].y-6,u=l-50,c=u-5;return[{type:"line",attrs:{coordinates:[{x:a,y:l},{x:a,y:u}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:a,y:u},{x:a-4,y:c},{x:a+4,y:c}]},ignoreEvent:!0},{type:"text",attrs:{x:a,y:c,text:o,align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Rt={name:"simpleTag",totalStep:2,styles:{line:{style:"dashed"}},createPointFigures:function(t){var e=t.bounding,i=t.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:i[0].y},{x:e.width,y:i[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(t){var e,i,r,o,l=t.chart,u=t.overlay,c=t.coordinates,h=t.bounding,d=t.yAxis,p="left",v=0;null!==(e=null==d?void 0:d.isFromZero())&&void 0!==e&&e?(p="left",v=0):(p="right",v=h.width);var f="";return s(u.extendData)&&(f=n(u.extendData)?u.extendData(u):null!==(i=u.extendData)&&void 0!==i?i:""),!s(f)&&a(u.points[0].value)&&(f=g(u.points[0].value,null!==(o=null===(r=l.getSymbol())||void 0===r?void 0:r.pricePrecision)&&void 0!==o?o:2)),{type:"text",attrs:{x:v,y:c[0].y,text:f,align:p,baseline:"middle"}}}},Lt={};function Ot(t){var e;return null!==(e=Lt[t])&&void 0!==e?e:null}[wt,Ct,{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=[];return 2===e.length&&i.push({coordinates:e}),[{type:"line",attrs:i}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,r=t.performPoint;2===e&&(i[0].value=r.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.width,y:e[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:At(t.coordinates,t.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:At(t.coordinates,t.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e,i,r,n=t.chart,o=t.coordinates,a=t.bounding,s=t.overlay,l=t.yAxis,u=0;null===(e=null==l?void 0:l.isInCandle())||void 0===e||e?u=null!==(r=null===(i=n.getSymbol())||void 0===i?void 0:i.pricePrecision)&&void 0!==r?r:2:n.getIndicators({paneId:s.paneId}).forEach((function(t){u=Math.max(u,t.precision)}));var c=s.points[0].value,h=void 0===c?0:c;return[{type:"line",attrs:{coordinates:[o[0],{x:a.width,y:o[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:o[0].x,y:o[0].y,text:n.getDecimalFold().format(n.getThousandsSeparator().format(h.toFixed(u))),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:Ft(t.coordinates,t.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return 2===e.length?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:It(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:It(e[0],e[1],{x:i.width,y:e[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;if(2===e.length){var r={x:e[0].x,y:0};return e[0].y<e[1].y&&(r.y=i.height),[{type:"line",attrs:{coordinates:[e[0],r]}}]}return[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,r=t.performPoint;2===e&&(i[0].timestamp=r.timestamp,i[0].dataIndex=r.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,r=t.performPoint;2===e&&(i[0].timestamp=r.timestamp,i[0].dataIndex=r.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]}},Bt,Rt].forEach((function(t){Lt[t.name]=bt.extend(t)}));var Wt={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},title:{color:"#76808F"},legend:{color:"#76808F"}}},indicator:{tooltip:{title:{color:"#76808F"},legend:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},title:{color:"#929AA5"},legend:{color:"#929AA5"}}},indicator:{tooltip:{title:{color:"#929AA5"},legend:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function Vt(t){var e;return null!==(e=Wt[t])&&void 0!==e?e:null}var zt="candle_pane",Nt="indicator_pane_",Yt="x_axis_pane",Ht=1,Xt=50,Gt=function(){function t(t,e){var i,r,n,o,a,l=this;this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:"dashed",dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:"dashed",dashedValue:[2,2]}},candle:(a={show:!0,color:J.GREY,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},{type:"candle_solid",bar:{compareRule:"current_open",upColor:J.GREEN,downColor:J.RED,noChangeColor:J.GREY,upBorderColor:J.GREEN,downBorderColor:J.RED,noChangeBorderColor:J.GREY,upWickColor:J.GREEN,downWickColor:J.RED,noChangeWickColor:J.GREY},area:{lineSize:2,lineColor:J.BLUE,smooth:!1,value:"close",backgroundColor:[{offset:0,color:K(J.BLUE,.01)},{offset:1,color:K(J.BLUE,.2)}],point:{show:!0,color:J.BLUE,radius:4,rippleColor:K(J.BLUE,.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:T({},a),low:T({},a),last:{show:!0,compareRule:"current_open",upColor:J.GREEN,downColor:J.RED,noChangeColor:J.GREY,line:{show:!0,style:"dashed",dashedValue:[4,4],size:1},text:{show:!0,style:"fill",size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:"solid",borderSize:0,borderDashedValue:[2,2],color:J.WHITE,family:"Helvetica Neue",weight:"normal",borderRadius:2},extendTexts:[]}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:"always",showType:"standard",rect:{position:"fixed",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},title:{show:!0,size:14,family:"Helvetica Neue",weight:"normal",color:J.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,template:"{ticker} Â· {period}"},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:J.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a",template:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]},features:[]}}),indicator:(n=K(J.GREEN,.7),o=K(J.RED,.7),{ohlc:{compareRule:"current_open",upColor:n,downColor:o,noChangeColor:J.GREY},bars:[{style:"fill",borderStyle:"solid",borderSize:1,borderDashedValue:[2,2],upColor:n,downColor:o,noChangeColor:J.GREY}],lines:["#FF9600","#935EBD",J.BLUE,"#E11D74","#01C5C4"].map((function(t){return{style:"solid",smooth:!1,size:1,dashedValue:[2,2],color:t}})),circles:[{style:"fill",borderStyle:"solid",borderSize:1,borderDashedValue:[2,2],upColor:n,downColor:o,noChangeColor:J.GREY}],lastValueMark:{show:!1,text:{show:!1,style:"fill",color:J.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:"always",showType:"standard",title:{show:!0,showName:!0,showParams:!0,size:12,family:"Helvetica Neue",weight:"normal",color:J.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:J.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a"},features:[]}}),xAxis:$(),yAxis:$(),separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:K(J.BLUE,.08)},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:"dashed",dashedValue:[4,2],size:1,color:J.GREY},text:{show:!0,style:"fill",color:J.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderColor:J.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:J.GREY},features:[]},vertical:{show:!0,line:{show:!0,style:"dashed",dashedValue:[4,2],size:1,color:J.GREY},text:{show:!0,style:"fill",color:J.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderColor:J.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:J.GREY}}},overlay:(i=K(J.BLUE,.35),r=K(J.BLUE,.25),{point:{color:J.BLUE,borderColor:i,borderSize:1,radius:5,activeColor:J.BLUE,activeBorderColor:i,activeBorderSize:3,activeRadius:5},line:{style:"solid",smooth:!1,color:J.BLUE,size:1,dashedValue:[2,2]},rect:{style:"fill",color:r,borderColor:J.BLUE,borderSize:1,borderRadius:0,borderStyle:"solid",borderDashedValue:[2,2]},polygon:{style:"fill",color:J.BLUE,borderColor:J.BLUE,borderSize:1,borderStyle:"solid",borderDashedValue:[2,2]},circle:{style:"fill",color:r,borderColor:J.BLUE,borderSize:1,borderStyle:"solid",borderDashedValue:[2,2]},arc:{style:"solid",color:J.BLUE,size:1,dashedValue:[2,2]},text:{style:"fill",color:J.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:J.BLUE,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:J.BLUE}})},this._formatter={formatDate:function(t){return p(t.dateTimeFormat,t.timestamp,t.template)},formatBigNumber:v,formatExtendText:function(t){return""}},this._innerFormatter={formatDate:function(t,e,i){return l._formatter.formatDate({dateTimeFormat:l._dateTimeFormat,timestamp:t,template:e,type:i})},formatBigNumber:function(t){return l._formatter.formatBigNumber(t)},formatExtendText:function(t){return l._formatter.formatExtendText(t)}},this._locale="en-US",this._thousandsSeparator={sign:",",format:function(t){return f(t,l._thousandsSeparator.sign)}},this._decimalFold={threshold:3,format:function(t){return m(t,l._decimalFold.threshold)}},this._symbol=null,this._period=null,this._dataList=[],this._dataLoader=null,this._loading=!1,this._dataLoadMore={forward:!1,backward:!1},this._zoomEnabled=!0,this._scrollEnabled=!0,this._totalBarSpace=0,this._barSpace=10,this._offsetRightDistance=80,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole="bar_count",this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._crosshair={},this._actions=new Map,this._indicators=new Map,this._taskScheduler=new q,this._overlays=new Map,this._progressOverlayInfo=null,this._lastPriceMarkExtendTextUpdateTimers=[],this._pressedOverlayInfo={paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null},this._hoverOverlayInfo={paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null},this._clickOverlayInfo={paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null},this._chart=t,this._calcOptimalBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace;var c=null!=e?e:{},h=c.styles,d=c.locale,g=c.timezone,y=c.formatter,_=c.thousandsSeparator,x=c.decimalFold;s(h)&&this.setStyles(h),u(d)&&this.setLocale(d),this.setTimezone(null!=g?g:""),s(y)&&this.setFormatter(y),s(_)&&this.setThousandsSeparator(_),s(x)&&this.setDecimalFold(x)}return t.prototype.setStyles=function(t){var i,n,o,a,l,c,h=this,d=null;if(d=u(t)?Vt(t):t,e(this._styles,d),r(null===(o=null===(n=null===(i=null==d?void 0:d.candle)||void 0===i?void 0:i.tooltip)||void 0===n?void 0:n.legend)||void 0===o?void 0:o.template)&&(this._styles.candle.tooltip.legend.template=d.candle.tooltip.legend.template),s(null===(c=null===(l=null===(a=null==d?void 0:d.candle)||void 0===a?void 0:a.priceMark)||void 0===l?void 0:l.last)||void 0===c?void 0:c.extendTexts)){this._clearLastPriceMarkExtendTextUpdateTimer();var p=[];this._styles.candle.priceMark.last.extendTexts.forEach((function(t){var e=t.updateInterval;if(t.show&&e>0&&!p.includes(e)){p.push(e);var i=setInterval((function(){h._chart.updatePane(0,zt)}),e);h._lastPriceMarkExtendTextUpdateTimers.push(i)}}))}},t.prototype.getStyles=function(){return this._styles},t.prototype.setFormatter=function(t){e(this._formatter,t)},t.prototype.getFormatter=function(){return this._formatter},t.prototype.getInnerFormatter=function(){return this._innerFormatter},t.prototype.setLocale=function(t){this._locale=t},t.prototype.getLocale=function(){return this._locale},t.prototype.setTimezone=function(t){if(!s(this._dateTimeFormat)||this.getTimezone()!==t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};t.length>0&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(t){}null!==i&&(this._dateTimeFormat=i)}},t.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},t.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},t.prototype.setThousandsSeparator=function(t){e(this._thousandsSeparator,t)},t.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},t.prototype.setDecimalFold=function(t){e(this._decimalFold,t)},t.prototype.getDecimalFold=function(){return this._decimalFold},t.prototype.setSymbol=function(t){this._processDataUnsubscribe(),this._symbol=t,this._synchronizeIndicatorSeriesPrecision(),this.resetData()},t.prototype.getSymbol=function(){return this._symbol},t.prototype.setPeriod=function(t){this._processDataUnsubscribe(),this._period=t,this.resetData()},t.prototype.getPeriod=function(){return this._period},t.prototype.getDataList=function(){return this._dataList},t.prototype.getVisibleRangeDataList=function(){return this._visibleRangeDataList},t.prototype.getVisibleRangeHighLowPrice=function(){return this._visibleRangeHighLowPrice},t.prototype._addData=function(t,e,i){var n,o,a=this,s=!1,u=!1,c=0;if(r(t)){var h={backward:!1,forward:!1};switch(l(i)?(h.backward=i,h.forward=i):(h.backward=null!==(n=null==i?void 0:i.backward)&&void 0!==n&&n,h.forward=null!==(o=null==i?void 0:i.forward)&&void 0!==o&&o),c=t.length,e){case"init":this._clearData(),this._dataList=t,this._dataLoadMore.backward=h.backward,this._dataLoadMore.forward=h.forward,this.setOffsetRightDistance(this._offsetRightDistance),u=!0;break;case"backward":this._dataList=this._dataList.concat(t),this._dataLoadMore.backward=h.backward,this._lastBarRightSideDiffBarCount-=c,u=c>0;break;case"forward":this._dataList=t.concat(this._dataList),this._dataLoadMore.forward=h.forward,u=c>0}s=!0}else{var p=this._dataList.length,g=t.timestamp,v=d(this._dataList[p-1],"timestamp",0);if(g>v){this._dataList.push(t);var f=this.getLastBarRightSideDiffBarCount();f<0&&this.setLastBarRightSideDiffBarCount(--f),c=1,s=!0,u=!0}else g===v&&(this._dataList[p-1]=t,s=!0,u=!0)}s&&(u&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this.getIndicatorsByFilter({}).forEach((function(t){a._addIndicatorCalcTask(t,e)})),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:"init"!==e})))},t.prototype.setDataLoader=function(t){this._dataLoader=t,this.resetData()},t.prototype._calcOptimalBarSpace=function(){var t=1-.2*Math.atan(Math.max(4,this._barSpace)-4)/(.5*Math.PI),e=Math.min(Math.floor(this._barSpace*t),Math.floor(this._barSpace));e%2==0&&e+2>=this._barSpace&&--e,this._gapBarSpace=Math.max(1,e)},t.prototype._adjustVisibleRange=function(){var t,e,i=this._dataList.length,r=this._totalBarSpace/this._barSpace,n=0,o=0;"distance"===this._scrollLimitRole?(n=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,o=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(n=this._minVisibleBarCount.left,o=this._minVisibleBarCount.right),n=Math.max(0,n),o=Math.max(0,o);var a=r-Math.min(n,i);this._lastBarRightSideDiffBarCount>a&&(this._lastBarRightSideDiffBarCount=a);var l=-i+Math.min(o,i);this._lastBarRightSideDiffBarCount<l&&(this._lastBarRightSideDiffBarCount=l);var u=Math.round(this._lastBarRightSideDiffBarCount+i+.5),c=u;u>i&&(u=i);var h=Math.round(u-r)-1;h<0&&(h=0);var d=this._lastBarRightSideDiffBarCount>0?Math.round(i+this._lastBarRightSideDiffBarCount-r)-1:h;this._visibleRange={from:h,to:u,realFrom:d,realTo:c},this.executeAction("onVisibleRangeChange",this._visibleRange),this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}];for(var p=d;p<c;p++){var g=this._dataList[p],v=this.dataIndexToCoordinate(p);this._visibleRangeDataList.push({dataIndex:p,x:v,data:{prev:null!==(t=this._dataList[p-1])&&void 0!==t?t:g,current:g,next:null!==(e=this._dataList[p+1])&&void 0!==e?e:g}}),s(g)&&(this._visibleRangeHighLowPrice[0].price<g.high&&(this._visibleRangeHighLowPrice[0].price=g.high,this._visibleRangeHighLowPrice[0].x=v),this._visibleRangeHighLowPrice[1].price>g.low&&(this._visibleRangeHighLowPrice[1].price=g.low,this._visibleRangeHighLowPrice[1].x=v))}0===h?this._dataLoadMore.forward&&this._processDataLoad("forward"):u===i&&this._dataLoadMore.backward&&this._processDataLoad("backward")},t.prototype._processDataLoad=function(t){var e,i,r,n,o=this;if(!this._loading&&s(this._dataLoader)&&s(this._symbol)&&s(this._period)){this._loading=!0;var a={type:t,symbol:this._symbol,period:this._period,timestamp:null,callback:function(e,i){var r,n;o._loading=!1,o._addData(e,t,i),"init"===t&&(null===(n=null===(r=o._dataLoader)||void 0===r?void 0:r.subscribeBar)||void 0===n||n.call(r,{symbol:o._symbol,period:o._period,callback:function(t){o._addData(t,"update")}}))}};switch(t){case"backward":a.timestamp=null!==(i=null===(e=this._dataList[this._dataList.length-1])||void 0===e?void 0:e.timestamp)&&void 0!==i?i:null;break;case"forward":a.timestamp=null!==(n=null===(r=this._dataList[0])||void 0===r?void 0:r.timestamp)&&void 0!==n?n:null}this._dataLoader.getBars(a)}},t.prototype._processDataUnsubscribe=function(){var t,e;s(this._dataLoader)&&s(this._symbol)&&s(this._period)&&(null===(e=(t=this._dataLoader).unsubscribeBar)||void 0===e||e.call(t,{symbol:this._symbol,period:this._period}))},t.prototype.resetData=function(){this._loading=!1,this._processDataLoad("init")},t.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}},t.prototype.setBarSpace=function(t,e){t<Ht||t>Xt||this._barSpace===t||(this._barSpace=t,this._calcOptimalBarSpace(),null==e||e(),this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}))},t.prototype.setTotalBarSpace=function(t){this._totalBarSpace!==t&&(this._totalBarSpace=t,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}))},t.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance="distance"===this._scrollLimitRole?Math.min(this._maxOffsetDistance.right,t):t,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,null!=e&&e&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0})),this},t.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},t.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},t.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},t.prototype.setLastBarRightSideDiffBarCount=function(t){this._lastBarRightSideDiffBarCount=t},t.prototype.setMaxOffsetLeftDistance=function(t){this._scrollLimitRole="distance",this._maxOffsetDistance.left=t},t.prototype.setMaxOffsetRightDistance=function(t){this._scrollLimitRole="distance",this._maxOffsetDistance.right=t},t.prototype.setLeftMinVisibleBarCount=function(t){this._scrollLimitRole="bar_count",this._minVisibleBarCount.left=t},t.prototype.setRightMinVisibleBarCount=function(t){this._scrollLimitRole="bar_count",this._minVisibleBarCount.right=t},t.prototype.getVisibleRange=function(){return this._visibleRange},t.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},t.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace,i=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-e,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0});var r=Math.round(i-this._lastBarRightSideDiffBarCount*this._barSpace);0!==r&&this.executeAction("onScroll",{distance:r})}},t.prototype.getDataByDataIndex=function(t){var e;return null!==(e=this._dataList[t])&&void 0!==e?e:null},t.prototype.coordinateToFloatIndex=function(t){var e=this._dataList.length,i=(this._totalBarSpace-t)/this._barSpace,r=e+this._lastBarRightSideDiffBarCount-i;return Math.round(1e6*r)/1e6},t.prototype.dataIndexToTimestamp=function(t){var e=this._dataList.length;if(0===e)return null;var i=this.getDataByDataIndex(t);if(s(i))return i.timestamp;if(s(this._period)){var r=e-1,n=null,o=0;if(t>r?(n=this._dataList[r].timestamp,o=t-r):t<0&&(n=this._dataList[0].timestamp,o=t),a(n)){var l=this._period,u=l.type,c=l.span;switch(u){case"second":return n+1e3*c*o;case"minute":return n+60*c*1e3*o;case"hour":return n+60*c*60*1e3*o;case"day":return n+24*c*60*60*1e3*o;case"week":return n+7*c*24*60*60*1e3*o;case"month":var h=(p=new Date(n)).getDate();p.setDate(1),p.setMonth(p.getMonth()+c*o);var d=new Date(p.getFullYear(),p.getMonth()+1,0).getDate();return p.setDate(Math.min(h,d)),p.getTime();case"year":var p;return(p=new Date(n)).setFullYear(p.getFullYear()+c*o),p.getTime()}}}return null},t.prototype.timestampToDataIndex=function(t){var e=this._dataList.length;if(0===e)return 0;if(s(this._period)){var i=null,r=0,n=e-1,o=this._dataList[n].timestamp;t>o&&(i=o,r=n);var l=this._dataList[0].timestamp;if(t<l&&(i=l,r=0),a(i)){var u=this._period,c=u.type,h=u.span;switch(c){case"second":return r+Math.floor((t-i)/(1e3*h));case"minute":return r+Math.floor((t-i)/(60*h*1e3));case"hour":return r+Math.floor((t-i)/(60*h*60*1e3));case"day":return r+Math.floor((t-i)/(24*h*60*60*1e3));case"week":return r+Math.floor((t-i)/(7*h*24*60*60*1e3));case"month":var d=new Date(i),p=new Date(t),g=d.getFullYear(),v=p.getFullYear(),f=d.getMonth(),m=p.getMonth();return r+Math.floor((12*(v-g)+(m-f))/h);case"year":g=new Date(i).getFullYear(),v=new Date(t).getFullYear();return r+Math.floor((v-g)/h)}}}return Y(this._dataList,"timestamp",t)},t.prototype.dataIndexToCoordinate=function(t){var e=this._dataList.length+this._lastBarRightSideDiffBarCount-t;return Math.floor(this._totalBarSpace-(e-.5)*this._barSpace+.5)},t.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},t.prototype.zoom=function(t,e){var i,r=this;if(this._zoomEnabled){var n=null!=e?e:null;a(null==n?void 0:n.x)||(n={x:null!==(i=this._crosshair.x)&&void 0!==i?i:this._totalBarSpace/2});var o=n.x,s=this.coordinateToFloatIndex(o),l=this._barSpace,u=this._barSpace+t*(this._barSpace/10);this.setBarSpace(u,(function(){r._lastBarRightSideDiffBarCount+=s-r.coordinateToFloatIndex(o)}));var c=this._barSpace/l;1!==c&&this.executeAction("onZoom",{scale:c})}},t.prototype.setZoomEnabled=function(t){this._zoomEnabled=t},t.prototype.isZoomEnabled=function(){return this._zoomEnabled},t.prototype.setScrollEnabled=function(t){this._scrollEnabled=t},t.prototype.isScrollEnabled=function(){return this._scrollEnabled},t.prototype.setCrosshair=function(t,e){var i,r=null!=e?e:{},n=r.notInvalidate,o=r.notExecuteAction,l=r.forceInvalidate,u=null!=t?t:{},c=0,h=0;h=a(u.x)?(c=this.coordinateToDataIndex(u.x))<0?0:c>this._dataList.length-1?this._dataList.length-1:c:c=this._dataList.length-1;var d=this._dataList[h],p=this.dataIndexToCoordinate(c),g=this._crosshair.x,v=this._crosshair.y,f=this._crosshair.paneId;this._crosshair=T(T({},u),{realX:p,kLineData:d,realDataIndex:c,dataIndex:h,timestamp:null!==(i=this.dataIndexToTimestamp(c))&&void 0!==i?i:void 0}),(g!==u.x||v!==u.y||f!==u.paneId||null!=l&&l)&&(!s(d)||null!=o&&o||this._chart.crosshairChange(this._crosshair),null!=n&&n||this._chart.updatePane(1))},t.prototype.getCrosshair=function(){return this._crosshair},t.prototype.executeAction=function(t,e){var i;null===(i=this._actions.get(t))||void 0===i||i.execute(e)},t.prototype.subscribeAction=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new j),null===(i=this._actions.get(t))||void 0===i||i.subscribe(e)},t.prototype.unsubscribeAction=function(t,e){var i=this._actions.get(t);s(i)&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},t.prototype.hasAction=function(t){var e=this._actions.get(t);return s(e)&&!e.isEmpty()},t.prototype._sortIndicators=function(t){var e;u(t)?null===(e=this._indicators.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._indicators.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},t.prototype._addIndicatorCalcTask=function(t,e){var i=this;this._taskScheduler.addTask({id:Z(t.id),handler:function(){var r;null===(r=t.onDataStateChange)||void 0===r||r.call(t,{state:"loading",type:e,indicator:t}),t.calcImp(i._dataList).then((function(r){var n;r&&(i._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:"init"!==e}),null===(n=t.onDataStateChange)||void 0===n||n.call(t,{state:"ready",type:e,indicator:t}))})).catch((function(){var i;null===(i=t.onDataStateChange)||void 0===i||i.call(t,{state:"error",type:e,indicator:t})}))}})},t.prototype.addIndicator=function(t,e,i){var r=t.name;if(this.getIndicatorsByFilter(t).length>0)return!1;var n=this.getIndicatorsByPaneId(e),o=new(yt(r));return this._synchronizeIndicatorSeriesPrecision(o),o.paneId=e,o.override(t),i||(this.removeIndicator({paneId:e}),n=[]),n.push(o),this._indicators.set(e,n),this._sortIndicators(e),this._addIndicatorCalcTask(o,"init"),!0},t.prototype.getIndicatorsByPaneId=function(t){var e;return null!==(e=this._indicators.get(t))&&void 0!==e?e:[]},t.prototype.getIndicatorsByFilter=function(t){var e=t.paneId,i=t.name,r=t.id,n=function(t){return s(r)?t.id===r:!s(i)||t.name===i},o=[];return s(e)?o=o.concat(this.getIndicatorsByPaneId(e).filter(n)):this._indicators.forEach((function(t){o=o.concat(t.filter(n))})),o},t.prototype.removeIndicator=function(t){var e=this,i=!1;return this.getIndicatorsByFilter(t).forEach((function(t){var r=e.getIndicatorsByPaneId(t.paneId),n=r.findIndex((function(e){return e.id===t.id}));n>-1&&(e._taskScheduler.removeTask(Z(t.id)),r.splice(n,1),i=!0),0===r.length&&e._indicators.delete(t.paneId)})),i},t.prototype.hasIndicators=function(t){return this._indicators.has(t)},t.prototype._synchronizeIndicatorSeriesPrecision=function(t){if(s(this._symbol)){var e=this._symbol,i=e.pricePrecision,r=void 0===i?2:i,n=e.volumePrecision,o=void 0===n?0:n,a=function(t){switch(t.series){case"price":t.setSeriesPrecision(r);break;case"volume":t.setSeriesPrecision(o)}};s(t)?a(t):this._indicators.forEach((function(t){t.forEach((function(t){a(t)}))}))}},t.prototype.overrideIndicator=function(t){var e=this,i=!1,r=!1;return this.getIndicatorsByFilter(t).forEach((function(n){n.override(t);var o=n.shouldUpdateImp(),a=o.calc,s=o.draw;o.sort&&(r=!0),a?e._addIndicatorCalcTask(n,"update"):s&&(i=!0)})),r&&this._sortIndicators(),!!i&&(this._chart.layout({update:!0}),!0)},t.prototype.getOverlaysByFilter=function(t){var e,i=t.id,r=t.groupId,n=t.paneId,o=t.name,a=function(t){return s(i)?t.id===i:s(r)?t.groupId===r&&(!s(o)||t.name===o):!s(o)||t.name===o},l=[];s(n)?l=l.concat(this.getOverlaysByPaneId(n).filter(a)):this._overlays.forEach((function(t){l=l.concat(t.filter(a))}));var u=null===(e=this._progressOverlayInfo)||void 0===e?void 0:e.overlay;return s(u)&&a(u)&&l.push(u),l},t.prototype.getOverlaysByPaneId=function(t){var e;if(!u(t)){var i=[];return this._overlays.forEach((function(t){i=i.concat(t)})),i}return null!==(e=this._overlays.get(t))&&void 0!==e?e:[]},t.prototype._sortOverlays=function(t){var e;u(t)?null===(e=this._overlays.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._overlays.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},t.prototype.addOverlays=function(t,e){var i=this,r=[],n=t.map((function(t,n){var o,a,l,u,c,h,d,p;if(s(t.id)){var g=null;try{for(var v=M(i._overlays),f=v.next();!f.done;f=v.next()){if(s(_=f.value[1].find((function(e){return e.id===t.id})))){g=_;break}}}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}if(s(g))return t.id}var m=Ot(t.name);if(s(m)){var y=null!==(l=t.id)&&void 0!==l?l:z("overlay_"),_=new m,x=null!==(u=t.paneId)&&void 0!==u?u:zt;t.id=y,null!==(c=t.groupId)&&void 0!==c||(t.groupId=y);var b=i.getOverlaysByPaneId(x).length;return null!==(h=t.zLevel)&&void 0!==h||(t.zLevel=b),_.override(t),r.includes(x)||r.push(x),_.isDrawing()?i._progressOverlayInfo={paneId:x,overlay:_,appointPaneFlag:e[n]}:(i._overlays.has(x)||i._overlays.set(x,[]),null===(d=i._overlays.get(x))||void 0===d||d.push(_)),_.isStart()&&(null===(p=_.onDrawStart)||void 0===p||p.call(_,{overlay:_,chart:i._chart})),y}return null}));return r.length>0&&(this._sortOverlays(),r.forEach((function(t){i._chart.updatePane(1,t)})),this._chart.updatePane(1,Yt)),n},t.prototype.getProgressOverlayInfo=function(){return this._progressOverlayInfo},t.prototype.progressOverlayComplete=function(){var t;if(null!==this._progressOverlayInfo){var e=this._progressOverlayInfo,i=e.overlay,r=e.paneId;i.isDrawing()||(this._overlays.has(r)||this._overlays.set(r,[]),null===(t=this._overlays.get(r))||void 0===t||t.push(i),this._sortOverlays(r),this._progressOverlayInfo=null)}},t.prototype.updateProgressOverlayInfo=function(t,e){null!==this._progressOverlayInfo&&(l(e)&&e&&(this._progressOverlayInfo.appointPaneFlag=e),this._progressOverlayInfo.paneId=t,this._progressOverlayInfo.overlay.override({paneId:t}))},t.prototype.overrideOverlay=function(t){var e=this,i=!1,r=[];return this.getOverlaysByFilter(t).forEach((function(e){e.override(t);var n=e.shouldUpdate(),o=n.sort,a=n.draw;o&&(i=!0),(o||a)&&(r.includes(e.paneId)||r.push(e.paneId))})),i&&this._sortOverlays(),r.length>0&&(r.forEach((function(t){e._chart.updatePane(1,t)})),this._chart.updatePane(1,Yt),!0)},t.prototype.removeOverlay=function(t){var e=this,i=[];return this.getOverlaysByFilter(t).forEach((function(t){var r,n=t.paneId,o=e.getOverlaysByPaneId(t.paneId);if(null===(r=t.onRemoved)||void 0===r||r.call(t,{overlay:t,chart:e._chart}),i.includes(n)||i.push(n),t.isDrawing())e._progressOverlayInfo=null;else{var a=o.findIndex((function(e){return e.id===t.id}));a>-1&&o.splice(a,1)}0===o.length&&e._overlays.delete(n)})),i.length>0&&(i.forEach((function(t){e._chart.updatePane(1,t)})),this._chart.updatePane(1,Yt),!0)},t.prototype.setPressedOverlayInfo=function(t){this._pressedOverlayInfo=t},t.prototype.getPressedOverlayInfo=function(){return this._pressedOverlayInfo},t.prototype.setHoverOverlayInfo=function(t,e,i){var r=this._hoverOverlayInfo,n=r.overlay,o=r.figureType,a=r.figureIndex,s=r.figure,l=t.overlay;if(((null==n?void 0:n.id)!==(null==l?void 0:l.id)||o!==t.figureType||a!==t.figureIndex)&&(this._hoverOverlayInfo=t,(null==n?void 0:n.id)!==(null==l?void 0:l.id))){var u=!1,c=!1;null!==n&&(n.override({zLevel:n.getPrevZLevel()}),c=!0,i(n,s)&&(u=!0)),null!==l&&(l.setPrevZLevel(l.zLevel),l.override({zLevel:Number.MAX_SAFE_INTEGER}),c=!0,e(l,t.figure)&&(u=!0)),c&&this._sortOverlays(),u||this._chart.updatePane(1)}},t.prototype.getHoverOverlayInfo=function(){return this._hoverOverlayInfo},t.prototype.setClickOverlayInfo=function(t,e,i){var r=this._clickOverlayInfo,n=r.paneId,o=r.overlay,a=r.figureType,l=r.figure,u=r.figureIndex,c=t.overlay;(null==o?void 0:o.id)===(null==c?void 0:c.id)&&a===t.figureType&&u===t.figureIndex||(this._clickOverlayInfo=t,(null==o?void 0:o.id)!==(null==c?void 0:c.id)&&(s(o)&&i(o,l),s(c)&&e(c,t.figure),this._chart.updatePane(1,t.paneId),n!==t.paneId&&this._chart.updatePane(1,n),this._chart.updatePane(1,Yt)))},t.prototype.getClickOverlayInfo=function(){return this._clickOverlayInfo},t.prototype.isOverlayEmpty=function(){return 0===this._overlays.size&&null===this._progressOverlayInfo},t.prototype.isOverlayDrawing=function(){var t,e;return null!==(e=null===(t=this._progressOverlayInfo)||void 0===t?void 0:t.overlay.isDrawing())&&void 0!==e&&e},t.prototype._clearLastPriceMarkExtendTextUpdateTimer=function(){this._lastPriceMarkExtendTextUpdateTimers.forEach((function(t){clearInterval(t)})),this._lastPriceMarkExtendTextUpdateTimers=[]},t.prototype._clearData=function(){this._dataLoadMore.backward=!1,this._dataLoadMore.forward=!1,this._loading=!1,this._dataList=[],this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._crosshair={}},t.prototype.getChart=function(){return this._chart},t.prototype.destroy=function(){this._clearData(),this._clearLastPriceMarkExtendTextUpdateTimer(),this._taskScheduler.removeTask(),this._overlays.clear(),this._indicators.clear(),this._actions.clear()},t}(),Ut="main",Zt="xAxis",qt="yAxis",jt="separator";var Qt=function(){function t(t,e){var i=this;this._supportedDevicePixelContentBox=!1,this._width=0,this._height=0,this._pixelWidth=0,this._pixelHeight=0,this._nextPixelWidth=0,this._nextPixelHeight=0,this._requestAnimationId=F,this._mediaQueryListener=function(){var t=x(i._element);i._nextPixelWidth=Math.round(i._element.clientWidth*t),i._nextPixelHeight=Math.round(i._element.clientHeight*t),i._resetPixelRatio()},this._listener=e,this._element=N("canvas",t),this._ctx=this._element.getContext("2d"),function(){return P(this,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){var e=new ResizeObserver((function(i){t(i.every((function(t){return"devicePixelContentBoxSize"in t}))),e.disconnect()}));e.observe(document.body,{box:"device-pixel-content-box"})})).catch((function(){return!1}))];case 1:return[2,t.sent()]}}))}))}().then((function(t){i._supportedDevicePixelContentBox=t,t?(i._resizeObserver=new ResizeObserver((function(t){var e=t.find((function(t){return t.target===i._element})),r=null==e?void 0:e.devicePixelContentBoxSize[0];s(r)&&(i._nextPixelWidth=r.inlineSize,i._nextPixelHeight=r.blockSize,i._pixelWidth===i._nextPixelWidth&&i._pixelHeight===i._nextPixelHeight||i._resetPixelRatio())})),i._resizeObserver.observe(i._element,{box:"device-pixel-content-box"})):(i._mediaQueryList=window.matchMedia("(resolution: ".concat(x(i._element),"dppx)")),i._mediaQueryList.addListener(i._mediaQueryListener))})).catch((function(t){return!1}))}return t.prototype._resetPixelRatio=function(){var t=this;this._executeListener((function(){var e=t._element.clientWidth,i=t._element.clientHeight;t._width=e,t._height=i,t._pixelWidth=t._nextPixelWidth,t._pixelHeight=t._nextPixelHeight,t._element.width=t._nextPixelWidth,t._element.height=t._nextPixelHeight;var r=t._nextPixelWidth/e,n=t._nextPixelHeight/i;t._ctx.scale(r,n)}))},t.prototype._executeListener=function(t){var e=this;this._requestAnimationId===F&&(this._requestAnimationId=B((function(){e._ctx.clearRect(0,0,e._width,e._height),null==t||t(),e._listener(),e._requestAnimationId=F})))},t.prototype.update=function(t,e){if(this._width!==t||this._height!==e){if(this._element.style.width="".concat(t,"px"),this._element.style.height="".concat(e,"px"),!this._supportedDevicePixelContentBox){var i=x(this._element);this._nextPixelWidth=Math.round(t*i),this._nextPixelHeight=Math.round(e*i),this._resetPixelRatio()}}else this._executeListener()},t.prototype.getElement=function(){return this._element},t.prototype.getContext=function(){return this._ctx},t.prototype.destroy=function(){s(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),s(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)},t}(),Kt=function(t){function i(e,i){var r=t.call(this)||this;return r._bounding=A(),r._cursor="crosshair",r._forceCursor=null,r._pane=i,r._rootContainer=e,r._container=r.createContainer(),e.appendChild(r._container),r}return E(i,t),i.prototype.setBounding=function(t){return e(this._bounding,t),this},i.prototype.getContainer=function(){return this._container},i.prototype.getBounding=function(){return this._bounding},i.prototype.getPane=function(){return this._pane},i.prototype.checkEventOn=function(t){return!0},i.prototype.setCursor=function(t){u(this._forceCursor)||t!==this._cursor&&(this._cursor=t,this._container.style.cursor=this._cursor)},i.prototype.setForceCursor=function(t){var e;t!==this._forceCursor&&(this._forceCursor=t,this._container.style.cursor=null!==(e=this._forceCursor)&&void 0!==e?e:this._cursor)},i.prototype.getForceCursor=function(){return this._forceCursor},i.prototype.update=function(t){this.updateImp(this._container,this._bounding,null!=t?t:3)},i.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},i}(Et),Jt=function(t){function e(e,i){var r=t.call(this,e,i)||this;r._mainCanvas=new Qt({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},(function(){r.updateMain(r._mainCanvas.getContext())})),r._overlayCanvas=new Qt({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},(function(){r.updateOverlay(r._overlayCanvas.getContext())}));var n=r.getContainer();return n.appendChild(r._mainCanvas.getElement()),n.appendChild(r._overlayCanvas.getElement()),r}return E(e,t),e.prototype.createContainer=function(){return N("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},e.prototype.updateImp=function(t,e,i){var r=e.width,n=e.height,o=e.left;t.style.left="".concat(o,"px");var a=i,s=t.clientWidth,l=t.clientHeight;switch(r===s&&n===l||(t.style.width="".concat(r,"px"),t.style.height="".concat(n,"px"),a=3),a){case 0:this._mainCanvas.update(r,n);break;case 1:this._overlayCanvas.update(r,n);break;case 3:case 4:this._mainCanvas.update(r,n),this._overlayCanvas.update(r,n)}},e.prototype.destroy=function(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,r=e.height,n=N("canvas",{width:"".concat(i,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),o=n.getContext("2d"),a=x(n);return n.width=i*a,n.height=r*a,o.scale(a,a),o.drawImage(this._mainCanvas.getElement(),0,0,i,r),t&&o.drawImage(this._overlayCanvas.getElement(),0,0,i,r),n},e}(Kt);function $t(t,e){var i,r,n=[];n=n.concat(e);try{for(var o=M(n),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.x,u=s.y,c=s.r,h=t.x-l,d=t.y-u;if(!(h*h+d*d>c*c))return!0}}catch(t){i={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return!1}var te={name:"circle",checkEventOn:$t,draw:function(t,e,i){!function(t,e,i){var r=[];r=r.concat(e);var n=i.style,o=void 0===n?"fill":n,a=i.color,s=void 0===a?"currentColor":a,l=i.borderSize,c=void 0===l?1:l,h=i.borderColor,d=void 0===h?"currentColor":h,p=i.borderStyle,g=void 0===p?"solid":p,v=i.borderDashedValue,f=void 0===v?[2,2]:v,m=!("fill"!==o&&"stroke_fill"!==i.style||u(s)&&Q(s));m&&(t.fillStyle=s,r.forEach((function(e){var i=e.x,r=e.y,n=e.r;t.beginPath(),t.arc(i,r,n,0,2*Math.PI),t.closePath(),t.fill()}))),("stroke"===o||"stroke_fill"===i.style)&&c>0&&!Q(d)&&(t.strokeStyle=d,t.lineWidth=c,"dashed"===g?t.setLineDash(f):t.setLineDash([]),r.forEach((function(e){var i=e.x,r=e.y,n=e.r;(!m||n>c)&&(t.beginPath(),t.arc(i,r,n,0,2*Math.PI),t.closePath(),t.stroke())})))}(t,e,i)}};function ee(t,e){var i,r,n=[];n=n.concat(e);try{for(var o=M(n),a=o.next();!a.done;a=o.next()){for(var s=a.value,l=!1,u=s.coordinates,c=0,h=u.length-1;c<u.length;h=c++)u[c].y>t.y!=u[h].y>t.y&&t.x<(u[h].x-u[c].x)*(t.y-u[c].y)/(u[h].y-u[c].y)+u[c].x&&(l=!l);if(l)return!0}}catch(t){i={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return!1}var ie={name:"polygon",checkEventOn:ee,draw:function(t,e,i){!function(t,e,i){var r=[];r=r.concat(e);var n=i.style,o=void 0===n?"fill":n,a=i.color,s=void 0===a?"currentColor":a,l=i.borderSize,c=void 0===l?1:l,h=i.borderColor,d=void 0===h?"currentColor":h,p=i.borderStyle,g=void 0===p?"solid":p,v=i.borderDashedValue,f=void 0===v?[2,2]:v;"fill"!==o&&"stroke_fill"!==i.style||u(s)&&Q(s)||(t.fillStyle=s,r.forEach((function(e){var i=e.coordinates;t.beginPath(),t.moveTo(i[0].x,i[0].y);for(var r=1;r<i.length;r++)t.lineTo(i[r].x,i[r].y);t.closePath(),t.fill()}))),("stroke"===o||"stroke_fill"===i.style)&&c>0&&!Q(d)&&(t.strokeStyle=d,t.lineWidth=c,"dashed"===g?t.setLineDash(f):t.setLineDash([]),r.forEach((function(e){var i=e.coordinates;t.beginPath(),t.moveTo(i[0].x,i[0].y);for(var r=1;r<i.length;r++)t.lineTo(i[r].x,i[r].y);t.closePath(),t.stroke()})))}(t,e,i)}};function re(t,e){var i,r,n=[];n=n.concat(e);try{for(var o=M(n),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.x,u=s.width;u<4&&(l-=2,u=4);var c=s.y,h=s.height;if(h<4&&(c-=2,h=4),t.x>=l&&t.x<=l+u&&t.y>=c&&t.y<=c+h)return!0}}catch(t){i={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return!1}function ne(t,e,i){var r,n=[];n=n.concat(e);var o=i.style,a=void 0===o?"fill":o,s=i.color,l=void 0===s?"transparent":s,c=i.borderSize,h=void 0===c?1:c,d=i.borderColor,p=void 0===d?"transparent":d,g=i.borderStyle,v=void 0===g?"solid":g,f=i.borderRadius,m=void 0===f?0:f,y=i.borderDashedValue,_=void 0===y?[2,2]:y,x=null!==(r=t.roundRect)&&void 0!==r?r:t.rect,b=!("fill"!==a&&"stroke_fill"!==i.style||u(l)&&Q(l));if(b&&(t.fillStyle=l,n.forEach((function(e){var i=e.x,r=e.y,n=e.width,o=e.height;t.beginPath(),x.call(t,i,r,n,o,m),t.closePath(),t.fill()}))),("stroke"===a||"stroke_fill"===i.style)&&h>0&&!Q(p)){t.strokeStyle=p,t.fillStyle=p,t.lineWidth=h,"dashed"===v?t.setLineDash(_):t.setLineDash([]);var w=h%2==1?.5:0,C=Math.round(2*w);n.forEach((function(e){var i=e.x,r=e.y,n=e.width,o=e.height;n>2*h&&o>2*h?(t.beginPath(),x.call(t,i+w,r+w,n-C,o-C,m),t.closePath(),t.stroke()):b||t.fillRect(i,r,n,o)}))}}var oe={name:"rect",checkEventOn:re,draw:function(t,e,i){ne(t,e,i)}};function ae(t,e){var i=e.size,r=void 0===i?12:i,n=e.paddingLeft,o=void 0===n?0:n,a=e.paddingTop,s=void 0===a?0:a,l=e.paddingRight,u=void 0===l?0:l,c=e.paddingBottom,h=void 0===c?0:c,d=e.weight,p=void 0===d?"normal":d,g=e.family,v=t.x,f=t.y,m=t.text,y=t.align,_=void 0===y?"left":y,x=t.baseline,b=void 0===x?"top":x,C=t.width,E=t.height,T=null!=C?C:o+w(m,r,p,g)+u,S=null!=E?E:s+r+h,P=0;switch(_){case"left":case"start":P=v;break;case"right":case"end":P=v-T;break;default:P=v-T/2}var I=0;switch(b){case"top":case"hanging":I=f;break;case"bottom":case"ideographic":case"alphabetic":I=f-S;break;default:I=f-S/2}return{x:P,y:I,width:T,height:S}}function se(t,e,i){var r,n,o=[];o=o.concat(e);try{for(var a=M(o),s=a.next();!s.done;s=a.next()){var l=ae(s.value,i),u=l.x,c=l.y,h=l.width,d=l.height;if(t.x>=u&&t.x<=u+h&&t.y>=c&&t.y<=c+d)return!0}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!1}var le={name:"text",checkEventOn:se,draw:function(t,e,i){!function(t,e,i){var r=[];r=r.concat(e);var n=i.color,o=void 0===n?"currentColor":n,a=i.size,s=void 0===a?12:a,l=i.family,u=i.weight,c=i.paddingLeft,h=void 0===c?0:c,d=i.paddingTop,p=void 0===d?0:d,g=i.paddingRight,v=void 0===g?0:g,f=r.map((function(t){return ae(t,i)}));ne(t,f,T(T({},i),{color:i.backgroundColor})),t.textAlign="left",t.textBaseline="top",t.font=b(s,u,l),t.fillStyle=o,r.forEach((function(e,i){var r=f[i];t.fillText(e.text,r.x+h,r.y+p,r.width-h-v)}))}(t,e,i)}};function ue(t,e){var i,r,n,o,a,s,l=[];l=l.concat(e);try{for(var u=M(l),c=u.next();!c.done;c=u.next()){var h=c.value;if(Math.abs((o=h,a=void 0,s=void 0,a=(n=t).x-o.x,s=n.y-o.y,Math.sqrt(a*a+s*s)-h.r))<2){var d=h.r,p=h.startAngle,g=h.endAngle,v=d*Math.cos(p)+h.x,f=d*Math.sin(p)+h.y,m=d*Math.cos(g)+h.x,y=d*Math.sin(g)+h.y;if(t.x<=Math.max(v,m)+2&&t.x>=Math.min(v,m)-2&&t.y<=Math.max(f,y)+2&&t.y>=Math.min(f,y)-2)return!0}}}catch(t){i={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(i)throw i.error}}return!1}var ce={name:"arc",checkEventOn:ue,draw:function(t,e,i){!function(t,e,i){var r=[];r=r.concat(e);var n=i.style,o=void 0===n?"solid":n,a=i.size,s=void 0===a?1:a,l=i.color,u=void 0===l?"currentColor":l,c=i.dashedValue,h=void 0===c?[2,2]:c;t.lineWidth=s,t.strokeStyle=u,"dashed"===o?t.setLineDash(h):t.setLineDash([]),r.forEach((function(e){var i=e.x,r=e.y,n=e.r,o=e.startAngle,a=e.endAngle;t.beginPath(),t.arc(i,r,n,o,a),t.stroke(),t.closePath()}))}(t,e,i)}};function he(t,e,i,r,n,o,a){var s=k(r,7),l=s[0],u=s[1],c=s[2],h=s[3],d=s[4],p=s[5],g=s[6],v=function(t,e,i,r,n,o,a,s,l){for(var u=function(t,e,i,r,n,o,a,s,l){var u=n*Math.PI/180,c=(t-s)/2,h=(e-l)/2,d=Math.cos(u)*c+Math.sin(u)*h,p=-Math.sin(u)*c+Math.cos(u)*h,g=Math.pow(d,2)/Math.pow(i,2)+Math.pow(p,2)/Math.pow(r,2);g>1&&(i*=Math.sqrt(g),r*=Math.sqrt(g));var v=o===a?-1:1,f=Math.pow(i,2)*Math.pow(r,2)-Math.pow(i,2)*Math.pow(p,2)-Math.pow(r,2)*Math.pow(d,2),m=Math.pow(i,2)*Math.pow(p,2)+Math.pow(r,2)*Math.pow(d,2),y=v*Math.sqrt(Math.abs(f/m))*(i*p/r),_=v*Math.sqrt(Math.abs(f/m))*(-r*d/i),x=Math.cos(u)*y-Math.sin(u)*_+(t+s)/2,b=Math.sin(u)*y+Math.cos(u)*_+(e+l)/2,w=Math.atan2((p-_)/r,(d-y)/i),C=Math.atan2((-p-_)/r,(-d-y)/i)-w;C<0&&1===a?C+=2*Math.PI:C>0&&0===a&&(C-=2*Math.PI);return{cx:x,cy:b,startAngle:w,deltaAngle:C}}(t,e,i,r,n,o,a,s,l),c=u.cx,h=u.cy,d=u.startAngle,p=u.deltaAngle,g=[],v=Math.ceil(Math.abs(p)/(Math.PI/2)),f=0;f<v;f++){var m=de(c,h,i,r,n,d+f*p/v,d+(f+1)*p/v);g.push(m)}return g}(e,i,l,u,c,h,d,a?e+p:p+n,a?i+g:g+o);v.forEach((function(e){t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}))}function de(t,e,i,r,n,o,a){var s=Math.sin(a-o)*(Math.sqrt(4+3*Math.pow(Math.tan((a-o)/2),2))-1)/3,l=Math.cos(n),u=Math.sin(n),c=t+i*Math.cos(o)*l-r*Math.sin(o)*u,h=e+i*Math.cos(o)*u+r*Math.sin(o)*l,d=t+i*Math.cos(a)*l-r*Math.sin(a)*u,p=e+i*Math.cos(a)*u+r*Math.sin(a)*l;return[c+s*(-i*Math.sin(o)*l-r*Math.cos(o)*u),h+s*(-i*Math.sin(o)*u+r*Math.cos(o)*l),d-s*(-i*Math.sin(a)*l-r*Math.cos(a)*u),p-s*(-i*Math.sin(a)*u+r*Math.cos(a)*l),d,p]}var pe={name:"path",checkEventOn:re,draw:function(t,e,i){!function(t,e,i){var r=[];r=r.concat(e);var n=i.lineWidth,o=void 0===n?1:n,a=i.color,l=void 0===a?"currentColor":a;t.lineWidth=o,t.strokeStyle=l,t.setLineDash([]),r.forEach((function(e){var r=e.x,n=e.y,o=e.path.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/gi);if(s(o)){var a=r,l=n;t.beginPath(),o.forEach((function(e){var i=0,r=0,n=0,o=0,s=e[0],u=e.slice(1).trim().split(/[\s,]+/).map(Number);switch(s){case"M":i=u[0]+a,r=u[1]+l,t.moveTo(i,r),n=i,o=r;break;case"m":i+=u[0],r+=u[1],t.moveTo(i,r),n=i,o=r;break;case"L":i=u[0]+a,r=u[1]+l,t.lineTo(i,r);break;case"l":i+=u[0],r+=u[1],t.lineTo(i,r);break;case"H":i=u[0]+a,t.lineTo(i,r);break;case"h":i+=u[0],t.lineTo(i,r);break;case"V":r=u[0]+l,t.lineTo(i,r);break;case"v":r+=u[0],t.lineTo(i,r);break;case"C":t.bezierCurveTo(u[0]+a,u[1]+l,u[2]+a,u[3]+l,u[4]+a,u[5]+l),i=u[4]+a,r=u[5]+l;break;case"c":t.bezierCurveTo(i+u[0],r+u[1],i+u[2],r+u[3],i+u[4],r+u[5]),i+=u[4],r+=u[5];break;case"S":t.bezierCurveTo(i,r,u[0]+a,u[1]+l,u[2]+a,u[3]+l),i=u[2]+a,r=u[3]+l;break;case"s":t.bezierCurveTo(i,r,i+u[0],r+u[1],i+u[2],r+u[3]),i+=u[2],r+=u[3];break;case"Q":t.quadraticCurveTo(u[0]+a,u[1]+l,u[2]+a,u[3]+l),i=u[2]+a,r=u[3]+l;break;case"q":t.quadraticCurveTo(i+u[0],r+u[1],i+u[2],r+u[3]),i+=u[2],r+=u[3];break;case"T":t.quadraticCurveTo(i,r,u[0]+a,u[1]+l),i=u[0]+a,r=u[1]+l;break;case"t":t.quadraticCurveTo(i,r,i+u[0],r+u[1]),i+=u[0],r+=u[1];break;case"A":he(t,i,r,u,a,l,!1),i=u[5]+a,r=u[6]+l;break;case"a":he(t,i,r,u,a,l,!0),i+=u[5],r+=u[6];break;case"Z":case"z":t.closePath(),i=n,r=o}})),"fill"===i.style?t.fill():t.stroke()}}))}(t,e,i)}},ge={};[te,Dt,ie,oe,le,ce,pe].forEach((function(t){ge[t.name]=Tt.extend(t)}));var ve=function(t){function e(e){var i=t.call(this)||this;return i._widget=e,i}return E(e,t),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,e){var i,r,n=(i=t.name,null!==(r=ge[i])&&void 0!==r?r:null);if(null!==n){var o=new n(t);if(s(e)){for(var a in e)e.hasOwnProperty(a)&&o.registerEvent(a,e[a]);this.addChild(o)}return o}return null},e.prototype.draw=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.clear(),this.drawImp(t,e)},e.prototype.checkEventOn=function(t){return!0},e}(Et),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e,i,r=this.getWidget(),n=this.getWidget().getPane(),o=n.getChart(),a=r.getBounding(),s=o.getStyles().grid;if(s.show){t.save(),t.globalCompositeOperation="destination-over";var l=s.horizontal;if(l.show){var u=n.getAxisComponent().getTicks().map((function(t){return{coordinates:[{x:0,y:t.coord},{x:a.width,y:t.coord}]}}));null===(e=this.createFigure({name:"line",attrs:u,styles:l}))||void 0===e||e.draw(t)}var c=s.vertical;if(c.show){u=o.getXAxisPane().getAxisComponent().getTicks().map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:a.height}]}}));null===(i=this.createFigure({name:"line",attrs:u,styles:c}))||void 0===i||i.draw(t)}t.restore()}},e}(ve),me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.eachChildren=function(t){for(var e=this.getWidget().getPane().getChart().getChartStore(),i=e.getVisibleRangeDataList(),r=e.getBarSpace(),n=i.length,o=0;o<n;)t(i[o],r,o),++o},e}(ve),ye=function(t){function e(){var e=t.apply(this,D([],k(arguments),!1))||this;return e._boundCandleBarClickEvent=function(t){return function(){return e.getWidget().getPane().getChart().getChartStore().executeAction("onCandleBarClick",t),!1}},e}return E(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget().getPane(),r=i.getId()===zt,n=i.getChart().getChartStore(),o=this.getCandleBarOptions();if(null!==o){var a=o.type,l=o.styles,u=0,c=0;if("ohlc"===o.type){var h=n.getBarSpace().gapBar;(u=Math.min(Math.max(Math.round(.2*h),1),8))>2&&u%2==1&&u--,c=Math.floor(u/2)}var d=i.getAxisComponent();this.eachChildren((function(i,n){var o,h=i.x,p=i.data,g=p.current,v=p.prev;if(s(g)){var f=g.open,m=g.high,y=g.low,_=g.close,x="current_open"===l.compareRule?f:null!==(o=null==v?void 0:v.close)&&void 0!==o?o:_,b=[];_>x?(b[0]=l.upColor,b[1]=l.upBorderColor,b[2]=l.upWickColor):_<x?(b[0]=l.downColor,b[1]=l.downBorderColor,b[2]=l.downWickColor):(b[0]=l.noChangeColor,b[1]=l.noChangeBorderColor,b[2]=l.noChangeWickColor);var w=d.convertToPixel(f),C=d.convertToPixel(_),E=[w,C,d.convertToPixel(m),d.convertToPixel(y)];E.sort((function(t,e){return t-e}));var T=n.gapBar%2==0?1:0,S=[];switch(a){case"candle_solid":S=e._createSolidBar(h,E,n,b,T);break;case"candle_stroke":S=e._createStrokeBar(h,E,n,b,T);break;case"candle_up_stroke":S=_>f?e._createStrokeBar(h,E,n,b,T):e._createSolidBar(h,E,n,b,T);break;case"candle_down_stroke":S=f>_?e._createStrokeBar(h,E,n,b,T):e._createSolidBar(h,E,n,b,T);break;case"ohlc":S=[{name:"rect",attrs:[{x:h-c,y:E[0],width:u,height:E[3]-E[0]},{x:h-n.halfGapBar,y:w+u>E[3]?E[3]-u:w,width:n.halfGapBar-c,height:u},{x:h+c,y:C+u>E[3]?E[3]-u:C,width:n.halfGapBar-c,height:u}],styles:{color:b[0]}}]}S.forEach((function(n){var o,a=null;r&&(a={mouseClickEvent:e._boundCandleBarClickEvent(i)}),null===(o=e.createFigure(n,null!=a?a:void 0))||void 0===o||o.draw(t)}))}}))}},e.prototype.getCandleBarOptions=function(){var t=this.getWidget().getPane().getChart().getStyles().candle;return{type:t.type,styles:t.bar}},e.prototype._createSolidBar=function(t,e,i,r,n){return[{name:"rect",attrs:{x:t,y:e[0],width:1,height:e[3]-e[0]},styles:{color:r[2]}},{name:"rect",attrs:{x:t-i.halfGapBar,y:e[1],width:i.gapBar+n,height:Math.max(1,e[2]-e[1])},styles:{style:"stroke_fill",color:r[0],borderColor:r[1]}}]},e.prototype._createStrokeBar=function(t,e,i,r,n){return[{name:"rect",attrs:[{x:t,y:e[0],width:1,height:e[1]-e[0]},{x:t,y:e[2],width:1,height:e[3]-e[2]}],styles:{color:r[2]}},{name:"rect",attrs:{x:t-i.halfGapBar,y:e[1],width:i.gapBar+n,height:Math.max(1,e[2]-e[1])},styles:{style:"stroke",borderColor:r[1]}}]},e}(me),_e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.getCandleBarOptions=function(){var t,e,i=this.getWidget().getPane();if(!i.getAxisComponent().isInCandle()){var r=i.getChart().getChartStore(),n=r.getIndicatorsByPaneId(i.getId());try{for(var o=M(n),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.shouldOhlc&&s.visible){var l=s.styles,u=r.getStyles().indicator,c=d(l,"ohlc.compareRule",u.ohlc.compareRule),h=d(l,"ohlc.upColor",u.ohlc.upColor),p=d(l,"ohlc.downColor",u.ohlc.downColor),g=d(l,"ohlc.noChangeColor",u.ohlc.noChangeColor);return{type:"ohlc",styles:{compareRule:c,upColor:h,downColor:p,noChangeColor:g,upBorderColor:h,downBorderColor:p,noChangeBorderColor:g,upWickColor:h,downWickColor:p,noChangeWickColor:g}}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}return null},e.prototype.drawImp=function(e){var i=this;t.prototype.drawImp.call(this,e);var r=this.getWidget(),n=r.getPane(),o=n.getChart(),l=r.getBounding(),u=o.getXAxisPane().getAxisComponent(),c=n.getAxisComponent(),h=o.getChartStore(),d=h.getIndicatorsByPaneId(n.getId()),p=h.getStyles().indicator;e.save(),d.forEach((function(t){if(t.visible){t.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";var r=!1;if(null!==t.draw&&(e.save(),r=t.draw({ctx:e,chart:o,indicator:t,bounding:l,xAxis:u,yAxis:c}),e.restore()),!r){var n=t.result,h=[];i.eachChildren((function(r,o){var d,g,v,f=o.halfGapBar,m=r.dataIndex,y=r.x,_=u.convertToPixel(m-1),x=u.convertToPixel(m+1),b=null!==(d=n[m-1])&&void 0!==d?d:null,w=null!==(g=n[m])&&void 0!==g?g:null,C=null!==(v=n[m+1])&&void 0!==v?v:null,E={x:_},T={x:y},S={x:x};t.figures.forEach((function(t){var e=t.key,i=null==b?void 0:b[e];a(i)&&(E[e]=c.convertToPixel(i));var r=null==w?void 0:w[e];a(r)&&(T[e]=c.convertToPixel(r));var n=null==C?void 0:C[e];a(n)&&(S[e]=c.convertToPixel(n))})),tt(t,m,p,(function(t,r,n){var d,p,g;if(s(null==w?void 0:w[t.key])){var v=T[t.key],m=null===(d=t.attrs)||void 0===d?void 0:d.call(t,{data:{prev:b,current:w,next:C},coordinate:{prev:E,current:T,next:S},bounding:l,barSpace:o,xAxis:u,yAxis:c});if(!s(m))switch(t.type){case"circle":m={x:y,y:v,r:Math.max(1,f)};break;case"rect":case"bar":var _=null!==(p=t.baseValue)&&void 0!==p?p:c.getRange().from,x=c.convertToPixel(_),P=Math.abs(x-v);_!==(null==w?void 0:w[t.key])&&(P=Math.max(1,P));m={x:y-f,y:v>x?x:v,width:Math.max(1,2*f),height:P};break;case"line":s(h[n])||(h[n]=[]),a(T[t.key])&&a(S[t.key])&&h[n].push({coordinates:[{x:T.x,y:T[t.key]},{x:S.x,y:S[t.key]}],styles:r})}var I=t.type;s(m)&&"line"!==I&&(null===(g=i.createFigure({name:"bar"===I?"rect":I,attrs:m,styles:r}))||void 0===g||g.draw(e))}}))})),h.forEach((function(t){var r,n,o,a;if(t.length>1){for(var s=[{coordinates:[t[0].coordinates[0],t[0].coordinates[1]],styles:t[0].styles}],l=1;l<t.length;l++){var u=s[s.length-1],c=t[l],h=u.coordinates[u.coordinates.length-1];h.x===c.coordinates[0].x&&h.y===c.coordinates[0].y&&u.styles.style===c.styles.style&&u.styles.color===c.styles.color&&u.styles.size===c.styles.size&&u.styles.smooth===c.styles.smooth&&(null===(r=u.styles.dashedValue)||void 0===r?void 0:r[0])===(null===(n=c.styles.dashedValue)||void 0===n?void 0:n[0])&&(null===(o=u.styles.dashedValue)||void 0===o?void 0:o[1])===(null===(a=c.styles.dashedValue)||void 0===a?void 0:a[1])?u.coordinates.push(c.coordinates[1]):s.push({coordinates:[c.coordinates[0],c.coordinates[1]],styles:c.styles})}s.forEach((function(t){var r,n=t.coordinates,o=t.styles;null===(r=i.createFigure({name:"line",attrs:{coordinates:n},styles:o}))||void 0===r||r.draw(e)}))}}))}}})),e.restore()},e}(ye),xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),r=e.getBounding(),n=e.getPane().getChart().getChartStore(),o=n.getCrosshair(),a=n.getStyles().crosshair;if(u(o.paneId)&&a.show){if(o.paneId===i.getId()){var s=o.y;this._drawLine(t,[{x:0,y:s},{x:r.width,y:s}],a.horizontal)}var l=o.realX;this._drawLine(t,[{x:l,y:0},{x:l,y:r.height}],a.vertical)}},e.prototype._drawLine=function(t,e,i){var r;if(i.show){var n=i.line;n.show&&(null===(r=this.createFigure({name:"line",attrs:{coordinates:e},styles:n}))||void 0===r||r.draw(t))}},e}(ve),be=function(t){function e(e){var i=t.call(this,e)||this;return i._activeFeatureInfo=null,i._featureClickEvent=function(t,e){return function(){return i.getWidget().getPane().getChart().getChartStore().executeAction(t,e),!0}},i._featureMouseMoveEvent=function(t){return function(){return i._activeFeatureInfo=t,!0}},i.registerEvent("mouseMoveEvent",(function(t){return i._activeFeatureInfo=null,!1})),i}return E(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane().getChart().getChartStore();if(s(i.getCrosshair().kLineData)){var r=e.getBounding(),n=i.getStyles().indicator.tooltip,o=n.offsetLeft,a=n.offsetTop,l=n.offsetRight;this.drawIndicatorTooltip(t,o,a,r.width-l)}},e.prototype.drawIndicatorTooltip=function(t,e,i,r){var n=this,o=this.getWidget().getPane(),a=o.getChart().getChartStore(),s=a.getStyles().indicator.tooltip;if(this.isDrawTooltip(a.getCrosshair(),s)){var l=a.getIndicatorsByPaneId(o.getId()),u=s.title,c=s.legend;l.forEach((function(o){var a=0,s={x:e,y:i},l=n.getIndicatorTooltipData(o),h=l.name,d=l.calcParamsText,p=l.legends,g=l.features,v=h.length>0,f=p.length>0;if(v||f){var m=n.classifyTooltipFeatures(g);if(a=n.drawStandardTooltipFeatures(t,m[0],s,o,e,a,r),v){var y=h;d.length>0&&(y="".concat(y).concat(d));var _=u.color;a=n.drawStandardTooltipLegends(t,[{title:{text:"",color:_},value:{text:y,color:_}}],s,e,a,r,u)}a=n.drawStandardTooltipFeatures(t,m[1],s,o,e,a,r),f&&(a=n.drawStandardTooltipLegends(t,p,s,e,a,r,c)),a=n.drawStandardTooltipFeatures(t,m[2],s,o,e,a,r),i=s.y+a}}))}return i},e.prototype.drawStandardTooltipFeatures=function(t,e,i,r,n,o,a){var l=this;if(e.length>0){var u=0,c=0;e.forEach((function(e){var i=e.marginLeft,r=void 0===i?0:i,n=e.marginTop,o=void 0===n?0:n,a=e.marginRight,s=void 0===a?0:a,l=e.marginBottom,h=void 0===l?0:l,d=e.paddingLeft,p=void 0===d?0:d,g=e.paddingTop,v=void 0===g?0:g,f=e.paddingRight,m=void 0===f?0:f,y=e.paddingBottom,_=void 0===y?0:y,x=e.size,w=void 0===x?0:x,C=e.type,E=e.content,T=0;if("icon_font"===C){var S=E;t.font=b(w,"normal",S.family),T=t.measureText(S.code).width}else T=w;u+=r+p+T+m+s,c=Math.max(c,o+v+w+_+h)})),i.x+u>a?(i.x=n,i.y+=o,o=c):o=Math.max(o,c);var h=this.getWidget().getPane().getId();e.forEach((function(e){var n,o,a,u,c,d=e.marginLeft,p=void 0===d?0:d,g=e.marginTop,v=void 0===g?0:g,f=e.marginRight,m=void 0===f?0:f,y=e.paddingLeft,_=void 0===y?0:y,x=e.paddingTop,b=void 0===x?0:x,w=e.paddingRight,C=void 0===w?0:w,E=e.paddingBottom,T=void 0===E?0:E,S=e.backgroundColor,P=e.activeBackgroundColor,I=e.borderRadius,M=e.size,k=void 0===M?0:M,D=e.color,A=e.activeColor,F=e.type,B=e.content,R=D,L=S;(null===(n=l._activeFeatureInfo)||void 0===n?void 0:n.paneId)===h&&(null===(o=l._activeFeatureInfo.indicator)||void 0===o?void 0:o.id)===(null==r?void 0:r.id)&&l._activeFeatureInfo.feature.id===e.id&&(R=null!=A?A:D,L=null!=P?P:S);var O="onCandleTooltipFeatureClick",W={paneId:h,feature:e};s(r)&&(O="onIndicatorTooltipFeatureClick",W.indicator=r);var V={mouseClickEvent:l._featureClickEvent(O,W),mouseMoveEvent:l._featureMouseMoveEvent(W)},z=0;if("icon_font"===F){var N=B;null===(a=l.createFigure({name:"text",attrs:{text:N.code,x:i.x+p,y:i.y+v},styles:{paddingLeft:_,paddingTop:b,paddingRight:C,paddingBottom:T,borderRadius:I,size:k,family:N.family,color:R,backgroundColor:L}},V))||void 0===a||a.draw(t),z=t.measureText(N.code).width}else{null===(u=l.createFigure({name:"rect",attrs:{x:i.x+p,y:i.y+v,width:k,height:k},styles:{paddingLeft:_,paddingTop:b,paddingRight:C,paddingBottom:T,color:L}},V))||void 0===u||u.draw(t);var Y=B;null===(c=l.createFigure({name:"path",attrs:{path:Y.path,x:i.x+p+_,y:i.y+v+b,width:k,height:k},styles:{style:Y.style,lineWidth:Y.lineWidth,color:R}}))||void 0===c||c.draw(t),z=k}i.x+=p+_+z+C+m}))}return o},e.prototype.drawStandardTooltipLegends=function(t,e,i,r,n,o,a){var s=this;if(e.length>0){var l=a.marginLeft,u=a.marginTop,c=a.marginRight,h=a.marginBottom,d=a.size,p=a.family,g=a.weight;t.font=b(d,g,p),e.forEach((function(e){var a,v,f=e.title,m=e.value,y=t.measureText(f.text).width,_=y+t.measureText(m.text).width,x=u+d+h;i.x+l+_+c>o?(i.x=r,i.y+=n,n=x):n=Math.max(n,x),f.text.length>0&&(null===(a=s.createFigure({name:"text",attrs:{x:i.x+l,y:i.y+u,text:f.text},styles:{color:f.color,size:d,family:p,weight:g}}))||void 0===a||a.draw(t)),null===(v=s.createFigure({name:"text",attrs:{x:i.x+l+y,y:i.y+u,text:m.text},styles:{color:m.color,size:d,family:p,weight:g}}))||void 0===v||v.draw(t),i.x+=l+_+c}))}return n},e.prototype.isDrawTooltip=function(t,e){var i=e.showRule;return"always"===i||"follow_cross"===i&&u(t.paneId)},e.prototype.getIndicatorTooltipData=function(t){var e,i,r=this.getWidget().getPane().getChart().getChartStore(),l=r.getStyles().indicator,c=l.tooltip,h=c.title,d="",p="";if(h.show&&(h.showName&&(d=t.shortName),h.showParams)){var v=t.calcParams;v.length>0&&(p="(".concat(v.join(","),")"))}var f={name:d,calcParamsText:p,legends:[],features:c.features},m=r.getCrosshair().dataIndex,y=t.result,_=r.getInnerFormatter(),x=r.getDecimalFold(),b=r.getThousandsSeparator(),w=[];if(t.visible){var C=null!==(i=null!==(e=y[m])&&void 0!==e?e:y[m-1])&&void 0!==i?i:{},E=c.legend.defaultValue;tt(t,m,l,(function(e,i){if(u(e.title)){var r=i.color,n=C[e.key];a(n)&&(n=g(n,t.precision),t.shouldFormatBigNumber&&(n=_.formatBigNumber(n)),n=x.format(b.format(n))),w.push({title:{text:e.title,color:r},value:{text:null!=n?n:E,color:r}})}})),f.legends=w}if(n(t.createTooltipDataSource)){var T=this.getWidget(),S=T.getPane(),P=S.getChart(),I=t.createTooltipDataSource({chart:P,indicator:t,crosshair:r.getCrosshair(),bounding:T.getBounding(),xAxis:S.getChart().getXAxisPane().getAxisComponent(),yAxis:S.getAxisComponent()}),M=I.name,k=I.calcParamsText,D=I.legends,A=I.features;if(h.show&&(u(M)&&h.showName&&(f.name=M),u(k)&&h.showParams&&(f.calcParamsText=k)),s(A)&&(f.features=A),s(D)&&t.visible){var F=[],B=l.tooltip.legend.color;D.forEach((function(t){var e={text:"",color:B};o(t.title)?e=t.title:e.text=t.title;var i={text:"",color:B};o(t.value)?i=t.value:i.text=t.value,a(Number(i.text))&&(i.text=x.format(b.format(i.text))),F.push({title:e,value:i})})),f.legends=F}}return f},e.prototype.classifyTooltipFeatures=function(t){var e=[],i=[],r=[];return t.forEach((function(t){switch(t.position){case"left":e.push(t);break;case"middle":i.push(t);break;case"right":r.push(t)}})),[e,i,r]},e}(ve),we=function(t){function e(e){var i=t.call(this,e)||this;return i._initEvent(),i}return E(e,t),e.prototype._initEvent=function(){var t=this,e=this.getWidget(),i=e.getPane(),r=i.getId(),n=i.getChart(),o=n.getChartStore();this.registerEvent("mouseMoveEvent",(function(i){var a,s=o.getProgressOverlayInfo();if(null!==s){var l=s.overlay,u=s.paneId;l.isStart()&&(o.updateProgressOverlayInfo(r),u=r);var c=l.points.length-1;return l.isDrawing()&&u===r&&(l.eventMoveForDrawing(t._coordinateToPoint(l,i)),null===(a=l.onDrawing)||void 0===a||a.call(l,T({chart:n,overlay:l},i))),t._figureMouseMoveEvent(l,"point",c,{key:"".concat(xt,"point_").concat(c),type:"circle",attrs:{}})(i)}return o.setHoverOverlayInfo({paneId:r,overlay:null,figureType:"none",figureIndex:-1,figure:null},(function(e,r){return t._processOverlayMouseEnterEvent(e,r,i)}),(function(e,r){return t._processOverlayMouseLeaveEvent(e,r,i)})),e.setForceCursor(null),!1})).registerEvent("mouseClickEvent",(function(e){var i,a,s=o.getProgressOverlayInfo();if(null!==s){var l=s.overlay,u=s.paneId;l.isStart()&&(o.updateProgressOverlayInfo(r,!0),u=r);var c=l.points.length-1;return l.isDrawing()&&u===r&&(l.eventMoveForDrawing(t._coordinateToPoint(l,e)),null===(i=l.onDrawing)||void 0===i||i.call(l,T({chart:n,overlay:l},e)),l.nextStep(),l.isDrawing()||(o.progressOverlayComplete(),null===(a=l.onDrawEnd)||void 0===a||a.call(l,T({chart:n,overlay:l},e)))),t._figureMouseClickEvent(l,"point",c,{key:"".concat(xt,"point_").concat(c),type:"circle",attrs:{}})(e)}return o.setClickOverlayInfo({paneId:r,overlay:null,figureType:"none",figureIndex:-1,figure:null},(function(i,r){return t._processOverlaySelectedEvent(i,r,e)}),(function(i,r){return t._processOverlayDeselectedEvent(i,r,e)})),!1})).registerEvent("mouseDoubleClickEvent",(function(e){var i,a=o.getProgressOverlayInfo();if(null!==a){var s=a.overlay,l=a.paneId;s.isDrawing()&&l===r&&(s.forceComplete(),s.isDrawing()||(o.progressOverlayComplete(),null===(i=s.onDrawEnd)||void 0===i||i.call(s,T({chart:n,overlay:s},e))));var u=s.points.length-1;return t._figureMouseClickEvent(s,"point",u,{key:"".concat(xt,"point_").concat(u),type:"circle",attrs:{}})(e)}return!1})).registerEvent("mouseRightClickEvent",(function(e){var i=o.getProgressOverlayInfo();if(null!==i){var r=i.overlay;if(r.isDrawing()){var n=r.points.length-1;return t._figureMouseRightClickEvent(r,"point",n,{key:"".concat(xt,"point_").concat(n),type:"circle",attrs:{}})(e)}}return!1})).registerEvent("mouseUpEvent",(function(t){var e,i=o.getPressedOverlayInfo(),a=i.overlay,s=i.figure;return null!==a&&_t("onPressedMoveEnd",s)&&(null===(e=a.onPressedMoveEnd)||void 0===e||e.call(a,T({chart:n,overlay:a,figure:null!=s?s:void 0},t))),o.setPressedOverlayInfo({paneId:r,overlay:null,figureType:"none",figureIndex:-1,figure:null}),!1})).registerEvent("pressedMouseMoveEvent",(function(e){var i,r=o.getPressedOverlayInfo(),a=r.overlay,s=r.figureType,l=r.figureIndex,u=r.figure;if(null!==a&&_t("onPressedMoving",u)){if(!a.lock){var c=t._coordinateToPoint(a,e);"point"===s?a.eventPressedPointMove(c,l):a.eventPressedOtherMove(c,t.getWidget().getPane().getChart().getChartStore());var h=!1;null===(i=a.onPressedMoving)||void 0===i||i.call(a,T(T({chart:n,overlay:a,figure:null!=u?u:void 0},e),{preventDefault:function(){h=!0}})),h?t.getWidget().setForceCursor(null):t.getWidget().setForceCursor("pointer")}return!0}return t.getWidget().setForceCursor(null),!1}))},e.prototype._createFigureEvents=function(t,e,i,r){return t.isDrawing()?null:{mouseMoveEvent:this._figureMouseMoveEvent(t,e,i,r),mouseDownEvent:this._figureMouseDownEvent(t,e,i,r),mouseClickEvent:this._figureMouseClickEvent(t,e,i,r),mouseRightClickEvent:this._figureMouseRightClickEvent(t,e,i,r),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(t,e,i,r)}},e.prototype._processOverlayMouseEnterEvent=function(t,e,i){return!(!n(t.onMouseEnter)||!_t("onMouseEnter",e))&&(t.onMouseEnter(T({chart:this.getWidget().getPane().getChart(),overlay:t,figure:null!=e?e:void 0},i)),!0)},e.prototype._processOverlayMouseLeaveEvent=function(t,e,i){return!(!n(t.onMouseLeave)||!_t("onMouseLeave",e))&&(t.onMouseLeave(T({chart:this.getWidget().getPane().getChart(),overlay:t,figure:null!=e?e:void 0},i)),!0)},e.prototype._processOverlaySelectedEvent=function(t,e,i){var r;return!!_t("onSelected",e)&&(null===(r=t.onSelected)||void 0===r||r.call(t,T({chart:this.getWidget().getPane().getChart(),overlay:t,figure:null!=e?e:void 0},i)),!0)},e.prototype._processOverlayDeselectedEvent=function(t,e,i){var r;return!!_t("onDeselected",e)&&(null===(r=t.onDeselected)||void 0===r||r.call(t,T({chart:this.getWidget().getPane().getChart(),overlay:t,figure:null!=e?e:void 0},i)),!0)},e.prototype._figureMouseMoveEvent=function(t,e,i,r){var n=this;return function(o){var a,s=n.getWidget().getPane(),l=!t.isDrawing()&&_t("onMouseMove",r);if(l){var u=!1;null===(a=t.onMouseMove)||void 0===a||a.call(t,T(T({chart:s.getChart(),overlay:t,figure:r},o),{preventDefault:function(){u=!0}})),u?n.getWidget().setForceCursor(null):n.getWidget().setForceCursor("pointer")}return s.getChart().getChartStore().setHoverOverlayInfo({paneId:s.getId(),overlay:t,figureType:e,figure:r,figureIndex:i},(function(t,e){return n._processOverlayMouseEnterEvent(t,e,o)}),(function(t,e){return n._processOverlayMouseLeaveEvent(t,e,o)})),l}},e.prototype._figureMouseDownEvent=function(t,e,i,r){var n=this;return function(o){var a,s=n.getWidget().getPane(),l=s.getId();return t.startPressedMove(n._coordinateToPoint(t,o)),!!_t("onPressedMoveStart",r)&&(null===(a=t.onPressedMoveStart)||void 0===a||a.call(t,T({chart:s.getChart(),overlay:t,figure:r},o)),s.getChart().getChartStore().setPressedOverlayInfo({paneId:l,overlay:t,figureType:e,figureIndex:i,figure:r}),!t.isDrawing())}},e.prototype._figureMouseClickEvent=function(t,e,i,r){var n=this;return function(o){var a,s=n.getWidget().getPane(),l=s.getId(),u=!t.isDrawing()&&_t("onClick",r);return u&&(null===(a=t.onClick)||void 0===a||a.call(t,T({chart:n.getWidget().getPane().getChart(),overlay:t,figure:r},o))),s.getChart().getChartStore().setClickOverlayInfo({paneId:l,overlay:t,figureType:e,figureIndex:i,figure:r},(function(t,e){return n._processOverlaySelectedEvent(t,e,o)}),(function(t,e){return n._processOverlayDeselectedEvent(t,e,o)})),u}},e.prototype._figureMouseDoubleClickEvent=function(t,e,i,r){var n=this;return function(e){var i;return!!_t("onDoubleClick",r)&&(null===(i=t.onDoubleClick)||void 0===i||i.call(t,T(T({},e),{chart:n.getWidget().getPane().getChart(),figure:r,overlay:t})),!t.isDrawing())}},e.prototype._figureMouseRightClickEvent=function(t,e,i,r){var n=this;return function(e){var i;if(_t("onRightClick",r)){var o=!1;return null===(i=t.onRightClick)||void 0===i||i.call(t,T(T({chart:n.getWidget().getPane().getChart(),overlay:t,figure:r},e),{preventDefault:function(){o=!0}})),o||n.getWidget().getPane().getChart().getChartStore().removeOverlay(t),!t.isDrawing()}return!1}},e.prototype._coordinateToPoint=function(t,e){var i,r={},n=this.getWidget().getPane(),o=n.getChart(),s=n.getId(),l=o.getChartStore();if(this.coordinateToPointTimestampDataIndexFlag()){var u=o.getXAxisPane().getAxisComponent().convertFromPixel(e.x),c=null!==(i=l.dataIndexToTimestamp(u))&&void 0!==i?i:void 0;r.timestamp=c,r.dataIndex=u}if(this.coordinateToPointValueFlag()){var h=n.getAxisComponent(),d=h.convertFromPixel(e.y);if("normal"!==t.mode&&s===zt&&a(r.dataIndex)){var p=l.getDataByDataIndex(r.dataIndex);if(null!==p){var g=t.modeSensitivity;if(d>p.high)if("weak_magnet"===t.mode){var v=h.convertToPixel(p.high);d<h.convertFromPixel(v-g)&&(d=p.high)}else d=p.high;else if(d<p.low)if("weak_magnet"===t.mode){var f=h.convertToPixel(p.low);d>h.convertFromPixel(f-g)&&(d=p.low)}else d=p.low;else{var m=Math.max(p.open,p.close),y=Math.min(p.open,p.close);d=d>m?d-m<p.high-d?m:p.high:d<y?d-p.low<y-d?p.low:y:m-d<d-y?m:y}}}r.value=d}return r},e.prototype.coordinateToPointValueFlag=function(){return!0},e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.dispatchEvent=function(e,i){return this.getWidget().getPane().getChart().getChartStore().isOverlayDrawing()?this.onEvent(e,i):t.prototype.dispatchEvent.call(this,e,i)},e.prototype.drawImp=function(t){var e=this;this.getCompleteOverlays().forEach((function(i){i.visible&&e._drawOverlay(t,i)}));var i=this.getProgressOverlay();s(i)&&i.visible&&this._drawOverlay(t,i)},e.prototype._drawOverlay=function(t,e){var i=e.points,r=this.getWidget().getPane(),n=r.getChart(),o=n.getChartStore(),s=r.getAxisComponent(),l=n.getXAxisPane().getAxisComponent(),u=i.map((function(t){var e,i=null;a(t.timestamp)&&(i=o.timestampToDataIndex(t.timestamp));var r={x:0,y:0};return a(i)&&(r.x=l.convertToPixel(i)),a(t.value)&&(r.y=null!==(e=null==s?void 0:s.convertToPixel(t.value))&&void 0!==e?e:0),r}));if(u.length>0){var c=[].concat(this.getFigures(e,u));this.drawFigures(t,e,c)}this.drawDefaultFigures(t,e,u)},e.prototype.drawFigures=function(t,e,i){var r=this,n=this.getWidget().getPane().getChart().getStyles().overlay;i.forEach((function(i,o){var a=i.type,s=i.styles,l=i.attrs;[].concat(l).forEach((function(l){var u,c,h=r._createFigureEvents(e,"other",o,i),d=T(T(T({},n[a]),null===(u=e.styles)||void 0===u?void 0:u[a]),s);null===(c=r.createFigure({name:a,attrs:l,styles:d},null!=h?h:void 0))||void 0===c||c.draw(t)}))}))},e.prototype.getCompleteOverlays=function(){var t=this.getWidget().getPane();return t.getChart().getChartStore().getOverlaysByPaneId(t.getId())},e.prototype.getProgressOverlay=function(){var t=this.getWidget().getPane(),e=t.getChart().getChartStore().getProgressOverlayInfo();return s(e)&&e.paneId===t.getId()?e.overlay:null},e.prototype.getFigures=function(t,e){var i,r,n=this.getWidget(),o=n.getPane(),a=o.getChart(),s=o.getAxisComponent(),l=a.getXAxisPane().getAxisComponent(),u=n.getBounding();return null!==(r=null===(i=t.createPointFigures)||void 0===i?void 0:i.call(t,{chart:a,overlay:t,coordinates:e,bounding:u,xAxis:l,yAxis:s}))&&void 0!==r?r:[]},e.prototype.drawDefaultFigures=function(t,e,i){var r,n,o=this;if(e.needDefaultPointFigure){var a=this.getWidget().getPane().getChart().getChartStore(),s=a.getHoverOverlayInfo(),l=a.getClickOverlayInfo();if((null===(r=s.overlay)||void 0===r?void 0:r.id)===e.id&&"none"!==s.figureType||(null===(n=l.overlay)||void 0===n?void 0:n.id)===e.id&&"none"!==l.figureType){var u=a.getStyles().overlay,c=e.styles,h=T(T({},u.point),null==c?void 0:c.point);i.forEach((function(i,r){var n,a,l,u,c,d=i.x,p=i.y,g=h.radius,v=h.color,f=h.borderColor,m=h.borderSize;(null===(n=s.overlay)||void 0===n?void 0:n.id)===e.id&&"point"===s.figureType&&(null===(a=s.figure)||void 0===a?void 0:a.key)==="".concat(xt,"point_").concat(r)&&(g=h.activeRadius,v=h.activeColor,f=h.activeBorderColor,m=h.activeBorderSize),null===(u=o.createFigure({name:"circle",attrs:{x:d,y:p,r:g+m},styles:{color:f}},null!==(l=o._createFigureEvents(e,"point",r,{key:"".concat(xt,"point_").concat(r),type:"circle",attrs:{x:d,y:p,r:g+m},styles:{color:f}}))&&void 0!==l?l:void 0))||void 0===u||u.draw(t),null===(c=o.createFigure({name:"circle",attrs:{x:d,y:p,r:g},styles:{color:v}}))||void 0===c||c.draw(t)}))}}},e}(ve),Ce=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._gridView=new fe(r),r._indicatorView=new _e(r),r._crosshairLineView=new xe(r),r._tooltipView=r.createTooltipView(),r._overlayView=new we(r),r.addChild(r._tooltipView),r.addChild(r._overlayView),r}return E(e,t),e.prototype.getName=function(){return Ut},e.prototype.updateMain=function(t){"minimize"!==this.getPane().getOptions().state&&(this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t))},e.prototype.createTooltipView=function(){return new be(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlayContent=function(t){},e.prototype.updateOverlay=function(t){"minimize"!==this.getPane().getOptions().state&&(this._overlayView.draw(t),this._crosshairLineView.draw(t),this.updateOverlayContent(t)),this._tooltipView.draw(t)},e}(Jt),Ee=function(t){function e(){var e=t.apply(this,D([],k(arguments),!1))||this;return e._ripplePoint=e.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}),e._animationFrameTime=0,e._animation=new O({iterationCount:1/0}).doFrame((function(t){e._animationFrameTime=t;var i=e.getWidget().getPane();i.getChart().updatePane(0,i.getId())})),e}return E(e,t),e.prototype.drawImp=function(t){var e,i,n,o=this.getWidget(),l=o.getPane(),u=l.getChart(),c=u.getDataList().length-1,h=o.getBounding(),d=l.getAxisComponent(),p=u.getStyles().candle.area,g=[],v=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,m=null;if(this.eachChildren((function(t){var e=t.x,i=t.data.current,r=null==i?void 0:i[p.value];if(a(r)){var n=d.convertToPixel(r);f===Number.MIN_SAFE_INTEGER&&(f=e),g.push({x:e,y:n}),v=Math.min(v,n),t.dataIndex===c&&(m={x:e,y:n})}})),g.length>0){null===(e=this.createFigure({name:"line",attrs:{coordinates:g},styles:{color:p.lineColor,size:p.lineSize,smooth:p.smooth}}))||void 0===e||e.draw(t);var y=p.backgroundColor,_="";if(r(y)){var x=t.createLinearGradient(0,h.height,0,v);try{y.forEach((function(t){var e=t.offset,i=t.color;x.addColorStop(e,i)}))}catch(t){}_=x}else _=y;t.fillStyle=_,t.beginPath(),t.moveTo(f,h.height),t.lineTo(g[0].x,g[0].y),kt(t,g,p.smooth),t.lineTo(g[g.length-1].x,h.height),t.closePath(),t.fill()}var b=p.point;if(b.show&&s(m)){null===(i=this.createFigure({name:"circle",attrs:{x:m.x,y:m.y,r:b.radius},styles:{style:"fill",color:b.color}}))||void 0===i||i.draw(t);var w=b.rippleRadius;b.animation&&(w=b.radius+this._animationFrameTime/b.animationDuration*(b.rippleRadius-b.radius),this._animation.setDuration(b.animationDuration).start()),null===(n=this._ripplePoint)||void 0===n||n.setAttrs({x:m.x,y:m.y,r:w}).setStyles({style:"fill",color:b.rippleColor}).draw(t)}else this.stopAnimation()},e.prototype.stopAnimation=function(){this._animation.stop()},e}(me),Te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e,i,r=this.getWidget().getPane(),n=r.getChart().getChartStore(),o=n.getStyles().candle.priceMark,a=o.high,s=o.low;if(o.show&&(a.show||s.show)){var l=n.getVisibleRangeHighLowPrice(),u=null!==(i=null===(e=n.getSymbol())||void 0===e?void 0:e.pricePrecision)&&void 0!==i?i:2,c=r.getAxisComponent(),h=l[0],d=h.price,p=h.x,v=l[1],f=v.price,m=v.x,y=c.convertToPixel(d),_=c.convertToPixel(f),x=n.getDecimalFold(),b=n.getThousandsSeparator();a.show&&d!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,x.format(b.format(g(d,u))),{x:p,y:y},y<_?[-2,-5]:[2,5],a),s.show&&f!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,x.format(b.format(g(f,u))),{x:m,y:_},y<_?[2,5]:[-2,-5],s)}},e.prototype._drawMark=function(t,e,i,r,n){var o,a,s,l=i.x,u=i.y+r[0];null===(o=this.createFigure({name:"line",attrs:{coordinates:[{x:l-2,y:u+r[0]},{x:l,y:u},{x:l+2,y:u+r[0]}]},styles:{color:n.color}}))||void 0===o||o.draw(t);var c=0,h=0,d="left";l>this.getWidget().getBounding().width/2?(h=(c=l-5)-n.textOffset,d="right"):(d="left",h=(c=l+5)+n.textOffset);var p=u+r[1];null===(a=this.createFigure({name:"line",attrs:{coordinates:[{x:l,y:u},{x:l,y:p},{x:c,y:p}]},styles:{color:n.color}}))||void 0===a||a.draw(t),null===(s=this.createFigure({name:"text",attrs:{x:h,y:p,text:e,align:d,baseline:"middle"},styles:{color:n.color,size:n.textSize,family:n.textFamily,weight:n.textWeight}}))||void 0===s||s.draw(t)},e}(ve),Se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e,i,r,n=this.getWidget(),o=n.getPane(),a=n.getBounding(),l=o.getChart().getChartStore(),u=l.getStyles().candle.priceMark,c=u.last,h=c.line;if(u.show&&c.show&&h.show){var d=o.getAxisComponent(),p=l.getDataList(),g=p[p.length-1];if(s(g)){var v=g.close,f=g.open,m="current_open"===c.compareRule?f:null!==(i=null===(e=p[p.length-2])||void 0===e?void 0:e.close)&&void 0!==i?i:v,y=d.convertToNicePixel(v),_="";_=v>m?c.upColor:v<m?c.downColor:c.noChangeColor,null===(r=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:y},{x:a.width,y:y}]},styles:{style:h.style,color:_,size:h.size,dashedValue:h.dashedValue}}))||void 0===r||r.draw(t)}}},e}(ve),Pe={second:"HH:mm:ss",minute:"HH:mm",hour:"MM-DD HH:mm",day:"YYYY-MM-DD",week:"YYYY-MM-DD",month:"YYYY-MM",year:"YYYY"},Ie={second:"HH:mm:ss",minute:"YYYY-MM-DD HH:mm",hour:"YYYY-MM-DD HH:mm",day:"YYYY-MM-DD",week:"YYYY-MM-DD",month:"YYYY-MM",year:"YYYY"},Me={"zh-CN":{time:"æ—¶é—´ï¼š",open:"å¼€ï¼š",high:"é«˜ï¼š",low:"ä½Žï¼š",close:"æ”¶ï¼š",volume:"æˆäº¤é‡ï¼š",turnover:"æˆäº¤é¢ï¼š",change:"æ¶¨å¹…ï¼š",second:"ç§’",minute:"",hour:"å°æ—¶",day:"å¤©",week:"å‘¨",month:"æœˆ",year:"å¹´"},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: ",second:"S",minute:"",hour:"H",day:"D",week:"W",month:"M",year:"Y"}};function ke(t,e){var i;return null!==(i=Me[e][t])&&void 0!==i?i:t}var De=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane().getChart().getChartStore(),r=i.getCrosshair();if(s(r.kLineData)){var n=e.getBounding(),o=i.getStyles(),a=o.candle,l=o.indicator;if("rect"===a.tooltip.showType&&"rect"===l.tooltip.showType){var u=this.isDrawTooltip(r,a.tooltip),c=this.isDrawTooltip(r,l.tooltip);this._drawRectTooltip(t,u,c,a.tooltip.offsetTop)}else if("standard"===a.tooltip.showType&&"standard"===l.tooltip.showType){var h=a.tooltip,d=h.offsetLeft,p=h.offsetTop,g=h.offsetRight,v=n.width-g,f=this._drawCandleStandardTooltip(t,d,p,v);this.drawIndicatorTooltip(t,d,f,v)}else if("rect"===a.tooltip.showType&&"standard"===l.tooltip.showType){var m=a.tooltip,y=(d=m.offsetLeft,p=m.offsetTop,g=m.offsetRight,v=n.width-g,this.drawIndicatorTooltip(t,d,p,v));u=this.isDrawTooltip(r,a.tooltip);this._drawRectTooltip(t,u,!1,y)}else{var _=a.tooltip,x=(d=_.offsetLeft,p=_.offsetTop,g=_.offsetRight,v=n.width-g,this._drawCandleStandardTooltip(t,d,p,v));c=this.isDrawTooltip(r,l.tooltip);this._drawRectTooltip(t,!1,c,x)}}},e.prototype._drawCandleStandardTooltip=function(t,e,i,r){var n,o=this.getWidget().getPane().getChart().getChartStore(),a=o.getStyles().candle.tooltip,s=a.legend,l=0,u={x:e,y:i},c=o.getCrosshair();if(this.isDrawTooltip(c,a)){var h=a.title;if(h.show){var d=null!==(n=o.getPeriod())&&void 0!==n?n:{},p=d.type,g=void 0===p?"":p,v=d.span,f=void 0===v?"":v,m=y(h.template,T(T({},o.getSymbol()),{period:"".concat(f).concat(ke(g,o.getLocale()))})),_=h.color,x=this.drawStandardTooltipLegends(t,[{title:{text:"",color:_},value:{text:m,color:_}}],{x:e,y:i},e,0,r,h);u.y=u.y+x}var b=this._getCandleTooltipLegends(),w=this.classifyTooltipFeatures(a.features);l=this.drawStandardTooltipFeatures(t,w[0],u,null,e,l,r),l=this.drawStandardTooltipFeatures(t,w[1],u,null,e,l,r),b.length>0&&(l=this.drawStandardTooltipLegends(t,b,u,e,l,r,s)),l=this.drawStandardTooltipFeatures(t,w[2],u,null,e,l,r)}return u.y+l},e.prototype._drawRectTooltip=function(t,e,i,r){var n,o,a=this,s=this.getWidget(),l=s.getPane(),u=l.getChart().getChartStore(),c=u.getStyles(),h=c.candle,d=c.indicator,p=h.tooltip,g=d.tooltip;if(e||i){var v=this._getCandleTooltipLegends(),f=p.offsetLeft,m=p.offsetTop,y=p.offsetRight,_=p.offsetBottom,x=p.legend,w=x.marginLeft,C=x.marginRight,E=x.marginTop,T=x.marginBottom,S=x.size,P=x.weight,I=x.family,M=p.rect,k=M.position,D=M.paddingLeft,A=M.paddingRight,F=M.paddingTop,B=M.paddingBottom,R=M.offsetLeft,L=M.offsetRight,O=M.offsetTop,W=M.offsetBottom,V=M.borderSize,z=M.borderRadius,N=M.borderColor,Y=M.color,H=0,X=0,G=0;e&&(t.font=b(S,P,I),v.forEach((function(e){var i=e.title,r=e.value,n="".concat(i.text).concat(r.text),o=t.measureText(n).width+w+C;H=Math.max(H,o)})),G+=(T+E+S)*v.length);var U=g.legend,Z=U.marginLeft,q=U.marginRight,j=U.marginTop,Q=U.marginBottom,K=U.size,J=U.weight,$=U.family,tt=[];if(i){var et=u.getIndicatorsByPaneId(l.getId());t.font=b(K,J,$),et.forEach((function(e){var i=a.getIndicatorTooltipData(e).legends;tt.push(i),i.forEach((function(e){var i=e.title,r=e.value,n="".concat(i.text).concat(r.text),o=t.measureText(n).width+Z+q;H=Math.max(H,o),G+=j+Q+K}))}))}if(0!==(X+=H)&&0!==G){var it=u.getCrosshair(),rt=s.getBounding(),nt=l.getYAxisWidget().getBounding();X+=2*V+D+A,G+=2*V+F+B;var ot="pointer"===k&&it.paneId===zt,at=(null!==(n=it.realX)&&void 0!==n?n:0)>1e7,st=0;if(ot){var lt=it.realX;st=at?lt-L-X:lt+R}else{var ut=this.getWidget().getPane().getAxisComponent();at?(st=R+f,ut.inside&&"left"===ut.position&&(st+=nt.width)):(st=rt.width-L-X-y,ut.inside&&"right"===ut.position&&(st-=nt.width))}var ct=r+O;if(ot)(ct=it.y-G/2)+G>rt.height-W-_&&(ct=rt.height-W-G-_),ct<r+O&&(ct=r+O+m);null===(o=this.createFigure({name:"rect",attrs:{x:st,y:ct,width:X,height:G},styles:{style:"stroke_fill",color:Y,borderColor:N,borderSize:V,borderRadius:z}}))||void 0===o||o.draw(t);var ht=st+V+D+w,dt=ct+V+F;if(e&&v.forEach((function(e){var i,r;dt+=E;var n=e.title;null===(i=a.createFigure({name:"text",attrs:{x:ht,y:dt,text:n.text},styles:{color:n.color,size:S,family:I,weight:P}}))||void 0===i||i.draw(t);var o=e.value;null===(r=a.createFigure({name:"text",attrs:{x:st+X-V-C-A,y:dt,text:o.text,align:"right"},styles:{color:o.color,size:S,family:I,weight:P}}))||void 0===r||r.draw(t),dt+=S+T})),i){var pt=st+V+D+Z;tt.forEach((function(e){e.forEach((function(e){var i,r;dt+=j;var n=e.title,o=e.value;null===(i=a.createFigure({name:"text",attrs:{x:pt,y:dt,text:n.text},styles:{color:n.color,size:K,family:$,weight:J}}))||void 0===i||i.draw(t),null===(r=a.createFigure({name:"text",attrs:{x:st+X-V-q-A,y:dt,text:o.text,align:"right"},styles:{color:o.color,size:K,family:$,weight:J}}))||void 0===r||r.draw(t),dt+=K+Q}))}))}}}},e.prototype._getCandleTooltipLegends=function(){var t,e,i,r,a,l,u,c,h=this.getWidget().getPane().getChart().getChartStore(),d=h.getStyles().candle,p=h.getDataList(),v=h.getInnerFormatter(),f=h.getDecimalFold(),m=h.getThousandsSeparator(),_=h.getLocale(),x=null!==(t=h.getSymbol())&&void 0!==t?t:{},b=x.pricePrecision,w=void 0===b?2:b,C=x.volumePrecision,E=void 0===C?0:C,S=h.getPeriod(),P=null!==(e=h.getCrosshair().dataIndex)&&void 0!==e?e:0,I=d.tooltip.legend,M=I.color,k=I.defaultValue,D=I.template,A=null!==(i=p[P-1])&&void 0!==i?i:null,F=p[P],B=null!==(r=null==A?void 0:A.close)&&void 0!==r?r:F.close,R=F.close-B,L=T(T({},F),{time:v.formatDate(F.timestamp,Ie[null!==(a=null==S?void 0:S.type)&&void 0!==a?a:"day"],"tooltip"),open:f.format(m.format(g(F.open,w))),high:f.format(m.format(g(F.high,w))),low:f.format(m.format(g(F.low,w))),close:f.format(m.format(g(F.close,w))),volume:f.format(m.format(v.formatBigNumber(g(null!==(l=F.volume)&&void 0!==l?l:k,E)))),turnover:f.format(m.format(g(null!==(u=F.turnover)&&void 0!==u?u:k,w))),change:0===B?k:"".concat(m.format(g(R/B*100)),"%")});return(n(D)?D({prev:A,current:F,next:null!==(c=p[P+1])&&void 0!==c?c:null},d):D).map((function(t){var e=t.title,i=t.value,r={text:"",color:M};o(e)?r=T({},e):r.text=e,r.text=ke(r.text,_);var n={text:k,color:M};return o(i)?n=T({},i):n.text=i,s(/{change}/.exec(n.text))&&(n.color=0===R?d.priceMark.last.noChangeColor:R>0?d.priceMark.last.upColor:d.priceMark.last.downColor),n.text=y(n.text,L),{title:r,value:n}}))},e}(be),Ae=function(t){function e(e){var i=t.call(this,e)||this;return i._activeFeatureInfo=null,i._featureClickEvent=function(t){return function(){return i.getWidget().getPane().getChart().getChartStore().executeAction("onCrosshairFeatureClick",t),!0}},i._featureMouseMoveEvent=function(t){return function(){return i._activeFeatureInfo=t,i.getWidget().setForceCursor("pointer"),!0}},i.registerEvent("mouseMoveEvent",(function(t){return i._activeFeatureInfo=null,i.getWidget().setForceCursor(null),!1})),i}return E(e,t),e.prototype.drawImp=function(t){var e,i,r=this,n=this.getWidget(),o=n.getPane(),a=n.getPane().getChart().getChartStore(),s=a.getCrosshair(),l=this.getWidget(),c=l.getPane().getAxisComponent();if(u(s.paneId)&&s.paneId===o.getId()&&c.isInCandle()){var h=a.getStyles().crosshair,d=h.horizontal.features;if(h.show&&h.horizontal.show&&d.length>0){var p="right"===c.position,g=l.getBounding(),v=0,f=h.horizontal.text;if(c.inside&&f.show){var m=c.convertFromPixel(s.y),y=c.getRange(),_=c.displayValueToText(c.realValueToDisplayValue(c.valueToRealValue(m,{range:y}),{range:y}),null!==(i=null===(e=a.getSymbol())||void 0===e?void 0:e.pricePrecision)&&void 0!==i?i:2);_=a.getDecimalFold().format(a.getThousandsSeparator().format(_)),v=f.paddingLeft+w(_,f.size,f.weight,f.family)+f.paddingRight}var x=v;p&&(x=g.width-v);var b=s.y;d.forEach((function(e){var i,n,o,a,l=e.marginLeft,u=void 0===l?0:l,c=e.marginTop,h=void 0===c?0:c,d=e.marginRight,g=void 0===d?0:d,v=e.paddingLeft,f=void 0===v?0:v,m=e.paddingTop,y=void 0===m?0:m,_=e.paddingRight,C=void 0===_?0:_,E=e.paddingBottom,T=void 0===E?0:E,S=e.color,P=e.activeColor,I=e.backgroundColor,M=e.activeBackgroundColor,k=e.borderRadius,D=e.size,A=void 0===D?0:D,F=e.type,B=e.content,R=A;"icon_font"===F&&(R=f+w((V=B).code,A,"normal",V.family)+C);p?x-=R+g:x+=u;var L=S,O=I;(null===(i=r._activeFeatureInfo)||void 0===i?void 0:i.feature.id)===e.id&&(L=null!=P?P:S,O=null!=M?M:I);var W={mouseClickEvent:r._featureClickEvent({crosshair:s,feature:e}),mouseMoveEvent:r._featureMouseMoveEvent({crosshair:s,feature:e})};if("icon_font"===F){var V=B;null===(n=r.createFigure({name:"text",attrs:{text:V.code,x:x,y:b+h,baseline:"middle"},styles:{paddingLeft:f,paddingTop:y,paddingRight:C,paddingBottom:T,borderRadius:k,size:A,family:V.family,color:L,backgroundColor:O}},W))||void 0===n||n.draw(t)}else{null===(o=r.createFigure({name:"rect",attrs:{x:x,y:b+h-A/2,width:A,height:A},styles:{paddingLeft:f,paddingTop:y,paddingRight:C,paddingBottom:T,color:O}},W))||void 0===o||o.draw(t);var z=B;null===(a=r.createFigure({name:"path",attrs:{path:z.path,x:x,y:b+h+y-A/2,width:A,height:A},styles:{style:z.style,lineWidth:z.lineWidth,color:L}}))||void 0===a||a.draw(t)}p?x-=u:x+=R+g}))}}},e}(ve),Fe=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._candleBarView=new ye(r),r._candleAreaView=new Ee(r),r._candleHighLowPriceView=new Te(r),r._candleLastPriceLineView=new Se(r),r._crosshairFeatureView=new Ae(r),r.addChild(r._candleBarView),r.addChild(r._crosshairFeatureView),r}return E(e,t),e.prototype.updateMainContent=function(t){"area"!==this.getPane().getChart().getStyles().candle.type?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(t),this._candleLastPriceLineView.draw(t)},e.prototype.updateOverlayContent=function(t){this._crosshairFeatureView.draw(t)},e.prototype.createTooltipView=function(){return new De(this)},e}(Ce),Be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t,e){var i,r,n=this,o=this.getWidget(),a=o.getPane(),s=o.getBounding(),l=a.getAxisComponent(),u=this.getAxisStyles(a.getChart().getStyles());if(u.show&&(u.axisLine.show&&(null===(i=this.createFigure({name:"line",attrs:this.createAxisLine(s,u),styles:u.axisLine}))||void 0===i||i.draw(t)),!e[0])){var c=l.getTicks();if(u.tickLine.show)this.createTickLines(c,s,u).forEach((function(e){var i;null===(i=n.createFigure({name:"line",attrs:e,styles:u.tickLine}))||void 0===i||i.draw(t)}));if(u.tickText.show){var h=this.createTickTexts(c,s,u);null===(r=this.createFigure({name:"text",attrs:h,styles:u.tickText}))||void 0===r||r.draw(t)}}},e}(ve),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,e){var i=this.getWidget().getPane().getAxisComponent(),r=e.axisLine.size,n=0;return{coordinates:[{x:n=i.isFromZero()?0:t.width-r,y:0},{x:n,y:t.height}]}},e.prototype.createTickLines=function(t,e,i){var r=this.getWidget().getPane().getAxisComponent(),n=i.axisLine,o=i.tickLine,a=0,s=0;return r.isFromZero()?(a=0,n.show&&(a+=n.size),s=a+o.length):(a=e.width,n.show&&(a-=n.size),s=a-o.length),t.map((function(t){return{coordinates:[{x:a,y:t.coord},{x:s,y:t.coord}]}}))},e.prototype.createTickTexts=function(t,e,i){var r=this.getWidget().getPane().getAxisComponent(),n=i.axisLine,o=i.tickLine,a=i.tickText,s=0;r.isFromZero()?(s=a.marginStart,n.show&&(s+=n.size),o.show&&(s+=o.length)):(s=e.width-a.marginEnd,n.show&&(s-=n.size),o.show&&(s-=o.length));var l=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map((function(t){return{x:s,y:t.coord,text:t.text,align:l,baseline:"middle"}}))},e}(Be),Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e,i,r,n,o=this,a=this.getWidget(),l=a.getPane(),u=a.getBounding(),c=l.getChart().getChartStore(),h=c.getStyles().candle.priceMark,d=h.last,p=d.text;if(h.show&&d.show&&p.show){var g=null!==(i=null===(e=c.getSymbol())||void 0===e?void 0:e.pricePrecision)&&void 0!==i?i:2,v=l.getAxisComponent(),f=c.getDataList(),m=f[f.length-1];if(s(m)){var y=m.close,_=m.open,x="current_open"===d.compareRule?_:null!==(n=null===(r=f[f.length-2])||void 0===r?void 0:r.close)&&void 0!==n?n:y,b=v.convertToNicePixel(y),C="";C=y>x?d.upColor:y<x?d.downColor:d.noChangeColor;var E=0,S="left";v.isFromZero()?(E=0,S="left"):(E=u.width,S="right");var P=[],I=v.getRange(),M=v.displayValueToText(v.realValueToDisplayValue(v.valueToRealValue(y,{range:I}),{range:I}),g);M=c.getDecimalFold().format(c.getThousandsSeparator().format(M));var k=p.paddingLeft,D=p.paddingRight,A=p.paddingTop,F=p.paddingBottom,B=p.size,R=p.family,L=k+w(M,B,p.weight,R)+D,O=A+B+F;P.push({name:"text",attrs:{x:E,y:b,width:L,height:O,text:M,align:S,baseline:"middle"},styles:T(T({},p),{backgroundColor:C})});var W=c.getInnerFormatter().formatExtendText,V=B/2,z=b-V-A,N=b+V+F;d.extendTexts.forEach((function(t,e){var i=W({type:"last_price",data:m,index:e});if(i.length>0&&t.show){var r=t.size/2,n=0;"above_price"===t.position?(n=z-=t.paddingBottom+r,z-=r+t.paddingTop):(n=N+=t.paddingTop+r,N+=r+t.paddingBottom),L=Math.max(L,t.paddingLeft+w(i,t.size,t.weight,t.family)+t.paddingRight),P.push({name:"text",attrs:{x:E,y:n,width:L,height:t.paddingTop+t.size+t.paddingBottom,text:i,align:S,baseline:"middle"},styles:T(T({},t),{backgroundColor:C})})}})),P.forEach((function(e){var i;e.attrs.width=L,null===(i=o.createFigure(e))||void 0===i||i.draw(t)}))}}},e}(ve),Oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),r=i.getPane(),n=i.getBounding(),o=r.getChart().getChartStore(),l=o.getStyles().indicator,u=l.lastValueMark,c=u.text;if(u.show){var h=r.getAxisComponent(),d=h.getRange(),p=o.getDataList().length-1,g=o.getIndicatorsByPaneId(r.getId()),v=o.getInnerFormatter(),f=o.getDecimalFold(),m=o.getThousandsSeparator();g.forEach((function(i){var r,o,u=i.result,g=null!==(o=null!==(r=u[p])&&void 0!==r?r:u[p-1])&&void 0!==o?o:{};if(s(g)&&i.visible){var y=i.precision;tt(i,p,l,(function(r,o){var s,l=g[r.key];if(a(l)){var u=h.convertToNicePixel(l),p=h.displayValueToText(h.realValueToDisplayValue(h.valueToRealValue(l,{range:d}),{range:d}),y);i.shouldFormatBigNumber&&(p=v.formatBigNumber(p)),p=f.format(m.format(p));var _=0,x="left";h.isFromZero()?(_=0,x="left"):(_=n.width,x="right"),null===(s=e.createFigure({name:"text",attrs:{x:_,y:u,text:p,align:x,baseline:"middle"},styles:T(T({},c),{backgroundColor:o.color})}))||void 0===s||s.draw(t)}}))}}))}},e}(ve),We=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,e,i){this.drawFigures(t,e,this.getDefaultFigures(e,i))},e.prototype.getDefaultFigures=function(t,e){var i,r=this.getWidget(),n=r.getPane(),o=n.getChart().getChartStore(),s=o.getClickOverlayInfo(),l=[];if(t.needDefaultYAxisFigure&&t.id===(null===(i=s.overlay)||void 0===i?void 0:i.id)&&s.paneId===n.getId()){var u=n.getAxisComponent(),c=r.getBounding(),h=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,p=u.isFromZero(),v="left",f=0;p?(v="left",f=0):(v="right",f=c.width);var m=o.getDecimalFold(),y=o.getThousandsSeparator();e.forEach((function(e,i){var r,n,s=t.points[i];if(a(s.value)){h=Math.min(h,e.y),d=Math.max(d,e.y);var u=m.format(y.format(g(s.value,null!==(n=null===(r=o.getSymbol())||void 0===r?void 0:r.pricePrecision)&&void 0!==n?n:2)));l.push({type:"text",attrs:{x:f,y:e.y,text:u,align:v,baseline:"middle"},ignoreEvent:!0})}})),e.length>1&&l.unshift({type:"rect",attrs:{x:0,y:h,width:c.width,height:d-h},ignoreEvent:!0})}return l},e.prototype.getFigures=function(t,e){var i,r,n=this.getWidget(),o=n.getPane(),a=o.getChart(),s=o.getAxisComponent(),l=a.getXAxisPane().getAxisComponent(),u=n.getBounding();return null!==(r=null===(i=t.createYAxisFigures)||void 0===i?void 0:i.call(t,{chart:a,overlay:t,coordinates:e,bounding:u,xAxis:l,yAxis:s}))&&void 0!==r?r:[]},e}(we),Ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.drawImp=function(t){var e,i,r=this.getWidget(),n=r.getPane(),o=r.getPane().getChart().getChartStore(),a=o.getCrosshair();if(u(a.paneId)&&this.compare(a,n.getId())){var s=o.getStyles().crosshair;if(s.show){var l=this.getDirectionStyles(s),c=l.text;if(l.show&&c.show){var h=r.getBounding(),d=n.getAxisComponent(),p=this.getText(a,o,d);t.font=b(c.size,c.weight,c.family),null===(e=this.createFigure({name:"text",attrs:this.getTextAttrs(p,t.measureText(p).width,a,h,d,c),styles:c}))||void 0===e||e.draw(t);var g=d;if("function"==typeof g.isInCandle&&g.isInCandle()){var v=this.getPriceDifferenceText(a,o,d);if(v.length>0){var f=this.getTextAttrs(v,t.measureText(v).width,a,h,d,c);f.y+=1.5*c.size;var m=v.startsWith("+")?"#26A69A":"#EF5350";null===(i=this.createFigure({name:"text",attrs:f,styles:T(T({},c),{color:m,backgroundColor:v.startsWith("+")?"rgba(38, 166, 154, 1)":"rgba(239, 83, 80, 1)"})}))||void 0===i||i.draw(t)}}}}}},e.prototype.getPriceDifferenceText=function(t,e,i){var r=i.convertFromPixel(t.y),n=e.getDataList();if(0===n.length)return"";var o=n[n.length-1].close,a=r-o,s=a>0?"+":"",l=(a/o*100).toFixed(2),u="".concat(s).concat(l,"%");return u=e.getDecimalFold().format(e.getThousandsSeparator().format(u))},e.prototype.compare=function(t,e){return t.paneId===e},e.prototype.getDirectionStyles=function(t){return t.horizontal},e.prototype.getText=function(t,e,i){var r,n,o=i,a=i.convertFromPixel(t.y),s=0,l=!1;o.isInCandle()?s=null!==(n=null===(r=e.getSymbol())||void 0===r?void 0:r.pricePrecision)&&void 0!==n?n:2:e.getIndicatorsByPaneId(t.paneId).forEach((function(t){s=Math.max(t.precision,s),l||(l=t.shouldFormatBigNumber)}));var u=o.getRange(),c=o.displayValueToText(o.realValueToDisplayValue(o.valueToRealValue(a,{range:u}),{range:u}),s);return l&&(c=e.getInnerFormatter().formatBigNumber(c)),e.getDecimalFold().format(e.getThousandsSeparator().format(c))},e.prototype.getTextAttrs=function(t,e,i,r,n,o){var a=0,s="left";return n.isFromZero()?(a=0,s="left"):(a=r.width,s="right"),{x:a,y:i.y,text:t,align:s,baseline:"middle"}},e}(ve),ze=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._yAxisView=new Re(r),r._candleLastPriceLabelView=new Le(r),r._indicatorLastValueView=new Oe(r),r._overlayYAxisView=new We(r),r._crosshairHorizontalLabelView=new Ve(r),r.setCursor("ns-resize"),r.addChild(r._overlayYAxisView),r}return E(e,t),e.prototype.getName=function(){return qt},e.prototype.updateMain=function(t){var e="minimize"===this.getPane().getOptions().state;this._yAxisView.draw(t,e),e||(this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t))},e.prototype.updateOverlay=function(t){"minimize"!==this.getPane().getOptions().state&&(this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t))},e}(Jt);var Ne=function(){function t(t){this.scrollZoomEnabled=!0,this._range={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0},this._prevRange={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return t.prototype.getParent=function(){return this._parent},t.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._range=this.createRangeImp()),!(this._prevRange.from===this._range.from&&this._prevRange.to===this._range.to&&!t)&&(this._prevRange=this._range,this._ticks=this.createTicksImp(),!0)},t.prototype.getTicks=function(){return this._ticks},t.prototype.setRange=function(t){this._autoCalcTickFlag=!1,this._range=t},t.prototype.getRange=function(){return this._range},t.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},t.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},t}(),Ye=function(t){function i(e,i){var r=t.call(this,e)||this;return r.reverse=!1,r.inside=!1,r.position="right",r.gap={top:.2,bottom:.1},r.createRange=function(t){return t.defaultRange},r.minSpan=function(t){return U(-t)},r.valueToRealValue=function(t){return t},r.realValueToDisplayValue=function(t){return t},r.displayValueToRealValue=function(t){return t},r.realValueToValue=function(t){return t},r.displayValueToText=function(t,e){return g(t,e)},r.override(i),r}return E(i,t),i.prototype.override=function(t){var i=t.name,r=t.gap,n=S(t,["name","gap"]);u(this.name)||(this.name=i),e(this.gap,r),e(this,n)},i.prototype.createRangeImp=function(){var t,e,i=this.getParent(),r=i.getChart(),n=r.getChartStore(),o=i.getId(),l=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER,c=!1,h=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,p=Number.MAX_SAFE_INTEGER,g=n.getIndicatorsByPaneId(o);g.forEach((function(t){c||(c=t.shouldOhlc),p=Math.min(p,t.precision),a(t.minValue)&&(h=Math.min(h,t.minValue)),a(t.maxValue)&&(d=Math.max(d,t.maxValue))}));var v=4,f=this.isInCandle();if(f){var m=null!==(e=null===(t=n.getSymbol())||void 0===t?void 0:t.pricePrecision)&&void 0!==e?e:2;v=p!==Number.MAX_SAFE_INTEGER?Math.min(p,m):m}else p!==Number.MAX_SAFE_INTEGER&&(v=p);var y=n.getVisibleRangeDataList(),_=r.getStyles().candle,x="area"===_.type,b=_.area.value,w=f&&!x||!f&&c;y.forEach((function(t){var e=t.dataIndex,i=t.data.current;if(s(i)&&(w&&(l=Math.min(l,i.low),u=Math.max(u,i.high)),f&&x)){var r=i[b];a(r)&&(l=Math.min(l,r),u=Math.max(u,r))}g.forEach((function(t){var i,r=t.result,n=t.figures,o=null!==(i=r[e])&&void 0!==i?i:{};n.forEach((function(t){var e=o[t.key];a(e)&&(l=Math.min(l,e),u=Math.max(u,e))}))}))})),l!==Number.MAX_SAFE_INTEGER&&u!==Number.MIN_SAFE_INTEGER?(l=Math.min(h,l),u=Math.max(d,u)):(l=0,u=10);var C=u-l,E={from:l,to:u,range:C,realFrom:l,realTo:u,realRange:C,displayFrom:l,displayTo:u,displayRange:C},T=this.createRange({chart:r,paneId:o,defaultRange:E}),S=T.realFrom,P=T.realTo,I=T.realRange,M=this.minSpan(v);if(S===P||I<M){var k=h===S,D=d===P;S=k?S:D?S-8*M:S-4*M,P=D?P:k?P+8*M:P+4*M}var A=this.getBounding().height,F=this.gap,B=F.top;B>=1&&(B/=A);var R=F.bottom;R>=1&&(R/=A),S-=(I=P-S)*R,P+=I*B;var L=this.realValueToValue(S,{range:T}),O=this.realValueToValue(P,{range:T}),W=this.realValueToDisplayValue(S,{range:T}),V=this.realValueToDisplayValue(P,{range:T});return{from:L,to:O,range:O-L,realFrom:S,realTo:P,realRange:P-S,displayFrom:W,displayTo:V,displayRange:V-W}},i.prototype.isInCandle=function(){return this.getParent().getId()===zt},i.prototype.isFromZero=function(){return"left"===this.position&&this.inside||"right"===this.position&&!this.inside},i.prototype.createTicksImp=function(){var t,e,i,r,o=this,s=this.getRange(),l=s.displayFrom,u=s.displayTo,c=s.displayRange,h=[];if(c>=0){var d=function(t){var e=Math.floor(G(t)),i=U(e),r=t/i;return+(t=(r<1.5?1:r<2.5?2:r<3.5?3:r<4.5?4:r<5.5?5:r<6.5?6:8)*i).toFixed(Math.abs(e))}(c/8),p=function(t){var e=t.toString(),i=e.indexOf("e");if(i>0){var r=+e.slice(i+1);return r<0?-r:0}var n=e.indexOf(".");return n<0?0:e.length-1-n}(d),g=H(Math.ceil(l/d)*d,p),v=H(Math.floor(u/d)*d,p),f=0,m=g;if(0!==d)for(;m<=v;){var y=m.toFixed(p);h[f]={text:y,coord:0,value:y},++f,m+=d}}var _=this.getParent(),x=null!==(e=null===(t=_.getYAxisWidget())||void 0===t?void 0:t.getBounding().height)&&void 0!==e?e:0,b=_.getChart().getChartStore(),w=[],C=b.getIndicatorsByPaneId(_.getId()),E=b.getStyles(),T=0,S=!1;this.isInCandle()?T=null!==(r=null===(i=b.getSymbol())||void 0===i?void 0:i.pricePrecision)&&void 0!==r?r:2:C.forEach((function(t){T=Math.max(T,t.precision),S||(S=t.shouldFormatBigNumber)}));var P=b.getInnerFormatter(),I=b.getThousandsSeparator(),M=b.getDecimalFold(),k=E.xAxis.tickText.size,D=NaN;return h.forEach((function(t){var e=t.value,i=o.displayValueToText(+e,T),r=o.convertToPixel(o.realValueToValue(o.displayValueToRealValue(+e,{range:s}),{range:s}));S&&(i=P.formatBigNumber(e)),i=M.format(I.format(i));var n=a(D);r>k&&r<x-k&&(n&&Math.abs(D-r)>2*k||!n)&&(w.push({text:i,coord:r,value:e}),D=r)})),n(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:w}):w},i.prototype.getAutoSize=function(){var t,e,i=this.getParent(),r=i.getChart().getChartStore(),n=r.getStyles(),o=n.yAxis,a=o.size;if("auto"!==a)return a;var l=0;if(o.show&&(o.axisLine.show&&(l+=o.axisLine.size),o.tickLine.show&&(l+=o.tickLine.length),o.tickText.show)){var u=0;this.getTicks().forEach((function(t){u=Math.max(u,w(t.text,o.tickText.size,o.tickText.weight,o.tickText.family))})),l+=o.tickText.marginStart+o.tickText.marginEnd+u}var c=n.candle.priceMark,h=c.show&&c.last.show&&c.last.text.show,d=0,p=n.crosshair,v=p.show&&p.horizontal.show&&p.horizontal.text.show,f=0;if(h||v){var m=null!==(e=null===(t=r.getSymbol())||void 0===t?void 0:t.pricePrecision)&&void 0!==e?e:2,y=this.getRange().displayTo;if(h){var _=r.getDataList(),x=_[_.length-1];if(s(x)){var b=c.last.text,C=b.paddingLeft,E=b.paddingRight,T=b.size,S=b.family,P=b.weight;d=C+w(g(x.close,m),T,P,S)+E;var I=r.getInnerFormatter().formatExtendText;c.last.extendTexts.forEach((function(t,e){var i=I({type:"last_price",data:x,index:e});i.length>0&&t.show&&(d=Math.max(d,t.paddingLeft+w(i,t.size,t.weight,t.family)+t.paddingRight))}))}}if(v){var M=r.getIndicatorsByPaneId(i.getId()),k=0,D=!1;M.forEach((function(t){k=Math.max(t.precision,k),D||(D=t.shouldFormatBigNumber)}));var A=2;if(this.isInCandle()){var F=n.indicator.lastValueMark;A=F.show&&F.text.show?Math.max(k,m):m}else A=k;var B=g(y,A);D&&(B=r.getInnerFormatter().formatBigNumber(B)),B=r.getDecimalFold().format(B),f+=p.horizontal.text.paddingLeft+p.horizontal.text.paddingRight+2*p.horizontal.text.borderSize+w(B,p.horizontal.text.size,p.horizontal.text.weight,p.horizontal.text.family)}}return Math.max(l,d,f)},i.prototype.getBounding=function(){return this.getParent().getYAxisWidget().getBounding()},i.prototype.convertFromPixel=function(t){var e=this.getBounding().height,i=this.getRange(),r=i.realFrom,n=i.realRange,o=(this.reverse?t/e:1-t/e)*n+r;return this.realValueToValue(o,{range:i})},i.prototype.convertToPixel=function(t){var e,i,r=this.getRange(),n=this.valueToRealValue(t,{range:r}),o=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,a=(n-r.realFrom)/r.realRange;return this.reverse?Math.round(a*o):Math.round((1-a)*o)},i.prototype.convertToNicePixel=function(t){var e,i,r=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,n=this.convertToPixel(t);return Math.round(Math.max(.05*r,Math.min(n,.98*r)))},i.extend=function(t){var e=function(e){function i(i){return e.call(this,i,t)||this}return E(i,e),i}(i);return e},i}(Ne),He={name:"percentage",minSpan:function(){return Math.pow(10,-2)},displayValueToText:function(t){return"".concat(g(t,2),"%")},valueToRealValue:function(t,e){var i=e.range;return(t-i.from)/i.range*i.realRange+i.realFrom},realValueToValue:function(t,e){var i=e.range;return(t-i.realFrom)/i.realRange*i.range+i.from},createRange:function(t){var e=t.chart,i=t.defaultRange,r=e.getDataList()[e.getVisibleRange().from];if(s(r)){var n=i.from,o=i.to,a=i.range,l=(i.from-r.close)/r.close*100,u=(i.to-r.close)/r.close*100,c=u-l;return{from:n,to:o,range:a,realFrom:l,realTo:u,realRange:c,displayFrom:l,displayTo:u,displayRange:c}}return i}},Xe={name:"logarithm",minSpan:function(t){return.05*U(-t)},valueToRealValue:function(t){return t<0?-G(Math.abs(t)):G(t)},realValueToDisplayValue:function(t){return t<0?-U(Math.abs(t)):U(t)},displayValueToRealValue:function(t){return t<0?-G(Math.abs(t)):G(t)},realValueToValue:function(t){return t<0?-U(Math.abs(t)):U(t)},createRange:function(t){var e=t.defaultRange,i=e.from,r=e.to,n=e.range,o=i<0?-G(Math.abs(i)):G(i),a=r<0?-G(Math.abs(r)):G(r);return{from:i,to:r,range:n,realFrom:o,realTo:a,realRange:a-o,displayFrom:i,displayTo:r,displayRange:n}}},Ge={normal:Ye.extend({name:"normal"}),percentage:Ye.extend(He),logarithm:Ye.extend(Xe)};var Ue=function(){function t(t,e){this._bounding=A(),this._originalBounding=A(),this._visible=!0,this._chart=t,this._id=e,this._container=N("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"})}return t.prototype.getContainer=function(){return this._container},t.prototype.setVisible=function(t){this._visible!==t&&(this._container.style.display=t?"block":"none",this._visible=t)},t.prototype.getVisible=function(){return this._visible},t.prototype.getId=function(){return this._id},t.prototype.getChart=function(){return this._chart},t.prototype.getBounding=function(){return this._bounding},t.prototype.setOriginalBounding=function(t){e(this._originalBounding,t)},t.prototype.getOriginalBounding=function(){return this._originalBounding},t.prototype.update=function(t){this._bounding.height!==this._container.clientHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(null!=t?t:3,this._container,this._bounding)},t}(),Ze=function(t){function i(e,i,r){var n=t.call(this,e,i)||this;n._yAxisWidget=null,n._options={id:"",minHeight:30,dragEnabled:!0,order:0,height:100,state:"normal",axis:{name:"normal",scrollZoomEnabled:!0}};var o=n.getContainer();return n._mainWidget=n.createMainWidget(o),n._yAxisWidget=n.createYAxisWidget(o),n.setOptions(r),n}return E(i,t),i.prototype.setOptions=function(t){var i,r,n,o,a,l=this.getId();if(l===zt||l===Yt){var u=null===(i=t.axis)||void 0===i?void 0:i.name;(!s(this._axis)||s(u)&&this._options.axis.name!==u)&&(this._axis=this.createAxisComponent(null!=u?u:"normal"))}else s(this._axis)||(this._axis=this.createAxisComponent("normal"));this._axis instanceof Ye&&this._axis.setAutoCalcTickFlag(!0),e(this._options,t),this._axis.override(T(T({},this._options.axis),{name:null!==(n=null===(r=t.axis)||void 0===r?void 0:r.name)&&void 0!==n?n:"normal"}));var c=null,h="default";return this.getId()===Yt?(c=this.getMainWidget().getContainer(),h="ew-resize"):(c=this.getYAxisWidget().getContainer(),h="ns-resize"),null===(a=null===(o=t.axis)||void 0===o?void 0:o.scrollZoomEnabled)||void 0===a||a?c.style.cursor=h:c.style.cursor="default",this},i.prototype.getOptions=function(){return this._options},i.prototype.getAxisComponent=function(){return this._axis},i.prototype.setBounding=function(t,i,r,n){var o,a,l,u;e(this.getBounding(),t);var c={};s(t.height)&&(c.height=t.height),s(t.top)&&(c.top=t.top),this._mainWidget.setBounding(c);var h=s(i);(h&&this._mainWidget.setBounding(i),s(this._yAxisWidget))&&(this._yAxisWidget.setBounding(c),"left"===this._axis.position?s(r)&&this._yAxisWidget.setBounding(T(T({},r),{left:0})):s(n)&&(this._yAxisWidget.setBounding(n),h&&this._yAxisWidget.setBounding({left:(null!==(o=i.left)&&void 0!==o?o:0)+(null!==(a=i.width)&&void 0!==a?a:0)+(null!==(l=i.right)&&void 0!==l?l:0)-(null!==(u=n.width)&&void 0!==u?u:0)})));return this},i.prototype.getMainWidget=function(){return this._mainWidget},i.prototype.getYAxisWidget=function(){return this._yAxisWidget},i.prototype.updateImp=function(t){var e;this._mainWidget.update(t),null===(e=this._yAxisWidget)||void 0===e||e.update(t)},i.prototype.destroy=function(){var t;this._mainWidget.destroy(),null===(t=this._yAxisWidget)||void 0===t||t.destroy()},i.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,r=e.height,n=N("canvas",{width:"".concat(i,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),o=n.getContext("2d"),a=x(n);n.width=i*a,n.height=r*a,o.scale(a,a);var s=this._mainWidget.getBounding();if(o.drawImage(this._mainWidget.getImage(t),s.left,0,s.width,s.height),null!==this._yAxisWidget){var l=this._yAxisWidget.getBounding();o.drawImage(this._yAxisWidget.getImage(t),l.left,0,l.width,l.height)}return n},i.prototype.createYAxisWidget=function(t){return null},i}(Ue),qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.createAxisComponent=function(t){var e=function(t){var e;return null!==(e=Ge[t])&&void 0!==e?e:Ge.normal}(null!=t?t:"default");return new e(this)},e.prototype.createMainWidget=function(t){return new Ce(t,this)},e.prototype.createYAxisWidget=function(t){return new ze(t,this)},e}(Ze),je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.createMainWidget=function(t){return new Fe(t,this)},e}(qe),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t){return{coordinates:[{x:0,y:0},{x:t.width,y:0}]}},e.prototype.createTickLines=function(t,e,i){var r=i.tickLine,n=i.axisLine.size;return t.map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:n+r.length}]}}))},e.prototype.createTickTexts=function(t,e,i){var r=i.tickText,n=i.axisLine.size,o=i.tickLine.length;return t.map((function(t){return{x:t.coord,y:n+o+r.marginStart,text:t.text,align:"center",baseline:"top"}}))},e}(Be),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.coordinateToPointValueFlag=function(){return!1},e.prototype.getCompleteOverlays=function(){return this.getWidget().getPane().getChart().getChartStore().getOverlaysByPaneId()},e.prototype.getProgressOverlay=function(){var t,e;return null!==(e=null===(t=this.getWidget().getPane().getChart().getChartStore().getProgressOverlayInfo())||void 0===t?void 0:t.overlay)&&void 0!==e?e:null},e.prototype.getDefaultFigures=function(t,e){var i,r=[],n=this.getWidget(),o=n.getPane().getChart().getChartStore(),s=o.getClickOverlayInfo();if(t.needDefaultXAxisFigure&&t.id===(null===(i=s.overlay)||void 0===i?void 0:i.id)){var l=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;e.forEach((function(e,i){l=Math.min(l,e.x),u=Math.max(u,e.x);var n=t.points[i];if(a(n.timestamp)){var s=o.getInnerFormatter().formatDate(n.timestamp,"YYYY-MM-DD HH:mm","crosshair");r.push({type:"text",attrs:{x:e.x,y:0,text:s,align:"center"},ignoreEvent:!0})}})),e.length>1&&r.unshift({type:"rect",attrs:{x:l,y:0,width:u-l,height:n.getBounding().height},ignoreEvent:!0})}return r},e.prototype.getFigures=function(t,e){var i,r,n=this.getWidget(),o=n.getPane(),a=o.getChart(),s=o.getAxisComponent(),l=a.getXAxisPane().getAxisComponent(),u=n.getBounding();return null!==(r=null===(i=t.createXAxisFigures)||void 0===i?void 0:i.call(t,{chart:a,overlay:t,coordinates:e,bounding:u,xAxis:l,yAxis:s}))&&void 0!==r?r:[]},e}(We),Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.compare=function(t){return s(t.timestamp)},e.prototype.getDirectionStyles=function(t){return t.vertical},e.prototype.getText=function(t,e){var i,r,n=t.timestamp;return e.getInnerFormatter().formatDate(n,Ie[null!==(r=null===(i=e.getPeriod())||void 0===i?void 0:i.type)&&void 0!==r?r:"day"],"crosshair")},e.prototype.getTextAttrs=function(t,e,i,r,n,o){var a=i.realX,s=0,l="center";return a-e/2-o.paddingLeft<0?(s=0,l="left"):a+e/2+o.paddingRight>r.width?(s=r.width,l="right"):s=a,{x:s,y:0,text:t,align:l,baseline:"top"}},e}(Ve),$e=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._xAxisView=new Qe(r),r._overlayXAxisView=new Ke(r),r._crosshairVerticalLabelView=new Je(r),r.setCursor("ew-resize"),r.addChild(r._overlayXAxisView),r}return E(e,t),e.prototype.getName=function(){return Zt},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(Jt),ti=function(t){function e(e,i){var r=t.call(this,e)||this;return r.override(i),r}return E(e,t),e.prototype.override=function(t){var e=t.name,i=t.scrollZoomEnabled,r=t.createTicks;u(this.name)||(this.name=e),this.scrollZoomEnabled=null!=i?i:this.scrollZoomEnabled,this.createTicks=null!=r?r:this.createTicks},e.prototype.createRangeImp=function(){var t=this.getParent().getChart().getChartStore().getVisibleRange(),e=t.realFrom,i=t.realTo,r=i-e+1;return{from:e,to:i,range:r,realFrom:e,realTo:i,realRange:r,displayFrom:e,displayTo:i,displayRange:r}},e.prototype.createTicksImp=function(){var t,e=this.getRange(),i=e.realFrom,r=e.realTo,o=e.from,s=this.getParent().getChart().getChartStore(),l=s.getInnerFormatter().formatDate,u=s.getPeriod(),c=[],h=s.getBarSpace().bar,d=s.getStyles().xAxis.tickText,p=Math.max(w("YYYY-MM-DD HH:mm:ss",d.size,d.weight,d.family),this.getBounding().width/8),g=Math.ceil(p/h);g%2!=0&&(g+=1);for(var v=Math.max(0,Math.floor(i/g)*g);v<r;v+=g)if(v>=o){var f=s.dataIndexToTimestamp(v);a(f)&&c.push({coord:this.convertToPixel(v),value:f,text:l(f,Pe[null!==(t=null==u?void 0:u.type)&&void 0!==t?t:"day"],"xAxis")})}return n(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:c}):c},e.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),e=t.xAxis,i=e.size;if("auto"!==i)return i;var r=t.crosshair,n=0;e.show&&(e.axisLine.show&&(n+=e.axisLine.size),e.tickLine.show&&(n+=e.tickLine.length),e.tickText.show&&(n+=e.tickText.marginStart+e.tickText.marginEnd+e.tickText.size));var o=0;return r.show&&r.vertical.show&&r.vertical.text.show&&(o+=r.vertical.text.paddingTop+r.vertical.text.paddingBottom+2*r.vertical.text.borderSize+r.vertical.text.size),Math.max(n,o)},e.prototype.getBounding=function(){return this.getParent().getMainWidget().getBounding()},e.prototype.convertTimestampFromPixel=function(t){var e=this.getParent().getChart().getChartStore(),i=e.coordinateToDataIndex(t);return e.dataIndexToTimestamp(i)},e.prototype.convertTimestampToPixel=function(t){var e=this.getParent().getChart().getChartStore(),i=e.timestampToDataIndex(t);return e.dataIndexToCoordinate(i)},e.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().coordinateToDataIndex(t)},e.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().dataIndexToCoordinate(t)},e.extend=function(t){var i=function(e){function i(i){return e.call(this,i,t)||this}return E(i,e),i}(e);return i},e}(Ne),ei={normal:ti.extend({name:"normal"})};var ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.createAxisComponent=function(t){var e=function(t){var e;return null!==(e=ei[t])&&void 0!==e?e:ei.normal}(t);return new e(this)},e.prototype.createMainWidget=function(t){return new $e(t,this)},e}(Ze);var ri=function(t){function e(e,i){var r,n,o,a=t.call(this,e,i)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._bottomPaneHeight=0,a._topPane=null,a._bottomPane=null,a._pressedMouseMoveEvent=(r=a._pressedTouchMouseMoveEvent,n=20,o=0,function(){var t=Date.now();t-o>n&&(r.apply(this,arguments),o=t)}),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return E(e,t),e.prototype.getName=function(){return jt},e.prototype._mouseDownEvent=function(t){var e=this;this._dragFlag=!0,this._dragStartY=t.pageY;var i=this.getPane(),r=i.getChart();this._topPane=i.getTopPane(),this._bottomPane=i.getBottomPane();var n=r.getDrawPanes();if("minimize"===this._topPane.getOptions().state)for(var o=n.findIndex((function(t){var i;return t.getId()===(null===(i=e._topPane)||void 0===i?void 0:i.getId())})),a=o-1;a>-1;a--){var s=n[a];if("minimize"!==s.getOptions().state){this._topPane=s;break}}if("minimize"===this._bottomPane.getOptions().state)for(o=n.findIndex((function(t){var i;return t.getId()===(null===(i=e._bottomPane)||void 0===i?void 0:i.getId())})),a=o+1;a<n.length;a++){var l=n[a];if("minimize"!==l.getOptions().state){this._bottomPane=l;break}}return this._topPaneHeight=this._topPane.getBounding().height,this._bottomPaneHeight=this._bottomPane.getBounding().height,!0},e.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._topPane=null,this._bottomPane=null,this._topPaneHeight=0,this._bottomPaneHeight=0,this._mouseLeaveEvent()},e.prototype._pressedTouchMouseMoveEvent=function(t){var e=t.pageY-this._dragStartY,i=e<0;if(s(this._topPane)&&s(this._bottomPane)){var r=this._bottomPane.getOptions();if("minimize"!==this._topPane.getOptions().state&&"minimize"!==r.state&&r.dragEnabled){var n=null,o=null,a=0,l=0;i?(n=this._topPane,o=this._bottomPane,a=this._topPaneHeight,l=this._bottomPaneHeight):(n=this._bottomPane,o=this._topPane,a=this._bottomPaneHeight,l=this._topPaneHeight);var u=n.getOptions().minHeight;if(a>u){var c=Math.max(a-Math.abs(e),u),h=a-c;n.setBounding({height:c}),o.setBounding({height:l+h});var d=this.getPane(),p=d.getChart();p.getChartStore().executeAction("onPaneDrag",{paneId:d.getId()}),p.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}}}return!0},e.prototype._mouseEnterEvent=function(){var t=this.getPane();if(t.getBottomPane().getOptions().dragEnabled){var e=t.getChart().getStyles().separator;return this.getContainer().style.background=e.activeBackgroundColor,!0}return!1},e.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this.getContainer().style.background="transparent",!0)},e.prototype.createContainer=function(){return N("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},e.prototype.updateImp=function(t,e,i){if(4===i||2===i){var r=this.getPane().getChart().getStyles().separator;t.style.top="".concat(-Math.floor((7-r.size)/2),"px"),t.style.height="".concat(7,"px")}},e}(Kt),ni=function(t){function i(e,i,r,n){var o=t.call(this,e,i)||this;return o.getContainer().style.overflow="",o._topPane=r,o._bottomPane=n,o._separatorWidget=new ri(o.getContainer(),o),o}return E(i,t),i.prototype.setBounding=function(t){return e(this.getBounding(),t),this},i.prototype.getTopPane=function(){return this._topPane},i.prototype.setTopPane=function(t){return this._topPane=t,this},i.prototype.getBottomPane=function(){return this._bottomPane},i.prototype.setBottomPane=function(t){return this._bottomPane=t,this},i.prototype.getWidget=function(){return this._separatorWidget},i.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,r=e.height,n=this.getChart().getStyles().separator,o=N("canvas",{width:"".concat(i,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),a=o.getContext("2d"),s=x(o);return o.width=i*s,o.height=r*s,a.scale(s,s),a.fillStyle=n.color,a.fillRect(0,0,i,r),o},i.prototype.updateImp=function(t,e,i){if(4===t||2===t){var r=this.getChart().getStyles().separator;e.style.backgroundColor=r.color,e.style.height="".concat(i.height,"px"),e.style.marginLeft="".concat(i.left,"px"),e.style.width="".concat(i.width,"px"),this._separatorWidget.update(t)}},i}(Ue);function oi(){return"undefined"!=typeof window&&window.navigator.userAgent.toLowerCase().includes("firefox")}function ai(){return"undefined"!=typeof window&&/iPhone|iPad|iPod|iOS/.test(window.navigator.userAgent)}var si=500,li=500,ui=500,ci=5,hi=5,di=5,pi=30,gi=0,vi=1,fi=2,mi=function(){function t(t,e,i){var r=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!ai(),this._onFirefoxOutsideMouseUp=function(t){r._mouseUpHandler(t)},this._onMobileSafariDoubleClick=function(t){r._firesTouchEvents(t)?(++r._tapCount,null!==r._tapTimeoutId&&r._tapCount>1&&(r._mouseTouchMoveWithDownInfo(r._getCoordinate(t),r._tapCoordinate).manhattanDistance<pi&&!r._cancelTap&&r._processEvent(r._makeCompatEvent(t),r._handler.doubleTapEvent),r._resetTapTimeout())):(++r._clickCount,null!==r._clickTimeoutId&&r._clickCount>1&&(r._mouseTouchMoveWithDownInfo(r._getCoordinate(t),r._clickCoordinate).manhattanDistance<di&&!r._cancelClick&&r._processEvent(r._makeCompatEvent(t),r._handler.mouseDoubleClickEvent),r._resetClickTimeout()))},this._target=t,this._handler=e,this._options=i,this._init()}return t.prototype.destroy=function(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeMouseWheel&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),null!==this._unsubscribeContextMenu&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},t.prototype._mouseEnterHandler=function(t){var e,i,r,n=this;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(r=this._unsubscribeContextMenu)||void 0===r||r.call(this);var o=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){n._target.removeEventListener("mousemove",o)},this._target.addEventListener("mousemove",o);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){n._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var s=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){n._target.removeEventListener("contextmenu",s)},this._target.addEventListener("contextmenu",s,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},t.prototype._resetClickTimeout=function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._resetTapTimeout=function(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._mouseMoveHandler=function(t){this._mousePressed||null!==this._touchMoveStartCoordinate||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},t.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!s(this._handler.mouseWheelHortEvent))return;if(this._preventDefault(t),0===Math.abs(t.deltaX))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!s(this._handler.mouseWheelVertEvent))return;var e=-t.deltaY/100;if(0===e)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},t.prototype._contextMenuHandler=function(t){this._preventDefault(t)},t.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null!==e&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),null===this._startPinchMiddleCoordinate&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),r=i.xOffset,n=i.yOffset,o=i.manhattanDistance;if(this._touchMoveExceededManhattanDistance||!(o<hi)){if(!this._touchMoveExceededManhattanDistance){var a=.5*r,s=n>=a&&!this._options.treatVertDragAsPageScroll(),l=a>n&&!this._options.treatHorzDragAsPageScroll();s||l||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},t.prototype._mouseMoveWithDownHandler=function(t){t.button===gi&&(this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance>=ci&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},t.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return{xOffset:i,yOffset:r,manhattanDistance:i+r}},t.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);if(this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,null!==this._tapTimeoutId&&this._tapCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance<pi&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout();else this._cancelTap||(this._processEvent(i,this._handler.tapEvent),s(this._handler.tapEvent)&&this._preventDefault(t));0===this._tapCount&&this._preventDefault(t),0===t.touches.length&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},t.prototype._mouseUpHandler=function(t){if(t.button===gi){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),oi())this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp);if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,null!==this._clickTimeoutId&&this._clickCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance<di&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout();else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},t.prototype._clearLongTapTimeout=function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},t.prototype._touchStartHandler=function(t){if(null===this._activeTouchId){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var r=this._touchMoveHandler.bind(this),n=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",r),i.removeEventListener("touchend",n)},i.addEventListener("touchmove",r,{passive:!1}),i.addEventListener("touchend",n,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),li),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),null===this._tapTimeoutId&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),si),this._tapCoordinate=this._getCoordinate(e))}},t.prototype._mouseDownHandler=function(t){if(t.button===fi)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(t.button===gi){var e=this._target.ownerDocument.documentElement;oi()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var i=this._mouseMoveWithDownHandler.bind(this),r=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",r),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),null===this._clickTimeoutId&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),si),this._clickCoordinate=this._getCoordinate(t)))}},t.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){null!=t._handler.mouseDownOutsideEvent&&(e.composed&&t._target.contains(e.composedPath()[0])||null!==e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),ai()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",(function(t){if(t.button===vi)return t.preventDefault(),!1})),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype._initPinch=function(){var t=this;(s(this._handler.pinchStartEvent)||s(this._handler.pinchEvent)||s(this._handler.pinchEndEvent))&&(this._target.addEventListener("touchstart",(function(e){t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&s(t._handler.pinchEvent)){var i=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(T(T({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),i),t._preventDefault(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))},t.prototype._checkPinchState=function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},t.prototype._startPinch=function(t){var e=this._target.getBoundingClientRect();this._startPinchMiddleCoordinate={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),s(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},t.prototype._stopPinch=function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,s(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},t.prototype._mouseLeaveHandler=function(t){var e,i,r;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(r=this._unsubscribeContextMenu)||void 0===r||r.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!ai())},t.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);null!==e&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},t.prototype._firesTouchEvents=function(t){var e;return s(null===(e=t.sourceCapabilities)||void 0===e?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+ui},t.prototype._processEvent=function(t,e){null==e||e.call(this._handler,t)},t.prototype._makeCompatEvent=function(t,e){var i=this,r=null!=e?e:t,n=this._target.getBoundingClientRect();return{x:r.clientX-n.left,y:r.clientY-n.top,pageX:r.pageX,pageY:r.pageY,isTouch:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type&&"wheel"!==t.type,preventDefault:function(){"touchstart"!==t.type&&i._preventDefault(t)}}},t.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(i*i+r*r)},t.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},t.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},t.prototype._eventTimeStamp=function(t){var e;return null!==(e=t.timeStamp)&&void 0!==e?e:performance.now()},t.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},t}(),yi=function(){function t(t,e){var i=this;this._flingStartTime=(new Date).getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(t){if(t.shiftKey)switch(t.code){case"Equal":i._chart.getChartStore().zoom(.5);break;case"Minus":i._chart.getChartStore().zoom(-.5);break;case"ArrowLeft":(e=i._chart.getChartStore()).startScroll(),e.scroll(-3*e.getBarSpace().bar);break;case"ArrowRight":var e;(e=i._chart.getChartStore()).startScroll(),e.scroll(3*e.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new mi(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return t.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},t.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),r=i.pane,n=i.widget;if((null==r?void 0:r.getId())!==Yt&&(null==n?void 0:n.getName())===Ut){var o=this._makeWidgetEvent(t,n),a=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().zoom(a,{x:o.x,y:o.y}),!0}return!1},t.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore();return i.startScroll(),i.scroll(e),!0},t.prototype.mouseWheelVertEvent=function(t,e){var i=this._findWidgetByEvent(t).widget,r=this._makeWidgetEvent(t,i);return(null==i?void 0:i.getName())===Ut&&(this._chart.getChartStore().zoom(e,{x:r.x,y:r.y}),!0)},t.prototype.mouseDownEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,r=e.widget;if(this._mouseDownWidget=r,null!==r){var n=this._makeWidgetEvent(t,r);switch(r.getName()){case jt:return r.dispatchEvent("mouseDownEvent",n);case Ut:var o=i.getAxisComponent();if(!o.getAutoCalcTickFlag()){var a=o.getRange();this._prevYAxisRange=T({},a)}return this._startScrollCoordinate={x:n.x,y:n.y},this._chart.getChartStore().startScroll(),r.dispatchEvent("mouseDownEvent",n);case Zt:return this._processXAxisScrollStartEvent(r,n);case qt:return this._processYAxisScaleStartEvent(r,n)}}return!1},t.prototype.mouseMoveEvent=function(t){var e,i,r,n=this._findWidgetByEvent(t),o=n.pane,a=n.widget,s=this._makeWidgetEvent(t,a);if((null===(e=this._mouseMoveTriggerWidgetInfo.pane)||void 0===e?void 0:e.getId())===(null==o?void 0:o.getId())&&(null===(i=this._mouseMoveTriggerWidgetInfo.widget)||void 0===i?void 0:i.getName())===(null==a?void 0:a.getName())||(null==a||a.dispatchEvent("mouseEnterEvent",s),null===(r=this._mouseMoveTriggerWidgetInfo.widget)||void 0===r||r.dispatchEvent("mouseLeaveEvent",s),this._mouseMoveTriggerWidgetInfo={pane:o,widget:a}),null!==a)switch(a.getName()){case Ut:var l=a.dispatchEvent("mouseMoveEvent",s),u={x:s.x,y:s.y,paneId:null==o?void 0:o.getId()};return l?("pointer"!==a.getForceCursor()&&(u=void 0),a.setCursor("pointer")):a.setCursor("crosshair"),this._chart.getChartStore().setCrosshair(u),l;case jt:case Zt:case qt:l=a.dispatchEvent("mouseMoveEvent",s);return this._chart.getChartStore().setCrosshair(),l}return!1},t.prototype.pressedMouseMoveEvent=function(t){var e,i;if(null!==this._mouseDownWidget&&this._mouseDownWidget.getName()===jt)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var r=this._findWidgetByEvent(t),n=r.pane,o=r.widget;if(null!==o&&(null===(e=this._mouseDownWidget)||void 0===e?void 0:e.getPane().getId())===(null==n?void 0:n.getId())&&(null===(i=this._mouseDownWidget)||void 0===i?void 0:i.getName())===o.getName()){var a=this._makeWidgetEvent(t,o);switch(o.getName()){case Ut:var s=void 0,l=o.dispatchEvent("pressedMouseMoveEvent",a);return l||this._processMainScrollingEvent(o,a),l&&"pointer"!==o.getForceCursor()||(s={x:a.x,y:a.y,paneId:null==n?void 0:n.getId()}),this._chart.getChartStore().setCrosshair(s,{forceInvalidate:!0}),l;case Zt:return this._processXAxisScrollingEvent(o,a);case qt:return this._processYAxisScalingEvent(o,a)}}return!1},t.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var r=this._makeWidgetEvent(t,e);switch(e.getName()){case Ut:case jt:case Zt:case qt:i=e.dispatchEvent("mouseUpEvent",r)}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},t.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(null!==e){var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},t.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var r=this._makeWidgetEvent(t,e);switch(e.getName()){case Ut:case Zt:case qt:i=e.dispatchEvent("mouseRightClickEvent",r)}i&&this._chart.updatePane(1)}return!1},t.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,r=e.widget;if(null!==r)switch(r.getName()){case Ut:var n=this._makeWidgetEvent(t,r);return r.dispatchEvent("mouseDoubleClickEvent",n);case qt:var o=i.getAxisComponent();if(!o.getAutoCalcTickFlag())return o.setAutoCalcTickFlag(!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),!0}return!1},t.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().setCrosshair(),!0},t.prototype.touchStartEvent=function(t){var e,i=this._findWidgetByEvent(t),r=i.pane,n=i.widget;if(null!==n){var o=this._makeWidgetEvent(t,n);switch(null===(e=o.preventDefault)||void 0===e||e.call(o),n.getName()){case Ut:var a=this._chart.getChartStore();if(n.dispatchEvent("mouseDownEvent",o))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0;null!==this._flingScrollRequestId&&(R(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=(new Date).getTime();var s=r.getAxisComponent();if(!s.getAutoCalcTickFlag()){var l=s.getRange();this._prevYAxisRange=T({},l)}if(this._startScrollCoordinate={x:o.x,y:o.y},a.startScroll(),this._touchZoomed=!1,null!==this._touchCoordinate){var u=o.x-this._touchCoordinate.x,c=o.y-this._touchCoordinate.y;Math.sqrt(u*u+c*c)<10?(this._touchCoordinate={x:o.x,y:o.y},a.setCrosshair({x:o.x,y:o.y,paneId:null==r?void 0:r.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,a.setCrosshair())}return!0;case Zt:return this._processXAxisScrollStartEvent(n,o);case qt:return this._processYAxisScaleStartEvent(n,o)}}return!1},t.prototype.touchMoveEvent=function(t){var e,i=this._findWidgetByEvent(t),r=i.pane,n=i.widget;if(null!==n){var o=this._makeWidgetEvent(t,n);null===(e=o.preventDefault)||void 0===e||e.call(o);var a=n.getName(),s=this._chart.getChartStore();switch(a){case Ut:return n.dispatchEvent("pressedMouseMoveEvent",o)?(s.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0):(null!==this._touchCoordinate?s.setCrosshair({x:o.x,y:o.y,paneId:null==r?void 0:r.getId()}):this._processMainScrollingEvent(n,o),!0);case Zt:return this._processXAxisScrollingEvent(n,o);case qt:return this._processYAxisScalingEvent(n,o)}}return!1},t.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(null!==i){var r=this._makeWidgetEvent(t,i);switch(i.getName()){case Ut:if(i.dispatchEvent("mouseUpEvent",r),null!==this._startScrollCoordinate){var n=(new Date).getTime()-this._flingStartTime,o=(r.x-this._startScrollCoordinate.x)/(n>0?n:1)*20;if(n<200&&Math.abs(o)>0){var a=this._chart.getChartStore(),s=function(){e._flingScrollRequestId=B((function(){a.startScroll(),a.scroll(o),o*=.975,Math.abs(o)<1?null!==e._flingScrollRequestId&&(R(e._flingScrollRequestId),e._flingScrollRequestId=null):s()}))};s()}}return!0;case Zt:case qt:i.dispatchEvent("mouseUpEvent",r)&&this._chart.updatePane(1)}this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0}return!1},t.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,r=e.widget,n=!1;if(null!==r){var o=this._makeWidgetEvent(t,r),a=r.dispatchEvent("mouseClickEvent",o);if(r.getName()===Ut){var s=this._makeWidgetEvent(t,r),l=this._chart.getChartStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,{notInvalidate:!0}),n=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:s.x,y:s.y},l.setCrosshair({x:s.x,y:s.y,paneId:null==i?void 0:i.getId()},{notInvalidate:!0}),n=!0),this._touchCancelCrosshair=!1)}(n||a)&&this._chart.updatePane(1)}return n},t.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},t.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,r=e.widget;if(null!==r&&r.getName()===Ut){var n=this._makeWidgetEvent(t,r);return this._touchCoordinate={x:n.x,y:n.y},this._chart.getChartStore().setCrosshair({x:n.x,y:n.y,paneId:null==i?void 0:i.getId()}),!0}return!1},t.prototype._processMainScrollingEvent=function(t,e){if(null!==this._startScrollCoordinate){var i=t.getPane().getAxisComponent();if(null!==this._prevYAxisRange&&!i.getAutoCalcTickFlag()&&i.scrollZoomEnabled){var r=this._prevYAxisRange,n=r.from,o=r.to,a=r.range*((i.reverse?this._startScrollCoordinate.y-e.y:e.y-this._startScrollCoordinate.y)/t.getBounding().height),s=n+a,l=o+a,u=i.valueToRealValue(s,{range:this._prevYAxisRange}),c=i.valueToRealValue(l,{range:this._prevYAxisRange}),h=i.realValueToDisplayValue(u,{range:this._prevYAxisRange}),d=i.realValueToDisplayValue(c,{range:this._prevYAxisRange});i.setRange({from:s,to:l,range:l-s,realFrom:u,realTo:c,realRange:c-u,displayFrom:h,displayTo:d,displayRange:d-h})}var p=e.x-this._startScrollCoordinate.x;this._chart.getChartStore().scroll(p)}},t.prototype._processXAxisScrollStartEvent=function(t,e){var i=t.dispatchEvent("mouseDownEvent",e);return i&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:e.x,y:e.y},this._xAxisStartScaleDistance=e.pageX,i},t.prototype._processXAxisScrollingEvent=function(t,e){var i,r=t.dispatchEvent("pressedMouseMoveEvent",e);if(r)this._chart.updatePane(1);else if(t.getPane().getAxisComponent().scrollZoomEnabled&&0!==this._xAxisStartScaleDistance){var n=this._xAxisStartScaleDistance/e.pageX;if(Number.isFinite(n)){var o=10*(n-this._xAxisScale);this._xAxisScale=n,this._chart.getChartStore().zoom(o,null!==(i=this._xAxisStartScaleCoordinate)&&void 0!==i?i:void 0)}}return r},t.prototype._processYAxisScaleStartEvent=function(t,e){var i=t.dispatchEvent("mouseDownEvent",e);i&&this._chart.updatePane(1);var r=t.getPane().getAxisComponent().getRange();return this._prevYAxisRange=T({},r),this._yAxisStartScaleDistance=e.pageY,i},t.prototype._processYAxisScalingEvent=function(t,e){var i=t.dispatchEvent("pressedMouseMoveEvent",e);if(i)this._chart.updatePane(1);else{var r=t.getPane().getAxisComponent();if(null!==this._prevYAxisRange&&r.scrollZoomEnabled&&0!==this._yAxisStartScaleDistance){var n=this._prevYAxisRange,o=n.from,a=n.to,s=n.range,l=s*(e.pageY/this._yAxisStartScaleDistance),u=(l-s)/2,c=o-u,h=a+u,d=r.valueToRealValue(c,{range:this._prevYAxisRange}),p=r.valueToRealValue(h,{range:this._prevYAxisRange}),g=r.realValueToDisplayValue(d,{range:this._prevYAxisRange}),v=r.realValueToDisplayValue(p,{range:this._prevYAxisRange});r.setRange({from:c,to:h,range:l,realFrom:d,realTo:p,realRange:p-d,displayFrom:g,displayTo:v,displayRange:v-g}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})}}return i},t.prototype._findWidgetByEvent=function(t){var e,i,r,n,o=t.x,a=t.y,l=this._chart.getSeparatorPanes(),u=this._chart.getStyles().separator.size;try{for(var c=M(l),h=c.next();!h.done;h=c.next()){var d=h.value[1],p=(y=d.getBounding()).top-Math.round((7-u)/2);if(o>=y.left&&o<=y.left+y.width&&a>=p&&a<=p+7)return{pane:d,widget:d.getWidget()}}}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}var g=this._chart.getDrawPanes(),v=null;try{for(var f=M(g),m=f.next();!m.done;m=f.next()){var y,_=m.value;if(o>=(y=_.getBounding()).left&&o<=y.left+y.width&&a>=y.top&&a<=y.top+y.height){v=_;break}}}catch(t){r={error:t}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var x=null;if(null!==v){if(!s(x)){var b=v.getMainWidget(),w=b.getBounding();o>=w.left&&o<=w.left+w.width&&a>=w.top&&a<=w.top+w.height&&(x=b)}if(!s(x)){var C=v.getYAxisWidget();if(null!==C){var E=C.getBounding();o>=E.left&&o<=E.left+E.width&&a>=E.top&&a<=E.top+E.height&&(x=C)}}}return{pane:v,widget:x}},t.prototype._makeWidgetEvent=function(t,e){var i,r,n,o=null!==(i=null==e?void 0:e.getBounding())&&void 0!==i?i:null;return T(T({},t),{x:t.x-(null!==(r=null==o?void 0:o.left)&&void 0!==r?r:0),y:t.y-(null!==(n=null==o?void 0:o.top)&&void 0!==n?n:0)})},t.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},t}(),_i=function(){function t(t,e){this._chartBounding=A(),this._drawPanes=[],this._separatorPanes=new Map,this._layoutOptions={sort:!0,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!1,cacheYAxisWidth:!1,forceBuildYAxisTick:!1},this._layoutPending=!1,this._cacheYAxisWidth={left:0,right:0},this._initContainer(t),this._chartEvent=new yi(this._chartContainer,this),this._chartStore=new Gt(this,e),this._initPanes(e),this._layout()}return t.prototype._initContainer=function(t){this._container=t,this._chartContainer=N("div",{position:"relative",width:"100%",height:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",overflow:"hidden",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer),this._cacheChartBounding()},t.prototype._cacheChartBounding=function(){this._chartBounding.width=Math.floor(this._chartContainer.clientWidth),this._chartBounding.height=Math.floor(this._chartContainer.clientHeight)},t.prototype._initPanes=function(t){var i,r=this,n=null!==(i=null==t?void 0:t.layout)&&void 0!==i?i:[{type:"candle"}],o=function(t){var i,n;if(!s(r._candlePane)){var o=null!==(i=t.options)&&void 0!==i?i:{};e(o,{id:zt}),r._candlePane=r._createPane(je,zt,o),(null!==(n=t.content)&&void 0!==n?n:[]).forEach((function(t){r.createIndicator(t,!0,o)}))}},a=function(t){if(!s(r._xAxisPane)){var e=r._createPane(ii,Yt,null!=t?t:{});r._xAxisPane=e}};n.forEach((function(t){var e,i,n;switch(t.type){case"candle":o(t);break;case"indicator":var l=null!==(e=t.content)&&void 0!==e?e:[];if(l.length>0){var u=null!==(n=null===(i=t.options)||void 0===i?void 0:i.id)&&void 0!==n?n:null;s(u)&&(u=z(Nt));var c=T(T({},t.options),{id:u});l.forEach((function(t){r.createIndicator(t,!0,c)}))}break;case"xAxis":a(t.options)}})),o({}),a({order:Number.MAX_SAFE_INTEGER})},t.prototype._createPane=function(t,e,i){var r=new t(this,e,null!=i?i:{});return this._drawPanes.push(r),r},t.prototype._recalculatePaneHeight=function(t,e,i){if(0===i)return!1;var r=this._drawPanes.filter((function(e){var i=e.getId();return"normal"===e.getOptions().state&&i!==t.getId()&&i!==Yt})),n=r.length;if(0===n)return!1;if(t.getId()!==zt&&s(this._candlePane)&&"normal"===this._candlePane.getOptions().state){var o=this._candlePane.getBounding().height;if(o>0){var a=this._candlePane.getOptions().minHeight,l=o+i;l<a&&(e-=o+i-(l=a)),this._candlePane.setBounding({height:l})}}else{var u=i,c=Math.floor(i/n);r.forEach((function(t,e){var i=t.getBounding().height,r=0;(r=e===n-1?i+u:i+c)<t.getOptions().minHeight&&(r=t.getOptions().minHeight),t.setBounding({height:r}),u-=r-i})),Math.abs(u)>0&&(e-=u)}return t.setBounding({height:e}),!0},t.prototype.getDrawPaneById=function(t){if(t===zt)return this._candlePane;if(t===Yt)return this._xAxisPane;var e=this._drawPanes.find((function(e){return e.getId()===t}));return null!=e?e:null},t.prototype.getContainer=function(){return this._container},t.prototype.getChartStore=function(){return this._chartStore},t.prototype.getXAxisPane=function(){return this._xAxisPane},t.prototype.getDrawPanes=function(){return this._drawPanes},t.prototype.getSeparatorPanes=function(){return this._separatorPanes},t.prototype.layout=function(t){var e,i,r,n,o,a,s,l=this;null!==(e=t.sort)&&void 0!==e&&e&&(this._layoutOptions.sort=t.sort),null!==(i=t.measureHeight)&&void 0!==i&&i&&(this._layoutOptions.measureHeight=t.measureHeight),null!==(r=t.measureWidth)&&void 0!==r&&r&&(this._layoutOptions.measureWidth=t.measureWidth),null!==(n=t.update)&&void 0!==n&&n&&(this._layoutOptions.update=t.update),null!==(o=t.buildYAxisTick)&&void 0!==o&&o&&(this._layoutOptions.buildYAxisTick=t.buildYAxisTick),null!==(a=t.cacheYAxisWidth)&&void 0!==a&&a&&(this._layoutOptions.cacheYAxisWidth=t.cacheYAxisWidth),null!==(s=t.buildYAxisTick)&&void 0!==s&&s&&(this._layoutOptions.forceBuildYAxisTick=t.forceBuildYAxisTick),this._layoutPending||(this._layoutPending=!0,Promise.resolve().then((function(t){l._layout(),l._layoutPending=!1})).catch((function(t){})))},t.prototype._layout=function(){var t=this,e=this._layoutOptions,i=e.sort,r=e.measureHeight,n=e.measureWidth,o=e.update,a=e.buildYAxisTick,l=e.cacheYAxisWidth,u=e.forceBuildYAxisTick;if(i){for(;s(this._chartContainer.firstChild);)this._chartContainer.removeChild(this._chartContainer.firstChild);this._separatorPanes.clear(),this._drawPanes.sort((function(t,e){return t.getOptions().order-e.getOptions().order}));var c=null;this._drawPanes.forEach((function(e){if(e.getId()!==Yt){if(s(c)){var i=new ni(t,"",c,e);t._chartContainer.appendChild(i.getContainer()),t._separatorPanes.set(e,i)}c=e}t._chartContainer.appendChild(e.getContainer())}))}if(r){var h=this._chartBounding.height,d=this.getStyles().separator.size,p=this._xAxisPane.getAxisComponent().getAutoSize(),g=h-p;g<0&&(g=0),this._drawPanes.forEach((function(e){var i=e.getId();if(s(t._separatorPanes.get(e))&&(g-=d),i!==Yt&&i!==zt&&e.getVisible()){var r=e.getBounding().height;r>g?(r=g,g=0):g-=r,e.setBounding({height:r})}})),this._candlePane.setBounding({height:Math.max(g,0)}),this._xAxisPane.setBounding({height:p});var v=0;this._drawPanes.forEach((function(e){var i=t._separatorPanes.get(e);s(i)&&(i.setBounding({height:d,top:v}),v+=d),e.setBounding({top:v}),v+=e.getBounding().height}))}var f=n;if((a||u)&&this._drawPanes.forEach((function(t){var e=t.getAxisComponent().buildTicks(u);f||(f=e)})),f){var m=this._chartBounding.width,y=this.getStyles(),_=0,x=!0,b=0,w=!0;this._drawPanes.forEach((function(t){if(t.getId()!==Yt){var e=t.getAxisComponent(),i=e.inside,r=e.getAutoSize();"left"===e.position?(_=Math.max(_,r),i&&(x=!1)):(b=Math.max(b,r),i&&(w=!1))}})),l&&(_=Math.max(this._cacheYAxisWidth.left,_),b=Math.max(this._cacheYAxisWidth.right,b)),this._cacheYAxisWidth.left=_,this._cacheYAxisWidth.right=b;var C=m,E=0,T=0;x&&(C-=_,E=_),w&&(C-=b,T=b),this._chartStore.setTotalBarSpace(C);var S={width:m},P={width:C,left:E,right:T},I={width:_},M={width:b},k=y.separator.fill,D={};D=k?S:P,this._drawPanes.forEach((function(e){var i;null===(i=t._separatorPanes.get(e))||void 0===i||i.setBounding(D),e.setBounding(S,P,I,M)}))}o&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4)),this._layoutOptions={sort:!1,measureHeight:!1,measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1,forceBuildYAxisTick:!1}},t.prototype.updatePane=function(t,e){var i=this;if(s(e)){var r=this.getDrawPaneById(e);null==r||r.update(t)}else this._drawPanes.forEach((function(e){var r;e.update(t),null===(r=i._separatorPanes.get(e))||void 0===r||r.update(t)}))},t.prototype.crosshairChange=function(t){var e=this;if(this._chartStore.hasAction("onCrosshairChange")){var i={};this._drawPanes.forEach((function(r){var n=r.getId(),o={};e._chartStore.getIndicatorsByPaneId(n).forEach((function(e){var i,r=e.result;o[e.name]=r[null!==(i=t.dataIndex)&&void 0!==i?i:r.length-1]})),i[n]=o})),u(t.paneId)&&this._chartStore.executeAction("onCrosshairChange",{crosshair:t,indicatorData:i})}},t.prototype.getDom=function(t,e){var i,r;if(!s(t))return this._chartContainer;var n=this.getDrawPaneById(t);if(s(n))switch(null!=e?e:"root"){case"root":return n.getContainer();case"main":return n.getMainWidget().getContainer();case"yAxis":return null!==(r=null===(i=n.getYAxisWidget())||void 0===i?void 0:i.getContainer())&&void 0!==r?r:null}return null},t.prototype.getSize=function(t,e){var i,r;if(!s(t))return this._chartBounding;var n=this.getDrawPaneById(t);if(s(n))switch(null!=e?e:"root"){case"root":return n.getBounding();case"main":return n.getMainWidget().getBounding();case"yAxis":return null!==(r=null===(i=n.getYAxisWidget())||void 0===i?void 0:i.getBounding())&&void 0!==r?r:null}return null},t.prototype.setSymbol=function(t){this._chartStore.setSymbol(t)},t.prototype.getSymbol=function(){return this._chartStore.getSymbol()},t.prototype.setPeriod=function(t){this._chartStore.setPeriod(t)},t.prototype.getPeriod=function(){return this._chartStore.getPeriod()},t.prototype.setStyles=function(t){var e=this;this._setOptions((function(){e._chartStore.setStyles(t)}))},t.prototype.getStyles=function(){return this._chartStore.getStyles()},t.prototype.setFormatter=function(t){var e=this;this._setOptions((function(){e._chartStore.setFormatter(t)}))},t.prototype.getFormatter=function(){return this._chartStore.getFormatter()},t.prototype.setLocale=function(t){var e=this;this._setOptions((function(){e._chartStore.setLocale(t)}))},t.prototype.getLocale=function(){return this._chartStore.getLocale()},t.prototype.setTimezone=function(t){var e=this;this._setOptions((function(){e._chartStore.setTimezone(t)}))},t.prototype.getTimezone=function(){return this._chartStore.getTimezone()},t.prototype.setThousandsSeparator=function(t){var e=this;this._setOptions((function(){e._chartStore.setThousandsSeparator(t)}))},t.prototype.getThousandsSeparator=function(){return this._chartStore.getThousandsSeparator()},t.prototype.setDecimalFold=function(t){var e=this;this._setOptions((function(){e._chartStore.setDecimalFold(t)}))},t.prototype.getDecimalFold=function(){return this._chartStore.getDecimalFold()},t.prototype._setOptions=function(t){t(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},t.prototype.setOffsetRightDistance=function(t){this._chartStore.setOffsetRightDistance(t,!0)},t.prototype.getOffsetRightDistance=function(){return this._chartStore.getOffsetRightDistance()},t.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.setMaxOffsetLeftDistance(t)},t.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.setMaxOffsetRightDistance(t)},t.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.setLeftMinVisibleBarCount(Math.ceil(t))},t.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.setRightMinVisibleBarCount(Math.ceil(t))},t.prototype.setBarSpace=function(t){this._chartStore.setBarSpace(t)},t.prototype.getBarSpace=function(){return this._chartStore.getBarSpace()},t.prototype.getVisibleRange=function(){return this._chartStore.getVisibleRange()},t.prototype.resetData=function(){this._chartStore.resetData()},t.prototype.getDataList=function(){return this._chartStore.getDataList()},t.prototype.setDataLoader=function(t){this._chartStore.setDataLoader(t)},t.prototype.createIndicator=function(t,e,i){var r,n=u(t)?{name:t}:t;if(null===yt(n.name))return null;var o=null!=i?i:{};if(u(o.id)||(o.id=z(Nt)),u(n.id)||(n.id=z(n.name)),this._chartStore.addIndicator(n,o.id,null!=e&&e)){var a=!1;return s(this.getDrawPaneById(o.id))||(this._createPane(qe,o.id,o),null!==(r=o.height)&&void 0!==r||(o.height=100),a=!0),this.setPaneOptions(o),this.layout({sort:a,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0}),n.id}return null},t.prototype.overrideIndicator=function(t){return this._chartStore.overrideIndicator(t)},t.prototype.getIndicators=function(t){return this._chartStore.getIndicatorsByFilter(null!=t?t:{})},t.prototype.removeIndicator=function(t){var e=this,i=this._chartStore.removeIndicator(null!=t?t:{});if(i){var r=!1,n=[];this._drawPanes.forEach((function(t){var e=t.getId();e!==zt&&e!==Yt&&n.push(e)})),n.forEach((function(t){if(!e._chartStore.hasIndicators(t)){var i=e._drawPanes.findIndex((function(e){return e.getId()===t})),n=e._drawPanes[i];s(n)&&(r=!0,e._recalculatePaneHeight(n,0,n.getBounding().height),e._drawPanes.splice(i,1),n.destroy())}})),2===this._drawPanes.length&&(this._candlePane.setVisible(!0),this._candlePane.setBounding({height:this._chartBounding.height-this._xAxisPane.getBounding().height})),this.layout({sort:r,measureHeight:r,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}return i},t.prototype.createOverlay=function(t){var e=this,i=[],n=[],o=function(t){s(t.paneId)&&null!==e.getDrawPaneById(t.paneId)?n.push(!0):(t.paneId=zt,n.push(!1)),i.push(t)};u(t)?o({name:t}):r(t)?t.forEach((function(t){var e=null;e=u(t)?{name:t}:t,o(e)})):o(t);var a=this._chartStore.addOverlays(i,n);return r(t)?a:a[0]},t.prototype.getOverlays=function(t){return this._chartStore.getOverlaysByFilter(null!=t?t:{})},t.prototype.overrideOverlay=function(t){return this._chartStore.overrideOverlay(t)},t.prototype.removeOverlay=function(t){return this._chartStore.removeOverlay(null!=t?t:{})},t.prototype.setPaneOptions=function(t){var e,i,r,n=this,o=!1,l=!1,u=s(t.id),c=function(e){var i=e.getId();if(u&&t.id===i||!u){if(i!==Yt){if(a(t.height)&&t.height>0){var c=Math.max(null!==(r=t.minHeight)&&void 0!==r?r:e.getOptions().minHeight,0),d=Math.max(c,t.height);l=!0,o=!0,e.setOriginalBounding({height:d}),h._recalculatePaneHeight(e,d,-d)}if(s(t.state)&&e.getOptions().state!==t.state){o=!0,l=!0;var p=t.state;switch(p){case"maximize":if(!s(h._drawPanes.find((function(t){var e=t.getId();return"maximize"===t.getOptions().state&&e!==Yt})))){"normal"===e.getOptions().state&&e.setOriginalBounding({height:e.getBounding().height}),e.setOptions({state:p});var g=h._chartBounding.height;e.setBounding({height:g-h._xAxisPane.getBounding().height}),h._drawPanes.forEach((function(t){var e;t.getId()!==Yt&&t.getId()!==i&&(t.setBounding({height:t.getOriginalBounding().height}),t.setVisible(!1),null===(e=n._separatorPanes.get(t))||void 0===e||e.setVisible(!1))}))}break;case"minimize":d=e.getBounding().height;var v=e.getOptions().state,f=d-30;"maximize"===v&&(f=e.getOriginalBounding().height-30),h._recalculatePaneHeight(e,30,f)&&("normal"===v&&e.setOriginalBounding({height:d}),e.setOptions({state:p})),h._drawPanes.forEach((function(t){var e;t.getId()!==Yt&&(t.setVisible(!0),null===(e=n._separatorPanes.get(t))||void 0===e||e.setVisible(!0))}));break;default:d=e.getOriginalBounding().height;h._recalculatePaneHeight(e,d,e.getBounding().height-d)&&e.setOptions({state:p}),h._drawPanes.forEach((function(t){var e;t.getId()!==Yt&&(t.setVisible(!0),null===(e=n._separatorPanes.get(t))||void 0===e||e.setVisible(!0))}))}}}s(t.axis)&&(l=!0);var m=T({},t);if(delete m.state,e.setOptions(m),i===t.id)return"break"}},h=this;try{for(var d=M(this._drawPanes),p=d.next();!p.done;p=d.next()){if("break"===c(p.value))break}}catch(t){e={error:t}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(e)throw e.error}}l&&this.layout({measureHeight:o,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},t.prototype.getPaneOptions=function(t){var e;if(s(t)){var i=this.getDrawPaneById(t);return null!==(e=null==i?void 0:i.getOptions())&&void 0!==e?e:null}return this._drawPanes.map((function(t){return t.getOptions()}))},t.prototype.setZoomEnabled=function(t){this._chartStore.setZoomEnabled(t)},t.prototype.isZoomEnabled=function(){return this._chartStore.isZoomEnabled()},t.prototype.setScrollEnabled=function(t){this._chartStore.setScrollEnabled(t)},t.prototype.isScrollEnabled=function(){return this._chartStore.isScrollEnabled()},t.prototype.scrollByDistance=function(t,e){var i=this,r=a(e)&&e>0?e:0;if(this._chartStore.startScroll(),r>0){var n=new O({duration:r});n.doFrame((function(e){var n=t*(e/r);i._chartStore.scroll(n)})),n.start()}else this._chartStore.scroll(t)},t.prototype.scrollToRealTime=function(t){var e=this._chartStore.getBarSpace().bar,i=(this._chartStore.getLastBarRightSideDiffBarCount()-this._chartStore.getInitialOffsetRightDistance()/e)*e;this.scrollByDistance(i,t)},t.prototype.scrollToDataIndex=function(t,e){var i=(this._chartStore.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-t))*this._chartStore.getBarSpace().bar;this.scrollByDistance(i,e)},t.prototype.scrollToTimestamp=function(t,e){var i=Y(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},t.prototype.zoomAtCoordinate=function(t,e,i){var r=this,n=a(i)&&i>0?i:0,o=this._chartStore.getBarSpace().bar,s=o*t-o;if(n>0){var l=0,u=new O({duration:n});u.doFrame((function(t){var i=s*(t/n),o=(i-l)/r._chartStore.getBarSpace().bar*10;r._chartStore.zoom(o,e),l=i})),u.start()}else this._chartStore.zoom(s/o*10,e)},t.prototype.zoomAtDataIndex=function(t,e,i){var r=this._chartStore.dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:r,y:0},i)},t.prototype.zoomAtTimestamp=function(t,e,i){var r=Y(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,r,i)},t.prototype.convertToPixel=function(t,e){var i,n=this,o=null!=e?e:{},s=o.paneId,l=void 0===s?zt:s,u=o.absolute,c=void 0!==u&&u,h=[];if(l!==Yt){var d=this.getDrawPaneById(l);if(null!==d){var p=d.getBounding(),g=[].concat(t),v=this._xAxisPane.getAxisComponent(),f=d.getAxisComponent();h=g.map((function(t){var e={},i=t.dataIndex;if(a(t.timestamp)&&(i=n._chartStore.timestampToDataIndex(t.timestamp)),a(i)&&(e.x=v.convertToPixel(i)),a(t.value)){var r=f.convertToPixel(t.value);e.y=c?p.top+r:r}return e}))}}return r(t)?h:null!==(i=h[0])&&void 0!==i?i:{}},t.prototype.convertFromPixel=function(t,e){var i,n=this,o=null!=e?e:{},s=o.paneId,l=void 0===s?zt:s,u=o.absolute,c=void 0!==u&&u,h=[];if(l!==Yt){var d=this.getDrawPaneById(l);if(null!==d){var p=d.getBounding(),g=[].concat(t),v=this._xAxisPane.getAxisComponent(),f=d.getAxisComponent();h=g.map((function(t){var e,i={};if(a(t.x)){var r=v.convertFromPixel(t.x);i.dataIndex=r,i.timestamp=null!==(e=n._chartStore.dataIndexToTimestamp(r))&&void 0!==e?e:void 0}if(a(t.y)){var o=c?t.y-p.top:t.y;i.value=f.convertFromPixel(o)}return i}))}}return r(t)?h:null!==(i=h[0])&&void 0!==i?i:{}},t.prototype.executeAction=function(t,e){var i;if("onCrosshairChange"===t){var r=T({},e);null!==(i=r.paneId)&&void 0!==i||(r.paneId=zt),this._chartStore.setCrosshair(r,{notExecuteAction:!0})}},t.prototype.subscribeAction=function(t,e){this._chartStore.subscribeAction(t,e)},t.prototype.unsubscribeAction=function(t,e){this._chartStore.unsubscribeAction(t,e)},t.prototype.getConvertPictureUrl=function(t,e,i){var r=this,n=this._chartBounding,o=n.width,a=n.height,l=N("canvas",{width:"".concat(o,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),u=l.getContext("2d"),c=x(l);l.width=o*c,l.height=a*c,u.scale(c,c),u.fillStyle=null!=i?i:"#FFFFFF",u.fillRect(0,0,o,a);var h=null!=t&&t;return this._drawPanes.forEach((function(t){var e=r._separatorPanes.get(t);if(s(e)){var i=e.getBounding();u.drawImage(e.getImage(h),i.left,i.top,i.width,i.height)}var n=t.getBounding();u.drawImage(t.getImage(h),0,n.top,o,n.height)})),l.toDataURL("image/".concat(null!=e?e:"jpeg"))},t.prototype.resize=function(){this._cacheChartBounding(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},t.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach((function(t){t.destroy()})),this._drawPanes=[],this._separatorPanes.clear(),this._chartStore.destroy(),this._container.removeChild(this._chartContainer)},t}(),xi=new Map,bi=1;var wi={clone:i,merge:e,isString:u,isNumber:a,isValid:s,isObject:o,isArray:r,isFunction:n,isBoolean:l,formatValue:d,formatPrecision:g,formatBigNumber:v,formatDate:p,formatThousands:f,formatFoldDecimal:m,calcTextWidth:w,getLinearSlopeIntercept:Mt,getLinearYFromSlopeIntercept:Pt,getLinearYFromCoordinates:It,checkCoordinateOnArc:ue,checkCoordinateOnCircle:$t,checkCoordinateOnLine:St,checkCoordinateOnPolygon:ee,checkCoordinateOnRect:re,checkCoordinateOnText:se};t.dispose=function(t){var e,i,r=null;if(t instanceof _i)r=t.id;else{var n=null;r=null!==(e=null==(n=u(t)?document.getElementById(t):t)?void 0:n.getAttribute("k-line-chart-id"))&&void 0!==e?e:null}null!==r&&(null===(i=xi.get(r))||void 0===i||i.destroy(),xi.delete(r))},t.getFigureClass=function(t){var e;return null!==(e=ge[t])&&void 0!==e?e:null},t.getOverlayClass=function(t){var e;return null!==(e=Lt[t])&&void 0!==e?e:null},t.getSupportedFigures=function(){return Object.keys(ge)},t.getSupportedIndicators=function(){return Object.keys(ft)},t.getSupportedLocales=function(){return Object.keys(Me)},t.getSupportedOverlays=function(){return Object.keys(Lt)},t.init=function(t,e){var i=null;if(null===(i=u(t)?document.getElementById(t):t))return null;var r=xi.get(i.id);if(s(r))return r;var n="k_line_chart_".concat(bi++);return(r=new _i(i,e)).id=n,i.setAttribute("k-line-chart-id",n),xi.set(n,r),r},t.registerFigure=function(t){ge[t.name]=Tt.extend(t)},t.registerIndicator=function(t){ft[t.name]=et.extend(t)},t.registerLocale=function(t,e){Me[t]=T(T({},Me[t]),e)},t.registerOverlay=function(t){Lt[t.name]=bt.extend(t)},t.registerStyles=function(t,e){Wt[t]=e},t.registerXAxis=function(t){ei[t.name]=ti.extend(t)},t.registerYAxis=function(t){Ge[t.name]=Ye.extend(t)},t.utils=wi,t.version=function(){return"10.0.0-alpha6"}}));
